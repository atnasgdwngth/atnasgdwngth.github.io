async function Ft(Se={}){var se,_=Se,Ee=!!globalThis.window,Ce=!!globalThis.WorkerGlobalScope;globalThis.process?.versions?.node&&globalThis.process?.type;var ke="./this.program",De=import.meta.url,Qe="";function nt(e){return _.locateFile?_.locateFile(e,Qe):Qe+e}var Ue,rt;if(Ee||Ce){try{Qe=new URL(".",De).href}catch{}Ce&&(rt=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),Ue=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var me=console.log.bind(console),Le=console.error.bind(console),He,ct=!1,yt,qt,$e,it,dt,Oe,Fe,ze,Lt=!1;function Ct(){var e=Ze.buffer;$e=new Int8Array(e),dt=new Int16Array(e),it=new Uint8Array(e),Oe=new Int32Array(e),Fe=new Uint32Array(e),ze=new BigInt64Array(e),new BigUint64Array(e)}function en(){if(_.wasmMemory)Ze=_.wasmMemory;else{var e=_.INITIAL_MEMORY||8388608;Ze=new WebAssembly.Memory({initial:e/65536,maximum:32768})}Ct()}function tn(){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)dn(_.preRun.shift());Nt(Rt)}function nn(){Lt=!0,!_.noFSInit&&!a.initialized&&a.init(),ft.__wasm_call_ctors(),a.ignorePermissions=!1}function rn(){if(_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;)fn(_.postRun.shift());Nt(Dt)}function Ye(e){_.onAbort?.(e),e="Aborted("+e+")",Le(e),ct=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw qt?.(t),t}var At;function sn(){return _.locateFile?nt("sqlite3.wasm"):new URL("/assets/sqlite3-DGXXSD5r.wasm",import.meta.url).href}function on(e){if(e==At&&He)return new Uint8Array(He);if(rt)return rt(e);throw"both async and sync fetching of the wasm failed"}async function ln(e){if(!He)try{var t=await Ue(e);return new Uint8Array(t)}catch{}return on(e)}async function an(e,t){try{var o=await ln(e);return await WebAssembly.instantiate(o,t)}catch(s){Le(`failed to asynchronously prepare wasm: ${s}`),Ye(s)}}async function cn(e,t,o){if(!e)try{var s=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(s,o)}catch(n){Le(`wasm streaming compile failed: ${n}`),Le("falling back to ArrayBuffer instantiation")}return an(t,o)}function un(){return{env:Xt,wasi_snapshot_preview1:Xt}}async function _n(){function e(s,n){return ft=s.exports,hr(ft),ft}function t(s){return e(s.instance)}var o=un();return _.instantiateWasm?new Promise((s,n)=>{_.instantiateWasm(o,(i,r)=>{s(e(i))})}):(At??=sn(),t(await cn(He,At,o)))}var Nt=e=>{for(;e.length>0;)e.shift()(_)},Dt=[],fn=e=>Dt.push(e),Rt=[],dn=e=>Rt.push(e),Ze,Pe={isAbs:e=>e.charAt(0)==="/",splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var o=0,s=e.length-1;s>=0;s--){var n=e[s];n==="."?e.splice(s,1):n===".."?(e.splice(s,1),o++):o&&(e.splice(s,1),o--)}if(t)for(;o;o--)e.unshift("..");return e},normalize:e=>{var t=Pe.isAbs(e),o=e.slice(-1)==="/";return e=Pe.normalizeArray(e.split("/").filter(s=>!!s),!t).join("/"),!e&&!t&&(e="."),e&&o&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=Pe.splitPath(e),o=t[0],s=t[1];return!o&&!s?".":(s&&(s=s.slice(0,-1)),o+s)},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>Pe.normalize(e.join("/")),join2:(e,t)=>Pe.normalize(e+"/"+t)},pn=()=>e=>crypto.getRandomValues(e),jt=e=>{(jt=pn())(e)},ut={resolve:(...e)=>{for(var t="",o=!1,s=e.length-1;s>=-1&&!o;s--){var n=s>=0?e[s]:a.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";t=n+"/"+t,o=Pe.isAbs(n)}return t=Pe.normalizeArray(t.split("/").filter(i=>!!i),!o).join("/"),(o?"/":"")+t||"."},relative:(e,t)=>{e=ut.resolve(e).slice(1),t=ut.resolve(t).slice(1);function o(T){for(var K=0;K<T.length&&T[K]==="";K++);for(var C=T.length-1;C>=0&&T[C]==="";C--);return K>C?[]:T.slice(K,C-K+1)}for(var s=o(e.split("/")),n=o(t.split("/")),i=Math.min(s.length,n.length),r=i,c=0;c<i;c++)if(s[c]!==n[c]){r=c;break}for(var F=[],c=r;c<s.length;c++)F.push("..");return F=F.concat(n.slice(r)),F.join("/")}},Mt=new TextDecoder,zt=(e,t,o,s)=>{for(var n=t+o;e[t]&&!(t>=n);)++t;return t},pt=(e,t=0,o,s)=>{var n=zt(e,t,o);return Mt.decode(e.buffer?e.subarray(t,n):new Uint8Array(e.slice(t,n)))},It=[],vt=e=>{for(var t=0,o=0;o<e.length;++o){var s=e.charCodeAt(o);s<=127?t++:s<=2047?t+=2:s>=55296&&s<=57343?(t+=4,++o):t+=3}return t},Bt=(e,t,o,s)=>{if(!(s>0))return 0;for(var n=o,i=o+s-1,r=0;r<e.length;++r){var c=e.codePointAt(r);if(c<=127){if(o>=i)break;t[o++]=c}else if(c<=2047){if(o+1>=i)break;t[o++]=192|c>>6,t[o++]=128|c&63}else if(c<=65535){if(o+2>=i)break;t[o++]=224|c>>12,t[o++]=128|c>>6&63,t[o++]=128|c&63}else{if(o+3>=i)break;t[o++]=240|c>>18,t[o++]=128|c>>12&63,t[o++]=128|c>>6&63,t[o++]=128|c&63,r++}}return t[o]=0,o-n},kt=(e,t,o)=>{var s=vt(e)+1,n=new Array(s),i=Bt(e,n,0,n.length);return n.length=i,n},hn=()=>{if(!It.length){var e=null;if(globalThis.window?.prompt&&(e=window.prompt("Input: "),e!==null&&(e+=`
`)),!e)return null;It=kt(e)}return It.shift()},st={ttys:[],init(){},shutdown(){},register(e,t){st.ttys[e]={input:[],output:[],ops:t},a.registerDevice(e,st.stream_ops)},stream_ops:{open(e){var t=st.ttys[e.node.rdev];if(!t)throw new a.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,o,s,n){if(!e.tty||!e.tty.ops.get_char)throw new a.ErrnoError(60);for(var i=0,r=0;r<s;r++){var c;try{c=e.tty.ops.get_char(e.tty)}catch{throw new a.ErrnoError(29)}if(c===void 0&&i===0)throw new a.ErrnoError(6);if(c==null)break;i++,t[o+r]=c}return i&&(e.node.atime=Date.now()),i},write(e,t,o,s,n){if(!e.tty||!e.tty.ops.put_char)throw new a.ErrnoError(60);try{for(var i=0;i<s;i++)e.tty.ops.put_char(e.tty,t[o+i])}catch{throw new a.ErrnoError(29)}return s&&(e.node.mtime=e.node.ctime=Date.now()),i}},default_tty_ops:{get_char(e){return hn()},put_char(e,t){t===null||t===10?(me(pt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(me(pt(e.output)),e.output=[])},ioctl_tcgets(e){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(e,t,o){return 0},ioctl_tiocgwinsz(e){return[24,80]}},default_tty1_ops:{put_char(e,t){t===null||t===10?(Le(pt(e.output)),e.output=[]):t!=0&&e.output.push(t)},fsync(e){e.output?.length>0&&(Le(pt(e.output)),e.output=[])}}},mn=(e,t)=>it.fill(0,e,e+t),Qt=(e,t)=>Math.ceil(e/t)*t,Ut=e=>{e=Qt(e,65536);var t=Kt(65536,e);return t&&mn(t,e),t},be={ops_table:null,mount(e){return be.createNode(null,"/",16895,0)},createNode(e,t,o,s){if(a.isBlkdev(o)||a.isFIFO(o))throw new a.ErrnoError(63);be.ops_table||={dir:{node:{getattr:be.node_ops.getattr,setattr:be.node_ops.setattr,lookup:be.node_ops.lookup,mknod:be.node_ops.mknod,rename:be.node_ops.rename,unlink:be.node_ops.unlink,rmdir:be.node_ops.rmdir,readdir:be.node_ops.readdir,symlink:be.node_ops.symlink},stream:{llseek:be.stream_ops.llseek}},file:{node:{getattr:be.node_ops.getattr,setattr:be.node_ops.setattr},stream:{llseek:be.stream_ops.llseek,read:be.stream_ops.read,write:be.stream_ops.write,mmap:be.stream_ops.mmap,msync:be.stream_ops.msync}},link:{node:{getattr:be.node_ops.getattr,setattr:be.node_ops.setattr,readlink:be.node_ops.readlink},stream:{}},chrdev:{node:{getattr:be.node_ops.getattr,setattr:be.node_ops.setattr},stream:a.chrdev_stream_ops}};var n=a.createNode(e,t,o,s);return a.isDir(n.mode)?(n.node_ops=be.ops_table.dir.node,n.stream_ops=be.ops_table.dir.stream,n.contents={}):a.isFile(n.mode)?(n.node_ops=be.ops_table.file.node,n.stream_ops=be.ops_table.file.stream,n.usedBytes=0,n.contents=null):a.isLink(n.mode)?(n.node_ops=be.ops_table.link.node,n.stream_ops=be.ops_table.link.stream):a.isChrdev(n.mode)&&(n.node_ops=be.ops_table.chrdev.node,n.stream_ops=be.ops_table.chrdev.stream),n.atime=n.mtime=n.ctime=Date.now(),e&&(e.contents[t]=n,e.atime=e.mtime=e.ctime=n.atime),n},getFileDataAsTypedArray(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage(e,t){var o=e.contents?e.contents.length:0;if(!(o>=t)){t=Math.max(t,o*(o<1024*1024?2:1.125)>>>0),o!=0&&(t=Math.max(t,256));var s=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(s.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(t==0)e.contents=null,e.usedBytes=0;else{var o=e.contents;e.contents=new Uint8Array(t),o&&e.contents.set(o.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=a.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,a.isDir(e.mode)?t.size=4096:a.isFile(e.mode)?t.size=e.usedBytes:a.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.atime),t.mtime=new Date(e.mtime),t.ctime=new Date(e.ctime),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr(e,t){for(const o of["mode","atime","mtime","ctime"])t[o]!=null&&(e[o]=t[o]);t.size!==void 0&&be.resizeFileStorage(e,t.size)},lookup(e,t){throw be.doesNotExistError||(be.doesNotExistError=new a.ErrnoError(44),be.doesNotExistError.stack="<generic error, no stack>"),be.doesNotExistError},mknod(e,t,o,s){return be.createNode(e,t,o,s)},rename(e,t,o){var s;try{s=a.lookupNode(t,o)}catch{}if(s){if(a.isDir(e.mode))for(var n in s.contents)throw new a.ErrnoError(55);a.hashRemoveNode(s)}delete e.parent.contents[e.name],t.contents[o]=e,e.name=o,t.ctime=t.mtime=e.parent.ctime=e.parent.mtime=Date.now()},unlink(e,t){delete e.contents[t],e.ctime=e.mtime=Date.now()},rmdir(e,t){for(var o in a.lookupNode(e,t).contents)throw new a.ErrnoError(55);delete e.contents[t],e.ctime=e.mtime=Date.now()},readdir(e){return[".","..",...Object.keys(e.contents)]},symlink(e,t,o){var s=be.createNode(e,t,41471,0);return s.link=o,s},readlink(e){if(!a.isLink(e.mode))throw new a.ErrnoError(28);return e.link}},stream_ops:{read(e,t,o,s,n){var i=e.node.contents;if(n>=e.node.usedBytes)return 0;var r=Math.min(e.node.usedBytes-n,s);if(r>8&&i.subarray)t.set(i.subarray(n,n+r),o);else for(var c=0;c<r;c++)t[o+c]=i[n+c];return r},write(e,t,o,s,n,i){if(t.buffer===$e.buffer&&(i=!1),!s)return 0;var r=e.node;if(r.mtime=r.ctime=Date.now(),t.subarray&&(!r.contents||r.contents.subarray)){if(i)return r.contents=t.subarray(o,o+s),r.usedBytes=s,s;if(r.usedBytes===0&&n===0)return r.contents=t.slice(o,o+s),r.usedBytes=s,s;if(n+s<=r.usedBytes)return r.contents.set(t.subarray(o,o+s),n),s}if(be.expandFileStorage(r,n+s),r.contents.subarray&&t.subarray)r.contents.set(t.subarray(o,o+s),n);else for(var c=0;c<s;c++)r.contents[n+c]=t[o+c];return r.usedBytes=Math.max(r.usedBytes,n+s),s},llseek(e,t,o){var s=t;if(o===1?s+=e.position:o===2&&a.isFile(e.node.mode)&&(s+=e.node.usedBytes),s<0)throw new a.ErrnoError(28);return s},mmap(e,t,o,s,n){if(!a.isFile(e.node.mode))throw new a.ErrnoError(43);var i,r,c=e.node.contents;if(!(n&2)&&c&&c.buffer===$e.buffer)r=!1,i=c.byteOffset;else{if(r=!0,i=Ut(t),!i)throw new a.ErrnoError(48);c&&((o>0||o+t<c.length)&&(c.subarray?c=c.subarray(o,o+t):c=Array.prototype.slice.call(c,o,o+t)),$e.set(c,i))}return{ptr:i,allocated:r}},msync(e,t,o,s,n){return be.stream_ops.write(e,t,0,s,o,!1),0}}},gn=e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(typeof t>"u")throw new Error(`Unknown file open mode: ${e}`);return t},Tt=(e,t)=>{var o=0;return e&&(o|=365),t&&(o|=146),o},bn=async e=>{var t=await Ue(e);return new Uint8Array(t)},yn=(...e)=>a.createDataFile(...e),ot=0,ht=null,qn=e=>{if(ot--,_.monitorRunDependencies?.(ot),ot==0&&ht){var t=ht;ht=null,t()}},vn=e=>{ot++,_.monitorRunDependencies?.(ot)},Wt=[],wn=async(e,t)=>{typeof Browser<"u"&&Browser.init();for(var o of Wt)if(o.canHandle(t))return o.handle(e,t);return e},Ht=async(e,t,o,s,n,i,r,c)=>{var F=t?ut.resolve(Pe.join2(e,t)):e;vn();try{var T=o;typeof o=="string"&&(T=await bn(o)),T=await wn(T,F),c?.(),i||yn(e,t,T,s,n,r)}finally{qn()}},Sn=(e,t,o,s,n,i,r,c,F,T)=>{Ht(e,t,o,s,n,c,F,T).then(i).catch(r)},a={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{name="ErrnoError";constructor(e){this.errno=e}},FSStream:class{shared={};get object(){return this.node}set object(e){this.node=e}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{node_ops={};stream_ops={};readMode=365;writeMode=146;mounted=null;constructor(e,t,o,s){e||(e=this),this.parent=e,this.mount=e.mount,this.id=a.nextInode++,this.name=t,this.mode=o,this.rdev=s,this.atime=this.mtime=this.ctime=Date.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return a.isDir(this.mode)}get isDevice(){return a.isChrdev(this.mode)}},lookupPath(e,t={}){if(!e)throw new a.ErrnoError(44);t.follow_mount??=!0,Pe.isAbs(e)||(e=a.cwd()+"/"+e);e:for(var o=0;o<40;o++){for(var s=e.split("/").filter(T=>!!T),n=a.root,i="/",r=0;r<s.length;r++){var c=r===s.length-1;if(c&&t.parent)break;if(s[r]!=="."){if(s[r]===".."){if(i=Pe.dirname(i),a.isRoot(n)){e=i+"/"+s.slice(r+1).join("/"),o--;continue e}else n=n.parent;continue}i=Pe.join2(i,s[r]);try{n=a.lookupNode(n,s[r])}catch(T){if(T?.errno===44&&c&&t.noent_okay)return{path:i};throw T}if(a.isMountpoint(n)&&(!c||t.follow_mount)&&(n=n.mounted.root),a.isLink(n.mode)&&(!c||t.follow)){if(!n.node_ops.readlink)throw new a.ErrnoError(52);var F=n.node_ops.readlink(n);Pe.isAbs(F)||(F=Pe.dirname(i)+"/"+F),e=F+"/"+s.slice(r+1).join("/");continue e}}}return{path:i,node:n}}throw new a.ErrnoError(32)},getPath(e){for(var t;;){if(a.isRoot(e)){var o=e.mount.mountpoint;return t?o[o.length-1]!=="/"?`${o}/${t}`:o+t:o}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var o=0,s=0;s<t.length;s++)o=(o<<5)-o+t.charCodeAt(s)|0;return(e+o>>>0)%a.nameTable.length},hashAddNode(e){var t=a.hashName(e.parent.id,e.name);e.name_next=a.nameTable[t],a.nameTable[t]=e},hashRemoveNode(e){var t=a.hashName(e.parent.id,e.name);if(a.nameTable[t]===e)a.nameTable[t]=e.name_next;else for(var o=a.nameTable[t];o;){if(o.name_next===e){o.name_next=e.name_next;break}o=o.name_next}},lookupNode(e,t){var o=a.mayLookup(e);if(o)throw new a.ErrnoError(o);for(var s=a.hashName(e.id,t),n=a.nameTable[s];n;n=n.name_next){var i=n.name;if(n.parent.id===e.id&&i===t)return n}return a.lookup(e,t)},createNode(e,t,o,s){var n=new a.FSNode(e,t,o,s);return a.hashAddNode(n),n},destroyNode(e){a.hashRemoveNode(e)},isRoot(e){return e===e.parent},isMountpoint(e){return!!e.mounted},isFile(e){return(e&61440)===32768},isDir(e){return(e&61440)===16384},isLink(e){return(e&61440)===40960},isChrdev(e){return(e&61440)===8192},isBlkdev(e){return(e&61440)===24576},isFIFO(e){return(e&61440)===4096},isSocket(e){return(e&49152)===49152},flagsToPermissionString(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},nodePermissions(e,t){return a.ignorePermissions?0:t.includes("r")&&!(e.mode&292)||t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73)?2:0},mayLookup(e){if(!a.isDir(e.mode))return 54;var t=a.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){if(!a.isDir(e.mode))return 54;try{return a.lookupNode(e,t),20}catch{}return a.nodePermissions(e,"wx")},mayDelete(e,t,o){var s;try{s=a.lookupNode(e,t)}catch(i){return i.errno}var n=a.nodePermissions(e,"wx");if(n)return n;if(o){if(!a.isDir(s.mode))return 54;if(a.isRoot(s)||a.getPath(s)===a.cwd())return 10}else if(a.isDir(s.mode))return 31;return 0},mayOpen(e,t){return e?a.isLink(e.mode)?32:a.isDir(e.mode)&&(a.flagsToPermissionString(t)!=="r"||t&576)?31:a.nodePermissions(e,a.flagsToPermissionString(t)):44},checkOpExists(e,t){if(!e)throw new a.ErrnoError(t);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=a.MAX_OPEN_FDS;e++)if(!a.streams[e])return e;throw new a.ErrnoError(33)},getStreamChecked(e){var t=a.getStream(e);if(!t)throw new a.ErrnoError(8);return t},getStream:e=>a.streams[e],createStream(e,t=-1){return e=Object.assign(new a.FSStream,e),t==-1&&(t=a.nextfd()),e.fd=t,a.streams[t]=e,e},closeStream(e){a.streams[e]=null},dupStream(e,t=-1){var o=a.createStream(e,t);return o.stream_ops?.dup?.(o),o},doSetAttr(e,t,o){var s=e?.stream_ops.setattr,n=s?e:t;s??=t.node_ops.setattr,a.checkOpExists(s,63),s(n,o)},chrdev_stream_ops:{open(e){e.stream_ops=a.getDevice(e.node.rdev).stream_ops,e.stream_ops.open?.(e)},llseek(){throw new a.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,t)=>e<<8|t,registerDevice(e,t){a.devices[e]={stream_ops:t}},getDevice:e=>a.devices[e],getMounts(e){for(var t=[],o=[e];o.length;){var s=o.pop();t.push(s),o.push(...s.mounts)}return t},syncfs(e,t){typeof e=="function"&&(t=e,e=!1),a.syncFSRequests++,a.syncFSRequests>1&&Le(`warning: ${a.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var o=a.getMounts(a.root.mount),s=0;function n(c){return a.syncFSRequests--,t(c)}function i(c){if(c)return i.errored?void 0:(i.errored=!0,n(c));++s>=o.length&&n(null)}for(var r of o)r.type.syncfs?r.type.syncfs(r,e,i):i(null)},mount(e,t,o){var s=o==="/",n=!o,i;if(s&&a.root)throw new a.ErrnoError(10);if(!s&&!n){var r=a.lookupPath(o,{follow_mount:!1});if(o=r.path,i=r.node,a.isMountpoint(i))throw new a.ErrnoError(10);if(!a.isDir(i.mode))throw new a.ErrnoError(54)}var c={type:e,opts:t,mountpoint:o,mounts:[]},F=e.mount(c);return F.mount=c,c.root=F,s?a.root=F:i&&(i.mounted=c,i.mount&&i.mount.mounts.push(c)),F},unmount(e){var t=a.lookupPath(e,{follow_mount:!1});if(!a.isMountpoint(t.node))throw new a.ErrnoError(28);var o=t.node,s=o.mounted,n=a.getMounts(s);for(var[i,r]of Object.entries(a.nameTable))for(;r;){var c=r.name_next;n.includes(r.mount)&&a.destroyNode(r),r=c}o.mounted=null;var F=o.mount.mounts.indexOf(s);o.mount.mounts.splice(F,1)},lookup(e,t){return e.node_ops.lookup(e,t)},mknod(e,t,o){var s=a.lookupPath(e,{parent:!0}).node,n=Pe.basename(e);if(!n)throw new a.ErrnoError(28);if(n==="."||n==="..")throw new a.ErrnoError(20);var i=a.mayCreate(s,n);if(i)throw new a.ErrnoError(i);if(!s.node_ops.mknod)throw new a.ErrnoError(63);return s.node_ops.mknod(s,n,t,o)},statfs(e){return a.statfsNode(a.lookupPath(e,{follow:!0}).node)},statfsStream(e){return a.statfsNode(e.node)},statfsNode(e){var t={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:a.nextInode,ffree:a.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&Object.assign(t,e.node_ops.statfs(e.mount.opts.root)),t},create(e,t=438){return t&=4095,t|=32768,a.mknod(e,t,0)},mkdir(e,t=511){return t&=1023,t|=16384,a.mknod(e,t,0)},mkdirTree(e,t){var o=e.split("/"),s="";for(var n of o)if(n){(s||Pe.isAbs(e))&&(s+="/"),s+=n;try{a.mkdir(s,t)}catch(i){if(i.errno!=20)throw i}}},mkdev(e,t,o){return typeof o>"u"&&(o=t,t=438),t|=8192,a.mknod(e,t,o)},symlink(e,t){if(!ut.resolve(e))throw new a.ErrnoError(44);var o=a.lookupPath(t,{parent:!0}).node;if(!o)throw new a.ErrnoError(44);var s=Pe.basename(t),n=a.mayCreate(o,s);if(n)throw new a.ErrnoError(n);if(!o.node_ops.symlink)throw new a.ErrnoError(63);return o.node_ops.symlink(o,s,e)},rename(e,t){var o=Pe.dirname(e),s=Pe.dirname(t),n=Pe.basename(e),i=Pe.basename(t),r=a.lookupPath(e,{parent:!0}),c=r.node,F;if(r=a.lookupPath(t,{parent:!0}),F=r.node,!c||!F)throw new a.ErrnoError(44);if(c.mount!==F.mount)throw new a.ErrnoError(75);var T=a.lookupNode(c,n),K=ut.relative(e,s);if(K.charAt(0)!==".")throw new a.ErrnoError(28);if(K=ut.relative(t,o),K.charAt(0)!==".")throw new a.ErrnoError(55);var C;try{C=a.lookupNode(F,i)}catch{}if(T!==C){var $=a.isDir(T.mode),p=a.mayDelete(c,n,$);if(p)throw new a.ErrnoError(p);if(p=C?a.mayDelete(F,i,$):a.mayCreate(F,i),p)throw new a.ErrnoError(p);if(!c.node_ops.rename)throw new a.ErrnoError(63);if(a.isMountpoint(T)||C&&a.isMountpoint(C))throw new a.ErrnoError(10);if(F!==c&&(p=a.nodePermissions(c,"w"),p))throw new a.ErrnoError(p);a.hashRemoveNode(T);try{c.node_ops.rename(T,F,i),T.parent=F}catch(z){throw z}finally{a.hashAddNode(T)}}},rmdir(e){var t=a.lookupPath(e,{parent:!0}).node,o=Pe.basename(e),s=a.lookupNode(t,o),n=a.mayDelete(t,o,!0);if(n)throw new a.ErrnoError(n);if(!t.node_ops.rmdir)throw new a.ErrnoError(63);if(a.isMountpoint(s))throw new a.ErrnoError(10);t.node_ops.rmdir(t,o),a.destroyNode(s)},readdir(e){var t=a.lookupPath(e,{follow:!0}).node;return a.checkOpExists(t.node_ops.readdir,54)(t)},unlink(e){var t=a.lookupPath(e,{parent:!0}).node;if(!t)throw new a.ErrnoError(44);var o=Pe.basename(e),s=a.lookupNode(t,o),n=a.mayDelete(t,o,!1);if(n)throw new a.ErrnoError(n);if(!t.node_ops.unlink)throw new a.ErrnoError(63);if(a.isMountpoint(s))throw new a.ErrnoError(10);t.node_ops.unlink(t,o),a.destroyNode(s)},readlink(e){var t=a.lookupPath(e).node;if(!t)throw new a.ErrnoError(44);if(!t.node_ops.readlink)throw new a.ErrnoError(28);return t.node_ops.readlink(t)},stat(e,t){var o=a.lookupPath(e,{follow:!t}).node;return a.checkOpExists(o.node_ops.getattr,63)(o)},fstat(e){var t=a.getStreamChecked(e),o=t.node,s=t.stream_ops.getattr,n=s?t:o;return s??=o.node_ops.getattr,a.checkOpExists(s,63),s(n)},lstat(e){return a.stat(e,!0)},doChmod(e,t,o,s){a.doSetAttr(e,t,{mode:o&4095|t.mode&-4096,ctime:Date.now(),dontFollow:s})},chmod(e,t,o){var s;typeof e=="string"?s=a.lookupPath(e,{follow:!o}).node:s=e,a.doChmod(null,s,t,o)},lchmod(e,t){a.chmod(e,t,!0)},fchmod(e,t){var o=a.getStreamChecked(e);a.doChmod(o,o.node,t,!1)},doChown(e,t,o){a.doSetAttr(e,t,{timestamp:Date.now(),dontFollow:o})},chown(e,t,o,s){var n;typeof e=="string"?n=a.lookupPath(e,{follow:!s}).node:n=e,a.doChown(null,n,s)},lchown(e,t,o){a.chown(e,t,o,!0)},fchown(e,t,o){var s=a.getStreamChecked(e);a.doChown(s,s.node,!1)},doTruncate(e,t,o){if(a.isDir(t.mode))throw new a.ErrnoError(31);if(!a.isFile(t.mode))throw new a.ErrnoError(28);var s=a.nodePermissions(t,"w");if(s)throw new a.ErrnoError(s);a.doSetAttr(e,t,{size:o,timestamp:Date.now()})},truncate(e,t){if(t<0)throw new a.ErrnoError(28);var o;typeof e=="string"?o=a.lookupPath(e,{follow:!0}).node:o=e,a.doTruncate(null,o,t)},ftruncate(e,t){var o=a.getStreamChecked(e);if(t<0||(o.flags&2097155)===0)throw new a.ErrnoError(28);a.doTruncate(o,o.node,t)},utime(e,t,o){var s=a.lookupPath(e,{follow:!0}).node;a.checkOpExists(s.node_ops.setattr,63)(s,{atime:t,mtime:o})},open(e,t,o=438){if(e==="")throw new a.ErrnoError(44);t=typeof t=="string"?gn(t):t,t&64?o=o&4095|32768:o=0;var s,n;if(typeof e=="object")s=e;else{n=e.endsWith("/");var i=a.lookupPath(e,{follow:!(t&131072),noent_okay:!0});s=i.node,e=i.path}var r=!1;if(t&64)if(s){if(t&128)throw new a.ErrnoError(20)}else{if(n)throw new a.ErrnoError(31);s=a.mknod(e,o|511,0),r=!0}if(!s)throw new a.ErrnoError(44);if(a.isChrdev(s.mode)&&(t&=-513),t&65536&&!a.isDir(s.mode))throw new a.ErrnoError(54);if(!r){var c=a.mayOpen(s,t);if(c)throw new a.ErrnoError(c)}t&512&&!r&&a.truncate(s,0),t&=-131713;var F=a.createStream({node:s,path:a.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1});return F.stream_ops.open&&F.stream_ops.open(F),r&&a.chmod(s,o&511),_.logReadFiles&&!(t&1)&&(e in a.readFiles||(a.readFiles[e]=1)),F},close(e){if(a.isClosed(e))throw new a.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{a.closeStream(e.fd)}e.fd=null},isClosed(e){return e.fd===null},llseek(e,t,o){if(a.isClosed(e))throw new a.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new a.ErrnoError(70);if(o!=0&&o!=1&&o!=2)throw new a.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,o),e.ungotten=[],e.position},read(e,t,o,s,n){if(s<0||n<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if((e.flags&2097155)===1)throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.read)throw new a.ErrnoError(28);var i=typeof n<"u";if(!i)n=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var r=e.stream_ops.read(e,t,o,s,n);return i||(e.position+=r),r},write(e,t,o,s,n,i){if(s<0||n<0)throw new a.ErrnoError(28);if(a.isClosed(e))throw new a.ErrnoError(8);if((e.flags&2097155)===0)throw new a.ErrnoError(8);if(a.isDir(e.node.mode))throw new a.ErrnoError(31);if(!e.stream_ops.write)throw new a.ErrnoError(28);e.seekable&&e.flags&1024&&a.llseek(e,0,2);var r=typeof n<"u";if(!r)n=e.position;else if(!e.seekable)throw new a.ErrnoError(70);var c=e.stream_ops.write(e,t,o,s,n,i);return r||(e.position+=c),c},mmap(e,t,o,s,n){if((s&2)!==0&&(n&2)===0&&(e.flags&2097155)!==2)throw new a.ErrnoError(2);if((e.flags&2097155)===1)throw new a.ErrnoError(2);if(!e.stream_ops.mmap)throw new a.ErrnoError(43);if(!t)throw new a.ErrnoError(28);return e.stream_ops.mmap(e,t,o,s,n)},msync(e,t,o,s,n){return e.stream_ops.msync?e.stream_ops.msync(e,t,o,s,n):0},ioctl(e,t,o){if(!e.stream_ops.ioctl)throw new a.ErrnoError(59);return e.stream_ops.ioctl(e,t,o)},readFile(e,t={}){t.flags=t.flags||0,t.encoding=t.encoding||"binary",t.encoding!=="utf8"&&t.encoding!=="binary"&&Ye(`Invalid encoding type "${t.encoding}"`);var o=a.open(e,t.flags),s=a.stat(e).size,n=new Uint8Array(s);return a.read(o,n,0,s,0),t.encoding==="utf8"&&(n=pt(n)),a.close(o),n},writeFile(e,t,o={}){o.flags=o.flags||577;var s=a.open(e,o.flags,o.mode);typeof t=="string"&&(t=new Uint8Array(kt(t))),ArrayBuffer.isView(t)?a.write(s,t,0,t.byteLength,void 0,o.canOwn):Ye("Unsupported data type"),a.close(s)},cwd:()=>a.currentPath,chdir(e){var t=a.lookupPath(e,{follow:!0});if(t.node===null)throw new a.ErrnoError(44);if(!a.isDir(t.node.mode))throw new a.ErrnoError(54);var o=a.nodePermissions(t.node,"x");if(o)throw new a.ErrnoError(o);a.currentPath=t.path},createDefaultDirectories(){a.mkdir("/tmp"),a.mkdir("/home"),a.mkdir("/home/web_user")},createDefaultDevices(){a.mkdir("/dev"),a.registerDevice(a.makedev(1,3),{read:()=>0,write:(s,n,i,r,c)=>r,llseek:()=>0}),a.mkdev("/dev/null",a.makedev(1,3)),st.register(a.makedev(5,0),st.default_tty_ops),st.register(a.makedev(6,0),st.default_tty1_ops),a.mkdev("/dev/tty",a.makedev(5,0)),a.mkdev("/dev/tty1",a.makedev(6,0));var e=new Uint8Array(1024),t=0,o=()=>(t===0&&(jt(e),t=e.byteLength),e[--t]);a.createDevice("/dev","random",o),a.createDevice("/dev","urandom",o),a.mkdir("/dev/shm"),a.mkdir("/dev/shm/tmp")},createSpecialDirectories(){a.mkdir("/proc");var e=a.mkdir("/proc/self");a.mkdir("/proc/self/fd"),a.mount({mount(){var t=a.createNode(e,"fd",16895,73);return t.stream_ops={llseek:be.stream_ops.llseek},t.node_ops={lookup(o,s){var n=+s,i=a.getStreamChecked(n),r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>i.path},id:n+1};return r.parent=r,r},readdir(){return Array.from(a.streams.entries()).filter(([o,s])=>s).map(([o,s])=>o.toString())}},t}},{},"/proc/self/fd")},createStandardStreams(e,t,o){e?a.createDevice("/dev","stdin",e):a.symlink("/dev/tty","/dev/stdin"),t?a.createDevice("/dev","stdout",null,t):a.symlink("/dev/tty","/dev/stdout"),o?a.createDevice("/dev","stderr",null,o):a.symlink("/dev/tty1","/dev/stderr"),a.open("/dev/stdin",0),a.open("/dev/stdout",1),a.open("/dev/stderr",1)},staticInit(){a.nameTable=new Array(4096),a.mount(be,{},"/"),a.createDefaultDirectories(),a.createDefaultDevices(),a.createSpecialDirectories(),a.filesystems={MEMFS:be}},init(e,t,o){a.initialized=!0,e??=_.stdin,t??=_.stdout,o??=_.stderr,a.createStandardStreams(e,t,o)},quit(){a.initialized=!1;for(var e of a.streams)e&&a.close(e)},findObject(e,t){var o=a.analyzePath(e,t);return o.exists?o.object:null},analyzePath(e,t){try{var o=a.lookupPath(e,{follow:!t});e=o.path}catch{}var s={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=a.lookupPath(e,{parent:!0});s.parentExists=!0,s.parentPath=o.path,s.parentObject=o.node,s.name=Pe.basename(e),o=a.lookupPath(e,{follow:!t}),s.exists=!0,s.path=o.path,s.object=o.node,s.name=o.node.name,s.isRoot=o.path==="/"}catch(n){s.error=n.errno}return s},createPath(e,t,o,s){e=typeof e=="string"?e:a.getPath(e);for(var n=t.split("/").reverse();n.length;){var i=n.pop();if(i){var r=Pe.join2(e,i);try{a.mkdir(r)}catch(c){if(c.errno!=20)throw c}e=r}}return r},createFile(e,t,o,s,n){var i=Pe.join2(typeof e=="string"?e:a.getPath(e),t),r=Tt(s,n);return a.create(i,r)},createDataFile(e,t,o,s,n,i){var r=t;e&&(e=typeof e=="string"?e:a.getPath(e),r=t?Pe.join2(e,t):e);var c=Tt(s,n),F=a.create(r,c);if(o){if(typeof o=="string"){for(var T=new Array(o.length),K=0,C=o.length;K<C;++K)T[K]=o.charCodeAt(K);o=T}a.chmod(F,c|146);var $=a.open(F,577);a.write($,o,0,o.length,0,i),a.close($),a.chmod(F,c)}},createDevice(e,t,o,s){var n=Pe.join2(typeof e=="string"?e:a.getPath(e),t),i=Tt(!!o,!!s);a.createDevice.major??=64;var r=a.makedev(a.createDevice.major++,0);return a.registerDevice(r,{open(c){c.seekable=!1},close(c){s?.buffer?.length&&s(10)},read(c,F,T,K,C){for(var $=0,p=0;p<K;p++){var z;try{z=o()}catch{throw new a.ErrnoError(29)}if(z===void 0&&$===0)throw new a.ErrnoError(6);if(z==null)break;$++,F[T+p]=z}return $&&(c.node.atime=Date.now()),$},write(c,F,T,K,C){for(var $=0;$<K;$++)try{s(F[T+$])}catch{throw new a.ErrnoError(29)}return K&&(c.node.mtime=c.node.ctime=Date.now()),$}}),a.mkdev(n,i,r)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(globalThis.XMLHttpRequest)Ye("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else try{e.contents=rt(e.url)}catch{throw new a.ErrnoError(29)}},createLazyFile(e,t,o,s,n){class i{lengthKnown=!1;chunks=[];get(C){if(!(C>this.length-1||C<0)){var $=C%this.chunkSize,p=C/this.chunkSize|0;return this.getter(p)[$]}}setDataGetter(C){this.getter=C}cacheLength(){var C=new XMLHttpRequest;C.open("HEAD",o,!1),C.send(null),C.status>=200&&C.status<300||C.status===304||Ye("Couldn't load "+o+". Status: "+C.status);var $=Number(C.getResponseHeader("Content-length")),p,z=(p=C.getResponseHeader("Accept-Ranges"))&&p==="bytes",N=(p=C.getResponseHeader("Content-Encoding"))&&p==="gzip",te=1024*1024;z||(te=$);var y=(D,Q)=>{D>Q&&Ye("invalid range ("+D+", "+Q+") or no bytes requested!"),Q>$-1&&Ye("only "+$+" bytes available! programmer error!");var E=new XMLHttpRequest;return E.open("GET",o,!1),$!==te&&E.setRequestHeader("Range","bytes="+D+"-"+Q),E.responseType="arraybuffer",E.overrideMimeType&&E.overrideMimeType("text/plain; charset=x-user-defined"),E.send(null),E.status>=200&&E.status<300||E.status===304||Ye("Couldn't load "+o+". Status: "+E.status),E.response!==void 0?new Uint8Array(E.response||[]):kt(E.responseText||"")},b=this;b.setDataGetter(D=>{var Q=D*te,E=(D+1)*te-1;return E=Math.min(E,$-1),typeof b.chunks[D]>"u"&&(b.chunks[D]=y(Q,E)),typeof b.chunks[D]>"u"&&Ye("doXHR failed!"),b.chunks[D]}),(N||!$)&&(te=$=1,$=this.getter(0).length,te=$,me("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=$,this._chunkSize=te,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(globalThis.XMLHttpRequest){Ce||Ye("Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc");var r={isDevice:!1,contents:new i}}else var r={isDevice:!1,url:o};var c=a.createFile(e,t,r,s,n);r.contents?c.contents=r.contents:r.url&&(c.contents=null,c.url=r.url),Object.defineProperties(c,{usedBytes:{get:function(){return this.contents.length}}});var F={};for(const[K,C]of Object.entries(c.stream_ops))F[K]=(...$)=>(a.forceLoadFile(c),C(...$));function T(K,C,$,p,z){var N=K.node.contents;if(z>=N.length)return 0;var te=Math.min(N.length-z,p);if(N.slice)for(var y=0;y<te;y++)C[$+y]=N[z+y];else for(var y=0;y<te;y++)C[$+y]=N.get(z+y);return te}return F.read=(K,C,$,p,z)=>(a.forceLoadFile(c),T(K,C,$,p,z)),F.mmap=(K,C,$,p,z)=>{a.forceLoadFile(c);var N=Ut(C);if(!N)throw new a.ErrnoError(48);return T(K,$e,N,C,$),{ptr:N,allocated:!0}},c.stream_ops=F,c}},En=(e,t,o)=>{if(!e)return"";var s=zt(it,e,t);return Mt.decode(it.subarray(e,s))},we={calculateAt(e,t,o){if(Pe.isAbs(t))return t;var s;if(e===-100?s=a.cwd():s=we.getStreamFromFD(e).path,t.length==0){if(!o)throw new a.ErrnoError(44);return s}return s+"/"+t},writeStat(e,t){Fe[e>>2]=t.dev,Fe[e+4>>2]=t.mode,Fe[e+8>>2]=t.nlink,Fe[e+12>>2]=t.uid,Fe[e+16>>2]=t.gid,Fe[e+20>>2]=t.rdev,ze[e+24>>3]=BigInt(t.size),Oe[e+32>>2]=4096,Oe[e+36>>2]=t.blocks;var o=t.atime.getTime(),s=t.mtime.getTime(),n=t.ctime.getTime();return ze[e+40>>3]=BigInt(Math.floor(o/1e3)),Fe[e+48>>2]=o%1e3*1e3*1e3,ze[e+56>>3]=BigInt(Math.floor(s/1e3)),Fe[e+64>>2]=s%1e3*1e3*1e3,ze[e+72>>3]=BigInt(Math.floor(n/1e3)),Fe[e+80>>2]=n%1e3*1e3*1e3,ze[e+88>>3]=BigInt(t.ino),0},writeStatFs(e,t){Fe[e+4>>2]=t.bsize,Fe[e+60>>2]=t.bsize,ze[e+8>>3]=BigInt(t.blocks),ze[e+16>>3]=BigInt(t.bfree),ze[e+24>>3]=BigInt(t.bavail),ze[e+32>>3]=BigInt(t.files),ze[e+40>>3]=BigInt(t.ffree),Fe[e+48>>2]=t.fsid,Fe[e+64>>2]=t.flags,Fe[e+56>>2]=t.namelen},doMsync(e,t,o,s,n){if(!a.isFile(t.node.mode))throw new a.ErrnoError(43);if(s&2)return 0;var i=it.slice(e,e+o);a.msync(t,i,n,o,s)},getStreamFromFD(e){return a.getStreamChecked(e)},varargs:void 0,getStr(e){return En(e)}};function An(e,t){try{return e=we.getStr(e),a.chmod(e,t),0}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function In(e,t,o,s){try{if(t=we.getStr(t),t=we.calculateAt(e,t),o&-8)return-28;var n=a.lookupPath(t,{follow:!0}).node;if(!n)return-44;var i="";return o&4&&(i+="r"),o&2&&(i+="w"),o&1&&(i+="x"),i&&a.nodePermissions(n,i)?-2:0}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function kn(e,t){try{return a.fchmod(e,t),0}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Tn(e,t,o){try{return a.fchown(e,t,o),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var wt=()=>{var e=Oe[+we.varargs>>2];return we.varargs+=4,e},_t=wt;function On(e,t,o){we.varargs=o;try{var s=we.getStreamFromFD(e);switch(t){case 0:var n=wt();if(n<0)return-28;for(;a.streams[n];)n++;return a.dupStream(s,n).fd;case 1:case 2:return 0;case 3:return s.flags;case 4:var n=wt();return s.flags|=n,0;case 12:var n=_t(),i=0;return dt[n+i>>1]=2,0;case 13:case 14:return 0}return-28}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Pn(e,t){try{return we.writeStat(t,a.fstat(e))}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var xn=9007199254740992,Fn=-9007199254740992,mt=e=>e<Fn||e>xn?NaN:Number(e);function Ln(e,t){t=mt(t);try{return isNaN(t)?-61:(a.ftruncate(e,t),0)}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}var lt=(e,t,o)=>Bt(e,it,t,o);function Cn(e,t){try{if(t===0)return-28;var o=a.cwd(),s=vt(o)+1;return t<s?-68:(lt(o,e,t),s)}catch(n){if(typeof a>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Nn(e,t,o){we.varargs=o;try{var s=we.getStreamFromFD(e);switch(t){case 21509:return s.tty?0:-59;case 21505:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcgets){var n=s.tty.ops.ioctl_tcgets(s),C=_t();Oe[C>>2]=n.c_iflag||0,Oe[C+4>>2]=n.c_oflag||0,Oe[C+8>>2]=n.c_cflag||0,Oe[C+12>>2]=n.c_lflag||0;for(var i=0;i<32;i++)$e[C+i+17]=n.c_cc[i]||0;return 0}return 0;case 21510:case 21511:case 21512:return s.tty?0:-59;case 21506:case 21507:case 21508:if(!s.tty)return-59;if(s.tty.ops.ioctl_tcsets){for(var C=_t(),r=Oe[C>>2],c=Oe[C+4>>2],F=Oe[C+8>>2],T=Oe[C+12>>2],K=[],i=0;i<32;i++)K.push($e[C+i+17]);return s.tty.ops.ioctl_tcsets(s.tty,t,{c_iflag:r,c_oflag:c,c_cflag:F,c_lflag:T,c_cc:K})}return 0;case 21519:if(!s.tty)return-59;var C=_t();return Oe[C>>2]=0,0;case 21520:return s.tty?-28:-59;case 21537:case 21531:var C=_t();return a.ioctl(s,t,C);case 21523:if(!s.tty)return-59;if(s.tty.ops.ioctl_tiocgwinsz){var $=s.tty.ops.ioctl_tiocgwinsz(s.tty),C=_t();dt[C>>1]=$[0],dt[C+2>>1]=$[1]}return 0;case 21524:return s.tty?0:-59;case 21515:return s.tty?0:-59;default:return-28}}catch(p){if(typeof a>"u"||p.name!=="ErrnoError")throw p;return-p.errno}}function Dn(e,t){try{return e=we.getStr(e),we.writeStat(t,a.lstat(e))}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Rn(e,t,o){try{return t=we.getStr(t),t=we.calculateAt(e,t),a.mkdir(t,o,0),0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function jn(e,t,o,s){try{t=we.getStr(t);var n=s&256,i=s&4096;return s=s&-6401,t=we.calculateAt(e,t,i),we.writeStat(o,n?a.lstat(t):a.stat(t))}catch(r){if(typeof a>"u"||r.name!=="ErrnoError")throw r;return-r.errno}}function Mn(e,t,o,s){we.varargs=s;try{t=we.getStr(t),t=we.calculateAt(e,t);var n=s?wt():0;return a.open(t,o,n).fd}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return-i.errno}}function zn(e,t,o,s){try{if(t=we.getStr(t),t=we.calculateAt(e,t),s<=0)return-28;var n=a.readlink(t),i=Math.min(s,vt(n)),r=$e[o+i];return lt(n,o,s+1),$e[o+i]=r,i}catch(c){if(typeof a>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function Bn(e){try{return e=we.getStr(e),a.rmdir(e),0}catch(t){if(typeof a>"u"||t.name!=="ErrnoError")throw t;return-t.errno}}function Qn(e,t){try{return e=we.getStr(e),we.writeStat(t,a.stat(e))}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Un(e,t,o){try{if(t=we.getStr(t),t=we.calculateAt(e,t),!o)a.unlink(t);else if(o===512)a.rmdir(t);else return-28;return 0}catch(s){if(typeof a>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}var Vt=e=>Fe[e>>2]+Oe[e+4>>2]*4294967296;function Wn(e,t,o,s){try{t=we.getStr(t),t=we.calculateAt(e,t,!0);var n=Date.now(),i,r;if(!o)i=n,r=n;else{var c=Vt(o),F=Oe[o+8>>2];F==1073741823?i=n:F==1073741822?i=null:i=c*1e3+F/(1e3*1e3),o+=16,c=Vt(o),F=Oe[o+8>>2],F==1073741823?r=n:F==1073741822?r=null:r=c*1e3+F/(1e3*1e3)}return(r??i)!==null&&a.utime(t,i,r),0}catch(T){if(typeof a>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}var Hn=e=>e%4===0&&(e%100!==0||e%400===0),Vn=[0,31,60,91,121,152,182,213,244,274,305,335],$n=[0,31,59,90,120,151,181,212,243,273,304,334],Gn=e=>(Hn(e.getFullYear())?Vn:$n)[e.getMonth()]+e.getDate()-1;function Jn(e,t){e=mt(e);var o=new Date(e*1e3);Oe[t>>2]=o.getSeconds(),Oe[t+4>>2]=o.getMinutes(),Oe[t+8>>2]=o.getHours(),Oe[t+12>>2]=o.getDate(),Oe[t+16>>2]=o.getMonth(),Oe[t+20>>2]=o.getFullYear()-1900,Oe[t+24>>2]=o.getDay();var s=Gn(o)|0;Oe[t+28>>2]=s,Oe[t+36>>2]=-(o.getTimezoneOffset()*60);var n=new Date(o.getFullYear(),0,1),i=new Date(o.getFullYear(),6,1).getTimezoneOffset(),r=n.getTimezoneOffset(),c=(i!=r&&o.getTimezoneOffset()==Math.min(r,i))|0;Oe[t+32>>2]=c}function Kn(e,t,o,s,n,i,r){n=mt(n);try{var c=we.getStreamFromFD(s),F=a.mmap(c,e,n,t,o),T=F.ptr;return Oe[i>>2]=F.allocated,Fe[r>>2]=T,0}catch(K){if(typeof a>"u"||K.name!=="ErrnoError")throw K;return-K.errno}}function Xn(e,t,o,s,n,i){i=mt(i);try{var r=we.getStreamFromFD(n);o&2&&we.doMsync(e,r,t,s,i)}catch(c){if(typeof a>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var Yn=(e,t,o,s)=>{var n=new Date().getFullYear(),i=new Date(n,0,1),r=new Date(n,6,1),c=i.getTimezoneOffset(),F=r.getTimezoneOffset(),T=Math.max(c,F);Fe[e>>2]=T*60,Oe[t>>2]=+(c!=F);var K=p=>{var z=p>=0?"-":"+",N=Math.abs(p);return`UTC${z}${String(Math.floor(N/60)).padStart(2,"0")}${String(N%60).padStart(2,"0")}`},C=K(c),$=K(F);F<c?(lt(C,o,17),lt($,s,17)):(lt(C,s,17),lt($,o,17))},$t=()=>performance.now(),Gt=()=>Date.now(),Zn=e=>e>=0&&e<=3;function er(e,t,o){if(!Zn(e))return 28;var s;e===0?s=Gt():s=$t();var n=Math.round(s*1e3*1e3);return ze[o>>3]=BigInt(n),0}var Jt=()=>2147483648,tr=()=>Jt(),nr=e=>{var t=(e-Ze.buffer.byteLength+65535)/65536|0;try{return Ze.grow(t),Ct(),1}catch{}},rr=e=>{var t=it.length;e>>>=0;var o=Jt();if(e>o)return!1;for(var s=1;s<=4;s*=2){var n=t*(1+.2/s);if(n=Math.min(n,e+100663296),nr(Math.min(o,Qt(Math.max(e,n),65536))))return!0}return!1},Ot={},ir=()=>ke||"./this.program",gt=()=>{if(!gt.strings){var e=(globalThis.navigator?.language??"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:ir()};for(var o in Ot)Ot[o]===void 0?delete t[o]:t[o]=Ot[o];var s=[];for(var o in t)s.push(`${o}=${t[o]}`);gt.strings=s}return gt.strings},sr=(e,t)=>{var o=0,s=0;for(var n of gt()){var i=t+o;Fe[e+s>>2]=i,o+=lt(n,i,1/0)+1,s+=4}return 0},or=(e,t)=>{var o=gt();Fe[e>>2]=o.length;var s=0;for(var n of o)s+=vt(n)+1;return Fe[t>>2]=s,0};function lr(e){try{var t=we.getStreamFromFD(e);return a.close(t),0}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return o.errno}}function ar(e,t){try{var o=0,s=0,n=0,i=we.getStreamFromFD(e),r=i.tty?2:a.isDir(i.mode)?3:a.isLink(i.mode)?7:4;return $e[t]=r,dt[t+2>>1]=n,ze[t+8>>3]=BigInt(o),ze[t+16>>3]=BigInt(s),0}catch(c){if(typeof a>"u"||c.name!=="ErrnoError")throw c;return c.errno}}var cr=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Fe[t>>2],c=Fe[t+4>>2];t+=8;var F=a.read(e,$e,r,c,s);if(F<0)return-1;if(n+=F,F<c)break}return n};function ur(e,t,o,s){try{var n=cr(we.getStreamFromFD(e),t,o);return Fe[s>>2]=n,0}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function _r(e,t,o,s){t=mt(t);try{if(isNaN(t))return 61;var n=we.getStreamFromFD(e);return a.llseek(n,t,o),ze[s>>3]=BigInt(n.position),n.getdents&&t===0&&o===0&&(n.getdents=null),0}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return i.errno}}function fr(e){try{var t=we.getStreamFromFD(e);return t.stream_ops?.fsync?.(t)}catch(o){if(typeof a>"u"||o.name!=="ErrnoError")throw o;return o.errno}}var dr=(e,t,o,s)=>{for(var n=0,i=0;i<o;i++){var r=Fe[t>>2],c=Fe[t+4>>2];t+=8;var F=a.write(e,$e,r,c,s);if(F<0)return-1;if(n+=F,F<c)break}return n};function pr(e,t,o,s){try{var n=dr(we.getStreamFromFD(e),t,o);return Fe[s>>2]=n,0}catch(i){if(typeof a>"u"||i.name!=="ErrnoError")throw i;return i.errno}}if(a.createPreloadedFile=Sn,a.preloadFile=Ht,a.staticInit(),en(),_.noExitRuntime&&_.noExitRuntime,_.preloadPlugins&&(Wt=_.preloadPlugins),_.print&&(me=_.print),_.printErr&&(Le=_.printErr),_.wasmBinary&&(He=_.wasmBinary),_.arguments&&_.arguments,_.thisProgram&&(ke=_.thisProgram),_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);_.preInit.length>0;)_.preInit.shift()();_.wasmMemory=Ze;var Kt;function hr(e){_._sqlite3_status64=e.sqlite3_status64,_._sqlite3_status=e.sqlite3_status,_._sqlite3_db_status64=e.sqlite3_db_status64,_._sqlite3_msize=e.sqlite3_msize,_._sqlite3_db_status=e.sqlite3_db_status,_._sqlite3_vfs_find=e.sqlite3_vfs_find,_._sqlite3_initialize=e.sqlite3_initialize,_._sqlite3_malloc=e.sqlite3_malloc,_._sqlite3_free=e.sqlite3_free,_._sqlite3_vfs_register=e.sqlite3_vfs_register,_._sqlite3_vfs_unregister=e.sqlite3_vfs_unregister,_._sqlite3_malloc64=e.sqlite3_malloc64,_._sqlite3_realloc=e.sqlite3_realloc,_._sqlite3_realloc64=e.sqlite3_realloc64,_._sqlite3_value_text=e.sqlite3_value_text,_._sqlite3_randomness=e.sqlite3_randomness,_._sqlite3_stricmp=e.sqlite3_stricmp,_._sqlite3_strnicmp=e.sqlite3_strnicmp,_._sqlite3_uri_parameter=e.sqlite3_uri_parameter,_._sqlite3_uri_boolean=e.sqlite3_uri_boolean,_._sqlite3_serialize=e.sqlite3_serialize,_._sqlite3_prepare_v2=e.sqlite3_prepare_v2,_._sqlite3_step=e.sqlite3_step,_._sqlite3_column_int64=e.sqlite3_column_int64,_._sqlite3_reset=e.sqlite3_reset,_._sqlite3_exec=e.sqlite3_exec,_._sqlite3_column_int=e.sqlite3_column_int,_._sqlite3_finalize=e.sqlite3_finalize,_._sqlite3_file_control=e.sqlite3_file_control,_._sqlite3_column_name=e.sqlite3_column_name,_._sqlite3_column_text=e.sqlite3_column_text,_._sqlite3_column_type=e.sqlite3_column_type,_._sqlite3_errmsg=e.sqlite3_errmsg,_._sqlite3_deserialize=e.sqlite3_deserialize,_._sqlite3_clear_bindings=e.sqlite3_clear_bindings,_._sqlite3_value_blob=e.sqlite3_value_blob,_._sqlite3_value_bytes=e.sqlite3_value_bytes,_._sqlite3_value_double=e.sqlite3_value_double,_._sqlite3_value_int=e.sqlite3_value_int,_._sqlite3_value_int64=e.sqlite3_value_int64,_._sqlite3_value_subtype=e.sqlite3_value_subtype,_._sqlite3_value_pointer=e.sqlite3_value_pointer,_._sqlite3_value_type=e.sqlite3_value_type,_._sqlite3_value_nochange=e.sqlite3_value_nochange,_._sqlite3_value_frombind=e.sqlite3_value_frombind,_._sqlite3_value_dup=e.sqlite3_value_dup,_._sqlite3_value_free=e.sqlite3_value_free,_._sqlite3_result_blob=e.sqlite3_result_blob,_._sqlite3_result_error_toobig=e.sqlite3_result_error_toobig,_._sqlite3_result_error_nomem=e.sqlite3_result_error_nomem,_._sqlite3_result_double=e.sqlite3_result_double,_._sqlite3_result_error=e.sqlite3_result_error,_._sqlite3_result_int=e.sqlite3_result_int,_._sqlite3_result_int64=e.sqlite3_result_int64,_._sqlite3_result_null=e.sqlite3_result_null,_._sqlite3_result_pointer=e.sqlite3_result_pointer,_._sqlite3_result_subtype=e.sqlite3_result_subtype,_._sqlite3_result_text=e.sqlite3_result_text,_._sqlite3_result_zeroblob=e.sqlite3_result_zeroblob,_._sqlite3_result_zeroblob64=e.sqlite3_result_zeroblob64,_._sqlite3_result_error_code=e.sqlite3_result_error_code,_._sqlite3_user_data=e.sqlite3_user_data,_._sqlite3_context_db_handle=e.sqlite3_context_db_handle,_._sqlite3_vtab_nochange=e.sqlite3_vtab_nochange,_._sqlite3_vtab_in_first=e.sqlite3_vtab_in_first,_._sqlite3_vtab_in_next=e.sqlite3_vtab_in_next,_._sqlite3_aggregate_context=e.sqlite3_aggregate_context,_._sqlite3_get_auxdata=e.sqlite3_get_auxdata,_._sqlite3_set_auxdata=e.sqlite3_set_auxdata,_._sqlite3_column_count=e.sqlite3_column_count,_._sqlite3_data_count=e.sqlite3_data_count,_._sqlite3_column_blob=e.sqlite3_column_blob,_._sqlite3_column_bytes=e.sqlite3_column_bytes,_._sqlite3_column_double=e.sqlite3_column_double,_._sqlite3_column_value=e.sqlite3_column_value,_._sqlite3_column_decltype=e.sqlite3_column_decltype,_._sqlite3_column_database_name=e.sqlite3_column_database_name,_._sqlite3_column_table_name=e.sqlite3_column_table_name,_._sqlite3_column_origin_name=e.sqlite3_column_origin_name,_._sqlite3_bind_blob=e.sqlite3_bind_blob,_._sqlite3_bind_double=e.sqlite3_bind_double,_._sqlite3_bind_int=e.sqlite3_bind_int,_._sqlite3_bind_int64=e.sqlite3_bind_int64,_._sqlite3_bind_null=e.sqlite3_bind_null,_._sqlite3_bind_pointer=e.sqlite3_bind_pointer,_._sqlite3_bind_text=e.sqlite3_bind_text,_._sqlite3_bind_parameter_count=e.sqlite3_bind_parameter_count,_._sqlite3_bind_parameter_name=e.sqlite3_bind_parameter_name,_._sqlite3_bind_parameter_index=e.sqlite3_bind_parameter_index,_._sqlite3_db_handle=e.sqlite3_db_handle,_._sqlite3_stmt_readonly=e.sqlite3_stmt_readonly,_._sqlite3_stmt_isexplain=e.sqlite3_stmt_isexplain,_._sqlite3_stmt_explain=e.sqlite3_stmt_explain,_._sqlite3_stmt_busy=e.sqlite3_stmt_busy,_._sqlite3_next_stmt=e.sqlite3_next_stmt,_._sqlite3_stmt_status=e.sqlite3_stmt_status,_._sqlite3_sql=e.sqlite3_sql,_._sqlite3_expanded_sql=e.sqlite3_expanded_sql,_._sqlite3_preupdate_old=e.sqlite3_preupdate_old,_._sqlite3_preupdate_count=e.sqlite3_preupdate_count,_._sqlite3_preupdate_depth=e.sqlite3_preupdate_depth,_._sqlite3_preupdate_blobwrite=e.sqlite3_preupdate_blobwrite,_._sqlite3_preupdate_new=e.sqlite3_preupdate_new,_._sqlite3_value_numeric_type=e.sqlite3_value_numeric_type,_._sqlite3_set_authorizer=e.sqlite3_set_authorizer,_._sqlite3_strglob=e.sqlite3_strglob,_._sqlite3_strlike=e.sqlite3_strlike,_._sqlite3_auto_extension=e.sqlite3_auto_extension,_._sqlite3_cancel_auto_extension=e.sqlite3_cancel_auto_extension,_._sqlite3_reset_auto_extension=e.sqlite3_reset_auto_extension,_._sqlite3_prepare_v3=e.sqlite3_prepare_v3,_._sqlite3_create_module=e.sqlite3_create_module,_._sqlite3_create_module_v2=e.sqlite3_create_module_v2,_._sqlite3_drop_modules=e.sqlite3_drop_modules,_._sqlite3_declare_vtab=e.sqlite3_declare_vtab,_._sqlite3_vtab_on_conflict=e.sqlite3_vtab_on_conflict,_._sqlite3_vtab_collation=e.sqlite3_vtab_collation,_._sqlite3_vtab_in=e.sqlite3_vtab_in,_._sqlite3_vtab_rhs_value=e.sqlite3_vtab_rhs_value,_._sqlite3_vtab_distinct=e.sqlite3_vtab_distinct,_._sqlite3_keyword_name=e.sqlite3_keyword_name,_._sqlite3_keyword_count=e.sqlite3_keyword_count,_._sqlite3_keyword_check=e.sqlite3_keyword_check,_._sqlite3_complete=e.sqlite3_complete,_._sqlite3_libversion=e.sqlite3_libversion,_._sqlite3_libversion_number=e.sqlite3_libversion_number,_._sqlite3_shutdown=e.sqlite3_shutdown,_._sqlite3_last_insert_rowid=e.sqlite3_last_insert_rowid,_._sqlite3_set_last_insert_rowid=e.sqlite3_set_last_insert_rowid,_._sqlite3_changes64=e.sqlite3_changes64,_._sqlite3_changes=e.sqlite3_changes,_._sqlite3_total_changes64=e.sqlite3_total_changes64,_._sqlite3_total_changes=e.sqlite3_total_changes,_._sqlite3_txn_state=e.sqlite3_txn_state,_._sqlite3_close_v2=e.sqlite3_close_v2,_._sqlite3_busy_handler=e.sqlite3_busy_handler,_._sqlite3_progress_handler=e.sqlite3_progress_handler,_._sqlite3_busy_timeout=e.sqlite3_busy_timeout,_._sqlite3_interrupt=e.sqlite3_interrupt,_._sqlite3_is_interrupted=e.sqlite3_is_interrupted,_._sqlite3_create_function=e.sqlite3_create_function,_._sqlite3_create_function_v2=e.sqlite3_create_function_v2,_._sqlite3_create_window_function=e.sqlite3_create_window_function,_._sqlite3_overload_function=e.sqlite3_overload_function,_._sqlite3_trace_v2=e.sqlite3_trace_v2,_._sqlite3_commit_hook=e.sqlite3_commit_hook,_._sqlite3_update_hook=e.sqlite3_update_hook,_._sqlite3_rollback_hook=e.sqlite3_rollback_hook,_._sqlite3_preupdate_hook=e.sqlite3_preupdate_hook,_._sqlite3_set_errmsg=e.sqlite3_set_errmsg,_._sqlite3_error_offset=e.sqlite3_error_offset,_._sqlite3_errcode=e.sqlite3_errcode,_._sqlite3_extended_errcode=e.sqlite3_extended_errcode,_._sqlite3_errstr=e.sqlite3_errstr,_._sqlite3_limit=e.sqlite3_limit,_._sqlite3_open=e.sqlite3_open,_._sqlite3_open_v2=e.sqlite3_open_v2,_._sqlite3_create_collation=e.sqlite3_create_collation,_._sqlite3_create_collation_v2=e.sqlite3_create_collation_v2,_._sqlite3_collation_needed=e.sqlite3_collation_needed,_._sqlite3_get_autocommit=e.sqlite3_get_autocommit,_._sqlite3_table_column_metadata=e.sqlite3_table_column_metadata,_._sqlite3_extended_result_codes=e.sqlite3_extended_result_codes,_._sqlite3_uri_key=e.sqlite3_uri_key,_._sqlite3_uri_int64=e.sqlite3_uri_int64,_._sqlite3_db_name=e.sqlite3_db_name,_._sqlite3_db_filename=e.sqlite3_db_filename,_._sqlite3_db_readonly=e.sqlite3_db_readonly,_._sqlite3_compileoption_used=e.sqlite3_compileoption_used,_._sqlite3_compileoption_get=e.sqlite3_compileoption_get,_._sqlite3session_diff=e.sqlite3session_diff,_._sqlite3session_attach=e.sqlite3session_attach,_._sqlite3session_create=e.sqlite3session_create,_._sqlite3session_delete=e.sqlite3session_delete,_._sqlite3session_table_filter=e.sqlite3session_table_filter,_._sqlite3session_changeset=e.sqlite3session_changeset,_._sqlite3session_changeset_strm=e.sqlite3session_changeset_strm,_._sqlite3session_patchset_strm=e.sqlite3session_patchset_strm,_._sqlite3session_patchset=e.sqlite3session_patchset,_._sqlite3session_enable=e.sqlite3session_enable,_._sqlite3session_indirect=e.sqlite3session_indirect,_._sqlite3session_isempty=e.sqlite3session_isempty,_._sqlite3session_memory_used=e.sqlite3session_memory_used,_._sqlite3session_object_config=e.sqlite3session_object_config,_._sqlite3session_changeset_size=e.sqlite3session_changeset_size,_._sqlite3changeset_start=e.sqlite3changeset_start,_._sqlite3changeset_start_v2=e.sqlite3changeset_start_v2,_._sqlite3changeset_start_strm=e.sqlite3changeset_start_strm,_._sqlite3changeset_start_v2_strm=e.sqlite3changeset_start_v2_strm,_._sqlite3changeset_next=e.sqlite3changeset_next,_._sqlite3changeset_op=e.sqlite3changeset_op,_._sqlite3changeset_pk=e.sqlite3changeset_pk,_._sqlite3changeset_old=e.sqlite3changeset_old,_._sqlite3changeset_new=e.sqlite3changeset_new,_._sqlite3changeset_conflict=e.sqlite3changeset_conflict,_._sqlite3changeset_fk_conflicts=e.sqlite3changeset_fk_conflicts,_._sqlite3changeset_finalize=e.sqlite3changeset_finalize,_._sqlite3changeset_invert=e.sqlite3changeset_invert,_._sqlite3changeset_invert_strm=e.sqlite3changeset_invert_strm,_._sqlite3changeset_apply_v2=e.sqlite3changeset_apply_v2,_._sqlite3changeset_apply_v3=e.sqlite3changeset_apply_v3,_._sqlite3changeset_apply=e.sqlite3changeset_apply,_._sqlite3changeset_apply_v3_strm=e.sqlite3changeset_apply_v3_strm,_._sqlite3changeset_apply_v2_strm=e.sqlite3changeset_apply_v2_strm,_._sqlite3changeset_apply_strm=e.sqlite3changeset_apply_strm,_._sqlite3changegroup_new=e.sqlite3changegroup_new,_._sqlite3changegroup_add=e.sqlite3changegroup_add,_._sqlite3changegroup_output=e.sqlite3changegroup_output,_._sqlite3changegroup_add_strm=e.sqlite3changegroup_add_strm,_._sqlite3changegroup_output_strm=e.sqlite3changegroup_output_strm,_._sqlite3changegroup_delete=e.sqlite3changegroup_delete,_._sqlite3changeset_concat=e.sqlite3changeset_concat,_._sqlite3changeset_concat_strm=e.sqlite3changeset_concat_strm,_._sqlite3session_config=e.sqlite3session_config,_._sqlite3_sourceid=e.sqlite3_sourceid,_._sqlite3__wasm_pstack_ptr=e.sqlite3__wasm_pstack_ptr,_._sqlite3__wasm_pstack_restore=e.sqlite3__wasm_pstack_restore,_._sqlite3__wasm_pstack_alloc=e.sqlite3__wasm_pstack_alloc,_._sqlite3__wasm_pstack_remaining=e.sqlite3__wasm_pstack_remaining,_._sqlite3__wasm_pstack_quota=e.sqlite3__wasm_pstack_quota,_._sqlite3__wasm_test_struct=e.sqlite3__wasm_test_struct,_._sqlite3__wasm_enum_json=e.sqlite3__wasm_enum_json,_._sqlite3__wasm_vfs_unlink=e.sqlite3__wasm_vfs_unlink,_._sqlite3__wasm_db_vfs=e.sqlite3__wasm_db_vfs,_._sqlite3__wasm_db_reset=e.sqlite3__wasm_db_reset,_._sqlite3__wasm_db_export_chunked=e.sqlite3__wasm_db_export_chunked,_._sqlite3__wasm_db_serialize=e.sqlite3__wasm_db_serialize,_._sqlite3__wasm_vfs_create_file=e.sqlite3__wasm_vfs_create_file,_._sqlite3__wasm_posix_create_file=e.sqlite3__wasm_posix_create_file,_._sqlite3__wasm_kvvfsMakeKey=e.sqlite3__wasm_kvvfsMakeKey,_._sqlite3__wasm_kvvfs_methods=e.sqlite3__wasm_kvvfs_methods,_._sqlite3__wasm_vtab_config=e.sqlite3__wasm_vtab_config,_._sqlite3__wasm_db_config_ip=e.sqlite3__wasm_db_config_ip,_._sqlite3__wasm_db_config_pii=e.sqlite3__wasm_db_config_pii,_._sqlite3__wasm_db_config_s=e.sqlite3__wasm_db_config_s,_._sqlite3__wasm_config_i=e.sqlite3__wasm_config_i,_._sqlite3__wasm_config_ii=e.sqlite3__wasm_config_ii,_._sqlite3__wasm_config_j=e.sqlite3__wasm_config_j,_._sqlite3__wasm_qfmt_token=e.sqlite3__wasm_qfmt_token,_._sqlite3__wasm_kvvfs_decode=e.sqlite3__wasm_kvvfs_decode,_._sqlite3__wasm_kvvfs_encode=e.sqlite3__wasm_kvvfs_encode,_._sqlite3__wasm_init_wasmfs=e.sqlite3__wasm_init_wasmfs,_._sqlite3__wasm_test_intptr=e.sqlite3__wasm_test_intptr,_._sqlite3__wasm_test_voidptr=e.sqlite3__wasm_test_voidptr,_._sqlite3__wasm_test_int64_max=e.sqlite3__wasm_test_int64_max,_._sqlite3__wasm_test_int64_min=e.sqlite3__wasm_test_int64_min,_._sqlite3__wasm_test_int64_times2=e.sqlite3__wasm_test_int64_times2,_._sqlite3__wasm_test_int64_minmax=e.sqlite3__wasm_test_int64_minmax,_._sqlite3__wasm_test_int64ptr=e.sqlite3__wasm_test_int64ptr,_._sqlite3__wasm_test_stack_overflow=e.sqlite3__wasm_test_stack_overflow,_._sqlite3__wasm_test_str_hello=e.sqlite3__wasm_test_str_hello,_._sqlite3__wasm_SQLTester_strglob=e.sqlite3__wasm_SQLTester_strglob,_._malloc=e.malloc,_._free=e.free,_._realloc=e.realloc,Kt=e.emscripten_builtin_memalign,e._emscripten_stack_restore,e._emscripten_stack_alloc,e.emscripten_stack_get_current,e.__indirect_function_table}var Xt={__syscall_chmod:An,__syscall_faccessat:In,__syscall_fchmod:kn,__syscall_fchown32:Tn,__syscall_fcntl64:On,__syscall_fstat64:Pn,__syscall_ftruncate64:Ln,__syscall_getcwd:Cn,__syscall_ioctl:Nn,__syscall_lstat64:Dn,__syscall_mkdirat:Rn,__syscall_newfstatat:jn,__syscall_openat:Mn,__syscall_readlinkat:zn,__syscall_rmdir:Bn,__syscall_stat64:Qn,__syscall_unlinkat:Un,__syscall_utimensat:Wn,_localtime_js:Jn,_mmap_js:Kn,_munmap_js:Xn,_tzset_js:Yn,clock_time_get:er,emscripten_date_now:Gt,emscripten_get_heap_max:tr,emscripten_get_now:$t,emscripten_resize_heap:rr,environ_get:sr,environ_sizes_get:or,fd_close:lr,fd_fdstat_get:ar,fd_read:ur,fd_seek:_r,fd_sync:fr,fd_write:pr,memory:Ze};function Pt(){if(ot>0){ht=Pt;return}if(tn(),ot>0){ht=Pt;return}function e(){_.calledRun=!0,!ct&&(nn(),yt?.(_),_.onRuntimeInitialized?.(),rn())}_.setStatus?(_.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>_.setStatus(""),1),e()},1)):e()}var ft=await _n();return Pt(),_.runSQLite3PostLoadInit=async function(e,t,o){delete t.runSQLite3PostLoadInit,globalThis.sqlite3ApiBootstrap=async function s(n=globalThis.sqlite3ApiConfig||s.defaultConfig){if(s.sqlite3)return(s.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),s.sqlite3;const i=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},n||{});Object.assign(i,{allocExportName:i.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:i.useStdAlloc?"free":"sqlite3_free",reallocExportName:i.useStdAlloc?"realloc":"sqlite3_realloc"}),["exports","memory","functionTable","wasmfsOpfsDir"].forEach(f=>{typeof i[f]=="function"&&(i[f]=i[f]())});const r=Object.create(null),c=Object.create(null),F=f=>r.sqlite3_js_rc_str&&r.sqlite3_js_rc_str(f)||"Unknown result code #"+f,T=f=>typeof f=="number"&&f===(f|0)&&f<=2147483647&&f>=-2147483648;class K extends Error{constructor(...m){let q;if(m.length)if(T(m[0]))if(q=m[0],m.length===1)super(F(m[0]));else{const j=F(q);typeof m[1]=="object"?super(j,m[1]):(m[0]=j+":",super(m.join(" ")))}else m.length===2&&typeof m[1]=="object"?super(...m):super(m.join(" "));this.resultCode=q||r.SQLITE_ERROR,this.name="SQLite3Error"}}K.toss=(...f)=>{throw new K(...f)};const C=K.toss;i.wasmfsOpfsDir&&!/^\/[^/]+$/.test(i.wasmfsOpfsDir)&&C("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const $=function f(m){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),m>=f._min&&m<=f._max},p=f=>f>=-2147483647n-1n&&f<=2147483647n,z=function f(m){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),m>=f._min&&m<=f._max},N=f=>f&&f.constructor&&T(f.constructor.BYTES_PER_ELEMENT)?f:!1,te=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),y=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),b=f=>te(f)||C("Value is not of a supported TypedArray type."),D=function(f){return y(f)?c.typedArrayToString(f instanceof ArrayBuffer?new Uint8Array(f):f,0,f.length):Array.isArray(f)?f.join(""):(c.isPtr(f)&&(f=c.cstrToJs(f)),f)};class Q extends Error{constructor(...m){m.length===2&&typeof m[1]=="object"?super(...m):m.length?super(m.join(" ")):super("Allocation failed."),this.resultCode=r.SQLITE_NOMEM,this.name="WasmAllocError"}}Q.toss=(...f)=>{throw new Q(...f)},Object.assign(r,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,m,q,j,Y,oe,ge,ye,fe)=>{},sqlite3_create_function:(f,m,q,j,Y,oe,ge,ye)=>{},sqlite3_create_window_function:(f,m,q,j,Y,oe,ge,ye,fe,H)=>{},sqlite3_prepare_v3:(f,m,q,j,Y,oe)=>{},sqlite3_prepare_v2:(f,m,q,j,Y)=>{},sqlite3_exec:(f,m,q,j,Y)=>{},sqlite3_randomness:(f,m)=>{}});const E={affirmBindableTypedArray:b,flexibleString:D,bigIntFits32:p,bigIntFits64:$,bigIntFitsDouble:z,isBindableTypedArray:te,isInt32:T,isSQLableTypedArray:y,isTypedArray:N,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,toss:function(...f){throw new Error(f.join(" "))},toss3:C,typedArrayPart:c.typedArrayPart,assert:function(f,m){f||E.toss("Assertion failed:",m)},affirmDbHeader:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m="SQLite format 3";15>f.byteLength&&C("Input does not contain an SQLite3 database header.");for(let q=0;q<15;++q)m.charCodeAt(q)!==f[q]&&C("Input does not contain an SQLite3 database header.")},affirmIsDb:function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f));const m=f.byteLength;(m<512||m%512!==0)&&C("Byte array size",m,"is invalid for an SQLite3 db."),E.affirmDbHeader(f)}};Object.assign(c,{exports:i.exports||C("Missing API config.exports (WASM module exports)."),memory:i.memory||i.exports.memory||C("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),pointerSize:typeof i.exports.sqlite3_libversion()=="number"?4:8,bigIntEnabled:!!i.bigIntEnabled,functionTable:i.functionTable,alloc:void 0,realloc:void 0,dealloc:void 0}),c.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),b(f);const m=c.alloc(f.byteLength||1);return c.heapForSize(f.constructor).set(f.byteLength?f:[0],Number(m)),m};{const f=i.allocExportName,m=i.deallocExportName,q=i.reallocExportName;for(const j of[f,m,q])c.exports[j]instanceof Function||C("Missing required exports[",j,"] function.");c.alloc=function j(Y){return j.impl(Y)||Q.toss("Failed to allocate",Y," bytes.")},c.alloc.impl=c.exports[f],c.realloc=function j(Y,oe){const ge=j.impl(c.ptr.coerce(Y),oe);return oe?ge||Q.toss("Failed to reallocate",oe," bytes."):c.ptr.null},c.realloc.impl=c.exports[q],c.dealloc=function j(Y){j.impl(c.ptr.coerce(Y))},c.dealloc.impl=c.exports[m]}c.compileOptionUsed=function f(m){if(arguments.length){if(Array.isArray(m)){const q=Object.create(null);return m.forEach(j=>{q[j]=r.sqlite3_compileoption_used(j)}),q}else if(typeof m=="object")return Object.keys(m).forEach(q=>{m[q]=r.sqlite3_compileoption_used(q)}),m}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(ge,ye){const fe=f._rx.exec(ge);ye[0]=fe?fe[1]:ge,ye[1]=fe?f._rxInt.test(fe[2])?+fe[2]:fe[2]:!0});const q=Object.create(null),j=[0,0];let Y=0,oe;for(;oe=r.sqlite3_compileoption_get(Y++);)f._opt(oe,j),q[j[0]]=j[1];return f._result=q}return typeof m=="string"?!!r.sqlite3_compileoption_used(m):!1},c.pstack=Object.assign(Object.create(null),{restore:c.exports.sqlite3__wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=c.sizeofIR(f))&&Q.toss("Invalid value for pstack.alloc(",arguments[0],")"),c.exports.sqlite3__wasm_pstack_alloc(f)||Q.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,m){typeof m=="string"&&!(m=c.sizeofIR(m))&&Q.toss("Invalid size value for allocChunks(",arguments[1],")");const q=c.pstack.alloc(f*m),j=[q];let Y=1,oe=m;for(;Y<f;++Y,oe+=m)j.push(c.ptr.add(q,oe));return j},allocPtr:(f=1,m=!0)=>f===1?c.pstack.alloc(m?8:c.ptr.size):c.pstack.allocChunks(f,m?8:c.ptr.size),call:function(f){const m=c.pstack.pointer;try{return f(O)}finally{c.pstack.restore(m)}}}),Object.defineProperties(c.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:c.exports.sqlite3__wasm_pstack_remaining}}),r.sqlite3_randomness=(...f)=>{if(f.length===1&&E.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const m=f[0];if(m.byteLength===0)return c.exports.sqlite3_randomness(0,c.ptr.null),m;const q=c.pstack.pointer;try{let j=m.byteLength,Y=0;const oe=c.exports.sqlite3_randomness,ge=c.heap8u(),ye=j<512?j:512,fe=c.pstack.alloc(ye);do{const H=j>ye?ye:j;oe(H,fe),m.set(c.typedArrayPart(ge,fe,c.ptr.add(fe,H)),Y),j-=H,Y+=H}while(j>0)}catch(j){i.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",j)}finally{c.pstack.restore(q)}return m}c.exports.sqlite3_randomness(...f)},r.sqlite3_wasmfs_opfs_dir=(function(){if(this.dir!==void 0)return this.dir;const f=i.wasmfsOpfsDir;if(!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!c.exports.sqlite3__wasm_init_wasmfs)return this.dir="";try{return f&&c.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],f)===0?this.dir=f:this.dir=""}catch{return this.dir=""}}).bind(Object.create(null)),r.sqlite3_wasmfs_filename_is_persistent=function(f){const m=r.sqlite3_wasmfs_opfs_dir();return m&&f?f.startsWith(m+"/"):!1},r.sqlite3_js_db_uses_vfs=function(f,m,q=0){try{const j=r.sqlite3_vfs_find(m);return j?f?j===r.sqlite3_js_db_vfs(f,q)?j:!1:j===r.sqlite3_vfs_find(0)?j:!1:!1}catch{return!1}},r.sqlite3_js_vfs_list=function(){const f=[];let m=r.sqlite3_vfs_find(c.ptr.null);for(;m;){const q=new r.sqlite3_vfs(m);f.push(c.cstrToJs(q.$zName)),m=q.$pNext,q.dispose()}return f},r.sqlite3_js_db_export=function(f,m=0){f=c.xWrap.testConvertArg("sqlite3*",f),f||C("Invalid sqlite3* argument."),c.bigIntEnabled||C("BigInt support is not enabled.");const q=c.scopedAllocPush();let j;try{const Y=c.scopedAlloc(8+c.ptr.size),oe=c.ptr.add(Y,8),ge=m?c.isPtr(m)?m:c.scopedAllocCString(""+m):c.ptr.null;let ye=c.exports.sqlite3__wasm_db_serialize(f,ge,oe,Y,0);ye&&C("Database serialization failed with code",O.capi.sqlite3_js_rc_str(ye)),j=c.peekPtr(oe);const fe=c.peek(Y,"i64");return ye=fe?c.heap8u().slice(Number(j),Number(j)+Number(fe)):new Uint8Array,ye}finally{j&&c.exports.sqlite3_free(j),c.scopedAllocPop(q)}},r.sqlite3_js_db_vfs=(f,m=c.ptr.null)=>E.sqlite3__wasm_db_vfs(f,m),r.sqlite3_js_aggregate_context=(f,m)=>r.sqlite3_aggregate_context(f,m)||(m?Q.toss("Cannot allocate",m,"bytes for sqlite3_aggregate_context()"):0),r.sqlite3_js_posix_create_file=function(f,m,q){let j;m&&c.isPtr(m)?j=m:m instanceof ArrayBuffer||m instanceof Uint8Array?(j=c.allocFromTypedArray(m),(arguments.length<3||!E.isInt32(q)||q<0)&&(q=m.byteLength)):K.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!E.isInt32(q)||q<0)&&K.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const Y=E.sqlite3__wasm_posix_create_file(f,j,q);Y&&K.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(Y))}finally{j&&j!==m&&c.dealloc(j)}},r.sqlite3_js_vfs_create_file=function(f,m,q,j){i.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternatives.");let Y;q?c.isPtr(q)?Y=q:(q instanceof ArrayBuffer&&(q=new Uint8Array(q)),q instanceof Uint8Array?(Y=c.allocFromTypedArray(q),(arguments.length<4||!E.isInt32(j)||j<0)&&(j=q.byteLength)):K.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):Y=0,(!E.isInt32(j)||j<0)&&(Y&&Y!==q&&c.dealloc(Y),K.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const oe=E.sqlite3__wasm_vfs_create_file(f,m,Y,j);oe&&K.toss("Creation of file failed with sqlite3 result code",r.sqlite3_js_rc_str(oe))}finally{Y&&Y!==q&&c.dealloc(Y)}},r.sqlite3_js_sql_to_string=f=>{if(typeof f=="string")return f;const m=D(v);return m===v?void 0:m},r.sqlite3_db_config=(function(f,m,...q){switch(m){case r.SQLITE_DBCONFIG_ENABLE_FKEY:case r.SQLITE_DBCONFIG_ENABLE_TRIGGER:case r.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case r.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case r.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case r.SQLITE_DBCONFIG_ENABLE_QPSG:case r.SQLITE_DBCONFIG_TRIGGER_EQP:case r.SQLITE_DBCONFIG_RESET_DATABASE:case r.SQLITE_DBCONFIG_DEFENSIVE:case r.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case r.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case r.SQLITE_DBCONFIG_DQS_DML:case r.SQLITE_DBCONFIG_DQS_DDL:case r.SQLITE_DBCONFIG_ENABLE_VIEW:case r.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case r.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case r.SQLITE_DBCONFIG_STMT_SCANSTATUS:case r.SQLITE_DBCONFIG_REVERSE_SCANORDER:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case r.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case r.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=c.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(f,m,q[0],q[1]||0);case r.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=c.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(f,m,q[0],q[1],q[2]);case r.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=c.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(f,m,q[0]);default:return r.SQLITE_MISUSE}}).bind(Object.create(null)),r.sqlite3_value_to_js=function(f,m=!0){let q;const j=r.sqlite3_value_type(f);switch(j){case r.SQLITE_INTEGER:c.bigIntEnabled?(q=r.sqlite3_value_int64(f),E.bigIntFitsDouble(q)&&(q=Number(q))):q=r.sqlite3_value_double(f);break;case r.SQLITE_FLOAT:q=r.sqlite3_value_double(f);break;case r.SQLITE_TEXT:q=r.sqlite3_value_text(f);break;case r.SQLITE_BLOB:{const Y=r.sqlite3_value_bytes(f),oe=r.sqlite3_value_blob(f);Y&&!oe&&O.WasmAllocError.toss("Cannot allocate memory for blob argument of",Y,"byte(s)"),q=Y?c.heap8u().slice(Number(oe),Number(oe)+Number(Y)):null;break}case r.SQLITE_NULL:q=null;break;default:m&&C(r.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",j),q=void 0}return q},r.sqlite3_values_to_js=function(f,m,q=!0){let j;const Y=[];for(j=0;j<f;++j)Y.push(r.sqlite3_value_to_js(c.peekPtr(c.ptr.add(m,c.ptr.size*j)),q));return Y},r.sqlite3_result_error_js=function(f,m){m instanceof Q?r.sqlite3_result_error_nomem(f):r.sqlite3_result_error(f,""+m,-1)},r.sqlite3_result_js=function(f,m){if(m instanceof Error){r.sqlite3_result_error_js(f,m);return}try{switch(typeof m){case"undefined":break;case"boolean":r.sqlite3_result_int(f,m?1:0);break;case"bigint":E.bigIntFits32(m)?r.sqlite3_result_int(f,Number(m)):E.bigIntFitsDouble(m)?r.sqlite3_result_double(f,Number(m)):c.bigIntEnabled?E.bigIntFits64(m)?r.sqlite3_result_int64(f,m):C("BigInt value",m.toString(),"is too BigInt for int64."):C("BigInt value",m.toString(),"is too BigInt.");break;case"number":{let q;E.isInt32(m)?q=r.sqlite3_result_int:c.bigIntEnabled&&Number.isInteger(m)&&E.bigIntFits64(BigInt(m))?q=r.sqlite3_result_int64:q=r.sqlite3_result_double,q(f,m);break}case"string":{const[q,j]=c.allocCString(m,!0);r.sqlite3_result_text(f,q,j,r.SQLITE_WASM_DEALLOC);break}case"object":if(m===null){r.sqlite3_result_null(f);break}else if(E.isBindableTypedArray(m)){const q=c.allocFromTypedArray(m);r.sqlite3_result_blob(f,q,m.byteLength,r.SQLITE_WASM_DEALLOC);break}default:C("Don't not how to handle this UDF result value:",typeof m,m)}}catch(q){r.sqlite3_result_error_js(f,q)}},r.sqlite3_column_js=function(f,m,q=!0){const j=r.sqlite3_column_value(f,m);return j===0?void 0:r.sqlite3_value_to_js(j,q)};{const f=(function(m,q,j){j=r[j],this.ptr?c.pokePtr(this.ptr,0):this.ptr=c.allocPtr();const Y=j(m,q,this.ptr);if(Y)return K.toss(Y,arguments[2]+"() failed with code "+Y);const oe=c.peekPtr(this.ptr);return oe?r.sqlite3_value_to_js(oe,!0):void 0}).bind(Object.create(null));r.sqlite3_preupdate_new_js=(m,q)=>f(m,q,"sqlite3_preupdate_new"),r.sqlite3_preupdate_old_js=(m,q)=>f(m,q,"sqlite3_preupdate_old"),r.sqlite3changeset_new_js=(m,q)=>f(m,q,"sqlite3changeset_new"),r.sqlite3changeset_old_js=(m,q)=>f(m,q,"sqlite3changeset_old")}const O={WasmAllocError:Q,SQLite3Error:K,capi:r,util:E,wasm:c,config:i,version:Object.create(null),client:void 0,asyncPostInit:(async function f(){if(f.isReady instanceof Promise)return f.isReady;let m=this.initializersAsync;delete this.initializersAsync;const q=async()=>(O.__isUnderTest||(delete O.util,delete O.StructBinder),O),j=oe=>{throw i.error("an async sqlite3 initializer failed:",oe),oe};if(!m||!m.length)return f.isReady=q().catch(j);m=m.map(oe=>oe instanceof Function?async ge=>oe(O):oe),m.push(q);let Y=Promise.resolve(O);for(;m.length;)Y=Y.then(m.shift());return f.isReady=Y.catch(j)}).bind(s),scriptInfo:void 0};typeof o<"u"&&(O.__isUnderTest=!!o);try{s.initializers.forEach(f=>{f(O)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}if(delete s.initializers,s.sqlite3=O,typeof e<"u"&&(e.debugModule("sqlite3ApiBootstrap() complete",O),O.scriptInfo=e),O.__isUnderTest){typeof t<"u"&&(O.config.emscripten=t);const f=O.scriptInfo?.instantiateWasm;f&&(O.wasm.module=f.module,O.wasm.instance=f.instance,O.wasm.imports=f.imports)}return delete globalThis.sqlite3ApiConfig,delete globalThis.sqlite3ApiBootstrap,delete s.defaultConfig,O.asyncPostInit().then(f=>(typeof e<"u"&&e.debugModule("sqlite3.asyncPostInit() complete",f),delete f.asyncPostInit,delete f.scriptInfo,delete f.emscripten,f))},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.version={libVersion:"3.52.0",libVersionNumber:3052e3,sourceId:"2026-01-30 06:37:34 407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",downloadVersion:352e4,scm:{"sha3-256":"407724c4e80efdf93d885e95b5209a100a3f470fe0298138be57201f65f9817e",branch:"trunk",tags:"",datetime:"2026-01-30T06:37:34.096Z"}}}),globalThis.WhWasmUtilInstaller=function(n){n.bigIntEnabled===void 0&&(n.bigIntEnabled=!!globalThis.BigInt64Array);const i=(...l)=>{throw new Error(l.join(" "))};if(!n.pointerSize&&!n.pointerIR&&n.alloc&&n.dealloc){const l=n.alloc(1);n.pointerSize=typeof l=="bigint"?8:4,n.dealloc(l)}n.pointerSize&&!n.pointerIR&&(n.pointerIR=n.pointerSize===4?"i32":"i64");const r=n.pointerIR??="i32",c=n.pointerSize??=r==="i32"?4:r==="i64"?8:0;delete n.pointerSize,delete n.pointerIR,r!=="i32"&&r!=="i64"?i("Invalid pointerIR:",r):c!==8&&c!==4&&i("Invalid pointerSize:",c);const F=n.bigIntEnabled?l=>BigInt(l||0):l=>i("BigInt support is disabled in this build."),K=c===4?l=>Number(l||0):F,C=K(0),$=function(...l){let u=K(0);for(const d of l)u+=K(d);return u};{const l=Object.create(null);Object.defineProperty(n,"ptr",{enumerable:!0,get:()=>l,set:()=>i("The ptr property is read-only.")}),(function u(d,w){return Object.defineProperty(l,d,{enumerable:!0,get:()=>w,set:()=>i("ptr["+d+"] is read-only.")}),u})("null",C)("size",c)("ir",r)("coerce",K)("add",$)("addn",r===4?$:(...u)=>Number($(...u)))}n.exports||Object.defineProperty(n,"exports",{enumerable:!0,configurable:!0,get:()=>n.instance?.exports});const p=Object.create(null);p.heapSize=0,p.memory=null,p.freeFuncIndexes=[],p.scopedAlloc=[],p.scopedAlloc.pushPtr=l=>(p.scopedAlloc[p.scopedAlloc.length-1].push(l),l),p.utf8Decoder=new TextDecoder,p.utf8Encoder=new TextEncoder("utf-8"),n.sizeofIR=l=>{switch(l){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return c;default:return(""+l).endsWith("*")?c:void 0}};const z=function(){if(!p.memory)p.memory=n.memory instanceof WebAssembly.Memory?n.memory:n.exports.memory;else if(p.heapSize===p.memory.buffer.byteLength)return p;const l=p.memory.buffer;return p.HEAP8=new Int8Array(l),p.HEAP8U=new Uint8Array(l),p.HEAP16=new Int16Array(l),p.HEAP16U=new Uint16Array(l),p.HEAP32=new Int32Array(l),p.HEAP32U=new Uint32Array(l),p.HEAP32F=new Float32Array(l),p.HEAP64F=new Float64Array(l),n.bigIntEnabled&&(typeof BigInt64Array<"u"?(p.HEAP64=new BigInt64Array(l),p.HEAP64U=new BigUint64Array(l)):i("BigInt support is enabled, but the BigInt64Array type is missing.")),p.heapSize=l.byteLength,p};n.heap8=()=>z().HEAP8,n.heap8u=()=>z().HEAP8U,n.heap16=()=>z().HEAP16,n.heap16u=()=>z().HEAP16U,n.heap32=()=>z().HEAP32,n.heap32u=()=>z().HEAP32U,n.heapForSize=function(l,u=!0){const d=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();switch(l){case Int8Array:return d.HEAP8;case Uint8Array:return d.HEAP8U;case Int16Array:return d.HEAP16;case Uint16Array:return d.HEAP16U;case Int32Array:return d.HEAP32;case Uint32Array:return d.HEAP32U;case 8:return u?d.HEAP8U:d.HEAP8;case 16:return u?d.HEAP16U:d.HEAP16;case 32:return u?d.HEAP32U:d.HEAP32;case 64:if(d.HEAP64)return u?d.HEAP64U:d.HEAP64;break;default:if(n.bigIntEnabled){if(l===globalThis.BigUint64Array)return d.HEAP64U;if(l===globalThis.BigInt64Array)return d.HEAP64;break}}i("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")};const N=n.functionTable;delete n.functionTable,n.functionTable=N?()=>N:()=>n.exports.__indirect_function_table,n.functionEntry=function(l){const u=n.functionTable();return l<u.length?u.get(K(l)):void 0},n.jsFuncToWasm=function l(u,d){if(l._||(l._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:r,P:r,s:r,j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:(R,h,P)=>{P<128?R[h](P):R[h](P%128|128,P>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:R=>{const h=l._.rxJSig.exec(R);return h?h[2]:R.substr(1)},letterType:R=>l._.sigTypes[R]||i("Invalid signature letter:",R),pushSigType:(R,h)=>R.push(l._.typeCodes[l._.letterType(h)])}),typeof u=="string"){const R=d;d=u,u=R}const w=l._,U=w.sigParams(d),J=[1,96];w.uleb128Encode(J,"push",U.length);for(const R of U)w.pushSigType(J,R);return d[0]==="v"?J.push(0):(J.push(1),w.pushSigType(J,d[0])),w.uleb128Encode(J,"unshift",J.length),J.unshift(0,97,115,109,1,0,0,0,1),J.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(J)),{e:{f:u}}).exports.f};const te=function(u,d,w){if(w&&!p.scopedAlloc.length&&i("No scopedAllocPush() scope is active."),typeof u=="string"){const h=d;d=u,u=h}(typeof d!="string"||!(u instanceof Function))&&i("Invalid arguments: expecting (function,signature) or (signature,function).");const U=n.functionTable(),J=K(U.length);let R;for(;(R=p.freeFuncIndexes.pop())&&U.get(R);){R=null;continue}R||(R=K(J),U.grow(K(1)));try{return U.set(R,u),w&&p.scopedAlloc.pushPtr(R),R}catch(h){if(!(h instanceof TypeError))throw R===J&&p.freeFuncIndexes.push(J),h}try{const h=n.jsFuncToWasm(u,d);U.set(R,h),w&&p.scopedAlloc.pushPtr(R)}catch(h){throw R===J&&p.freeFuncIndexes.push(J),h}return R};n.installFunction=(l,u)=>te(l,u,!1),n.scopedInstallFunction=(l,u)=>te(l,u,!0),n.uninstallFunction=function(l){if(!l&&C!==l)return;const u=n.functionTable();p.freeFuncIndexes.push(l);const d=u.get(l);return u.set(l,null),d},n.peek=function(u,d="i8"){d.endsWith("*")&&(d=r);const w=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z(),U=Array.isArray(u)?[]:void 0;let J;do{switch(U&&(u=arguments[0].shift()),d){case"i1":case"i8":J=w.HEAP8[Number(u)>>0];break;case"i16":J=w.HEAP16[Number(u)>>1];break;case"i32":J=w.HEAP32[Number(u)>>2];break;case"float":case"f32":J=w.HEAP32F[Number(u)>>2];break;case"double":case"f64":J=Number(w.HEAP64F[Number(u)>>3]);break;case"i64":if(w.HEAP64){J=F(w.HEAP64[Number(u)>>3]);break}default:i("Invalid type for peek():",d)}U&&U.push(J)}while(U&&arguments[0].length);return U||J},n.poke=function(l,u,d="i8"){d.endsWith("*")&&(d=r);const w=p.memory&&p.heapSize===p.memory.buffer.byteLength?p:z();for(const U of Array.isArray(l)?l:[l])switch(d){case"i1":case"i8":w.HEAP8[Number(U)>>0]=u;continue;case"i16":w.HEAP16[Number(U)>>1]=u;continue;case"i32":w.HEAP32[Number(U)>>2]=u;continue;case"float":case"f32":w.HEAP32F[Number(U)>>2]=u;continue;case"double":case"f64":w.HEAP64F[Number(U)>>3]=u;continue;case"i64":if(w.HEAP64){w.HEAP64[Number(U)>>3]=F(u);continue}default:i("Invalid type for poke(): "+d)}return this},n.peekPtr=(...l)=>n.peek(l.length===1?l[0]:l,r),n.pokePtr=(l,u=0)=>n.poke(l,u,r),n.peek8=(...l)=>n.peek(l.length===1?l[0]:l,"i8"),n.poke8=(l,u)=>n.poke(l,u,"i8"),n.peek16=(...l)=>n.peek(l.length===1?l[0]:l,"i16"),n.poke16=(l,u)=>n.poke(l,u,"i16"),n.peek32=(...l)=>n.peek(l.length===1?l[0]:l,"i32"),n.poke32=(l,u)=>n.poke(l,u,"i32"),n.peek64=(...l)=>n.peek(l.length===1?l[0]:l,"i64"),n.poke64=(l,u)=>n.poke(l,u,"i64"),n.peek32f=(...l)=>n.peek(l.length===1?l[0]:l,"f32"),n.poke32f=(l,u)=>n.poke(l,u,"f32"),n.peek64f=(...l)=>n.peek(l.length===1?l[0]:l,"f64"),n.poke64f=(l,u)=>n.poke(l,u,"f64"),n.getMemValue=n.peek,n.getPtrValue=n.peekPtr,n.setMemValue=n.poke,n.setPtrValue=n.pokePtr,n.isPtr32=l=>typeof l=="number"&&l>=0&&l===(l|0),n.isPtr64=l=>typeof l=="bigint"?l>=0:n.isPtr32(l),n.isPtr=c===4?n.isPtr32:n.isPtr64,n.cstrlen=function(l){if(!l||!n.isPtr(l))return null;l=Number(l);const u=z().HEAP8U;let d=l;for(;u[d]!==0;++d);return d-l};const y=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,b=l=>l.buffer instanceof y;n.isSharedTypedArray=b;const D=(l,u,d)=>(c===8&&(typeof u=="bigint"&&(u=Number(u)),typeof d=="bigint"&&(d=Number(d))),b(l)?l.slice(u,d):l.subarray(u,d));n.typedArrayPart=D;const Q=(l,u,d)=>p.utf8Decoder.decode(D(l,u,d));n.typedArrayToString=Q,n.cstrToJs=function(l){const u=n.cstrlen(l);return u?Q(z().HEAP8U,Number(l),Number(l)+u):u===null?u:""},n.jstrlen=function(l){if(typeof l!="string")return null;const u=l.length;let d=0;for(let w=0;w<u;++w){let U=l.charCodeAt(w);U>=55296&&U<=57343&&(U=65536+((U&1023)<<10)|l.charCodeAt(++w)&1023),U<=127?++d:U<=2047?d+=2:U<=65535?d+=3:d+=4}return d},n.jstrcpy=function(l,u,d=0,w=-1,U=!0){if((!u||!(u instanceof Int8Array)&&!(u instanceof Uint8Array))&&i("jstrcpy() target must be an Int8Array or Uint8Array."),w=Number(w),d=Number(d),w<0&&(w=u.length-d),!(w>0)||!(d>=0))return 0;let J=0,R=l.length;const h=d,P=d+w-(U?1:0);for(;J<R&&d<P;++J){let W=l.charCodeAt(J);if(W>=55296&&W<=57343&&(W=65536+((W&1023)<<10)|l.charCodeAt(++J)&1023),W<=127){if(d>=P)break;u[d++]=W}else if(W<=2047){if(d+1>=P)break;u[d++]=192|W>>6,u[d++]=128|W&63}else if(W<=65535){if(d+2>=P)break;u[d++]=224|W>>12,u[d++]=128|W>>6&63,u[d++]=128|W&63}else{if(d+3>=P)break;u[d++]=240|W>>18,u[d++]=128|W>>12&63,u[d++]=128|W>>6&63,u[d++]=128|W&63}}return U&&(u[d++]=0),d-h},n.cstrncpy=function(l,u,d){if((!l||!u)&&i("cstrncpy() does not accept NULL strings."),d<0)d=n.cstrlen(strPtr)+1;else if(!(d>0))return 0;const w=n.heap8u();let U=0,J;const R=Number(l),h=Number(u);for(;U<d&&(J=w[h+U]);++U)w[R+U]=J;return U<d&&(w[R+U++]=0),U},n.jstrToUintArray=(l,u=!1)=>p.utf8Encoder.encode(u?l+"\0":l);const E=(l,u)=>{(!(l.alloc instanceof Function)||!(l.dealloc instanceof Function))&&i("Object is missing alloc() and/or dealloc() function(s)","required by",u+"().")},O=function(l,u,d,w){if(E(n,w),typeof l!="string")return null;const U=p.utf8Encoder.encode(l),J=d(U.length+1);let R=J;try{const h=z().HEAP8U;return h.set(U,Number(J)),h[$(J,U.length)]=0,R=C,u?[J,U.length]:J}finally{R&&n.dealloc(R)}};n.allocCString=(l,u=!1)=>O(l,u,n.alloc,"allocCString()"),n.scopedAllocPush=function(){E(n,"scopedAllocPush");const l=[];return p.scopedAlloc.push(l),l},n.scopedAllocPop=function(l){E(n,"scopedAllocPop");const u=arguments.length?p.scopedAlloc.indexOf(l):p.scopedAlloc.length-1;u<0&&i("Invalid state object for scopedAllocPop()."),arguments.length===0&&(l=p.scopedAlloc[u]),p.scopedAlloc.splice(u,1);for(let d;d=l.pop();)n.functionEntry(d)?n.uninstallFunction(d):n.dealloc(d)},n.scopedAlloc=function(l){p.scopedAlloc.length||i("No scopedAllocPush() scope is active.");const u=K(n.alloc(l));return p.scopedAlloc.pushPtr(u)},Object.defineProperty(n.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>p.scopedAlloc.length,set:()=>i("The 'active' property is read-only.")}),n.scopedAllocCString=(l,u=!1)=>O(l,u,n.scopedAlloc,"scopedAllocCString()");const f=function(l,u){const d=n[l?"scopedAlloc":"alloc"]((u.length+1)*n.ptr.size);let w=0;return u.forEach(U=>{n.pokePtr($(d,n.ptr.size*w++),n[l?"scopedAllocCString":"allocCString"](""+U))}),n.pokePtr($(d,n.ptr.size*w),0),d};n.scopedAllocMainArgv=l=>f(!0,l),n.allocMainArgv=l=>f(!1,l),n.cArgvToJs=(l,u)=>{const d=[];for(let w=0;w<l;++w){const U=n.peekPtr($(u,n.ptr.size*w));d.push(U?n.cstrToJs(U):null)}return d},n.scopedAllocCall=function(l){n.scopedAllocPush();try{return l()}finally{n.scopedAllocPop()}};const m=function(l,u,d){E(n,d);const w=u?"i64":r;let U=n[d](l*(u?8:c));if(n.poke(U,0,w),l===1)return U;const J=[U];for(let R=1;R<l;++R)U=$(U,u?8:c),J[R]=U,n.poke(U,0,w);return J};n.allocPtr=(l=1,u=!0)=>m(l,u,"alloc"),n.scopedAllocPtr=(l=1,u=!0)=>m(l,u,"scopedAlloc"),n.xGet=function(l){return n.exports[l]||i("Cannot find exported symbol:",l)};const q=(l,u)=>i(l+"() requires",u,"argument(s).");n.xCall=function(l,...u){const d=l instanceof Function?l:n.xGet(l);return d instanceof Function||i("Exported symbol",l,"is not a function."),d.length!==u.length&&q(d===l?d.name:l,d.length),arguments.length===2&&Array.isArray(arguments[1])?d.apply(null,arguments[1]):d.apply(null,u)},p.xWrap=Object.create(null),p.xWrap.convert=Object.create(null),p.xWrap.convert.arg=new Map,p.xWrap.convert.result=new Map;const j=p.xWrap.convert.arg,Y=p.xWrap.convert.result,oe=K;j.set("i64",F).set("i32",l=>l|0).set("i16",l=>(l|0)&65535).set("i8",l=>(l|0)&255).set("f32",l=>Number(l).valueOf()).set("float",j.get("f32")).set("f64",j.get("f32")).set("double",j.get("f64")).set("int",j.get("i32")).set("null",l=>l).set(null,j.get("null")).set("**",oe).set("*",oe),Y.set("*",oe).set("pointer",oe).set("number",l=>Number(l)).set("void",l=>{}).set(void 0,Y.get("void")).set("null",l=>l).set(null,Y.get("null"));for(const l of["i8","i16","i32","i64","int","f32","float","f64","double"])j.set(l+"*",oe),Y.set(l+"*",oe),Y.set(l,j.get(l)||i("Maintenance required: missing arg converter for",l));const ge=l=>typeof l=="string"?n.scopedAllocCString(l):K(l);j.set("string",ge).set("utf8",ge),Y.set("string",l=>n.cstrToJs(l)).set("utf8",Y.get("string")).set("string:dealloc",l=>{try{return l?n.cstrToJs(l):null}finally{n.dealloc(l)}}).set("utf8:dealloc",Y.get("string:dealloc")).set("json",l=>JSON.parse(n.cstrToJs(l))).set("json:dealloc",l=>{try{return l?JSON.parse(n.cstrToJs(l)):null}finally{n.dealloc(l)}});const ye=class{constructor(l){this.name=l.name||"unnamed adapter"}convertArg(l,u,d){i("AbstractArgAdapter must be subclassed.")}};j.FuncPtrAdapter=class et extends ye{constructor(u){super(u),j.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",u),this.name=u.name||"unnamed",this.signature=u.signature,u.contextKey instanceof Function&&(this.contextKey=u.contextKey,u.bindScope||(u.bindScope="context")),this.bindScope=u.bindScope||i("FuncPtrAdapter options requires a bindScope (explicit or implied)."),et.bindScopes.indexOf(u.bindScope)<0&&i("Invalid options.bindScope ("+u.bindMod+") for FuncPtrAdapter. Expecting one of: ("+et.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=u.callProxy instanceof Function?u.callProxy:void 0}contextKey(u,d){return this}contextMap(u){const d=this.__cmap||(this.__cmap=new Map);let w=d.get(u);return w===void 0&&d.set(u,w=[]),w}convertArg(u,d,w){let U=this.singleton;if(!U&&this.isContext&&(U=this.contextMap(this.contextKey(d,w))),U&&U.length===2&&U[0]===u)return U[1];if(u instanceof Function){this.callProxy&&(u=this.callProxy(u));const J=te(u,this.signature,this.isTransient);if(et.debugFuncInstall&&et.debugOut("FuncPtrAdapter installed",this,this.contextKey(d,w),"@"+J,u),U){if(U[1]){et.debugFuncInstall&&et.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,w),"@"+U[1],u);try{p.scopedAlloc.pushPtr(U[1])}catch{}}U[0]=arguments[0]||C,U[1]=J}return J}else if(n.isPtr(u)||u===null||u===void 0){if(U&&U[1]&&U[1]!==u){et.debugFuncInstall&&et.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(d,w),"@"+U[1],u);try{p.scopedAlloc.pushPtr(U[1])}catch{}U[0]=U[1]=u||C}return u||C}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},j.FuncPtrAdapter.warnOnUse=!1,j.FuncPtrAdapter.debugFuncInstall=!1,j.FuncPtrAdapter.debugOut=console.debug.bind(console),j.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const fe=l=>j.get(l)||i("Argument adapter not found:",l),H=l=>Y.get(l)||i("Result adapter not found:",l);p.xWrap.convertArg=(l,...u)=>fe(l)(...u),p.xWrap.convertArgNoCheck=(l,...u)=>j.get(l)(...u),p.xWrap.convertResult=(l,u)=>l===null?u:l?H(l)(u):void 0,p.xWrap.convertResultNoCheck=(l,u)=>l===null?u:l?Y.get(l)(u):void 0,n.xWrap=function l(u,d,...w){arguments.length===3&&Array.isArray(arguments[2])&&(w=arguments[2]),n.isPtr(u)&&(u=n.functionEntry(u)||i("Function pointer not found in WASM function table."));const U=u instanceof Function,J=U?u:n.xGet(u);if(U&&(u=J.name||"unnamed function"),w.length!==J.length&&q(u,J.length),J.length===0&&(d===null||d==="null"))return J;H(d);for(const h of w)h instanceof ye?j.set(h,(...P)=>h.convertArg(...P)):fe(h);const R=p.xWrap;return J.length===0?(...h)=>h.length?q(u,J.length):R.convertResult(d,J.call(null)):function(...h){h.length!==J.length&&q(u,J.length);const P=n.scopedAllocPush();try{let W=0;for(l.debug&&console.debug("xWrap() preparing: resultType ",d,"xf",J,"argTypes",w,"args",h);W<h.length;++W)h[W]=R.convertArgNoCheck(w[W],h[W],h,W);return l.debug&&console.debug("xWrap() calling: resultType ",d,"xf",J,"argTypes",w,"args",h),R.convertResultNoCheck(d,J.apply(null,h))}finally{n.scopedAllocPop(P)}}};const A=function(l,u,d,w,U,J){if(typeof d=="string"){if(u===1)return J.get(d);if(u===2){if(w)w instanceof Function||i(U,"requires a function argument.");else return J.delete(d),l;return J.set(d,w),l}}i("Invalid arguments to",U)};return n.xWrap.resultAdapter=function l(u,d){return A(l,arguments.length,u,d,"resultAdapter()",Y)},n.xWrap.argAdapter=function l(u,d){return A(l,arguments.length,u,d,"argAdapter()",j)},n.xWrap.FuncPtrAdapter=j.FuncPtrAdapter,n.xCallWrapped=function(l,u,d,...w){return Array.isArray(arguments[3])&&(w=arguments[3]),n.xWrap(l,u,d||[]).apply(null,w||[])},n.xWrap.testConvertArg=p.xWrap.convertArg,n.xWrap.testConvertResult=p.xWrap.convertResult,n},globalThis.WhWasmUtilInstaller.yawl=(function(n){const i=()=>fetch(n.uri,{credentials:"same-origin"}),r=this,c=function(F){if(n.wasmUtilTarget){const T=(...C)=>{throw new Error(C.join(" "))},K=n.wasmUtilTarget;if(K.module=F.module,K.instance=F.instance,K.instance.exports.memory||(K.memory=n?.imports?.env?.memory||T("Missing 'memory' object!")),!K.alloc&&F.instance.exports.malloc){const C=F.instance.exports;K.alloc=function($){return C.malloc($)||T("Allocation of",$,"bytes failed.")},K.dealloc=function($){$&&C.free($)}}r(K)}return F.config=n,n.onload&&n.onload(F),F};return WebAssembly.instantiateStreaming?()=>WebAssembly.instantiateStreaming(i(),n.imports||{}).then(c):()=>i().then(F=>F.arrayBuffer()).then(F=>WebAssembly.instantiate(F,n.imports||{})).then(c)}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function s(n){const i=(...I)=>{throw new Error(I.join(" "))};{let I=n.heap;I instanceof WebAssembly.Memory?I=(function(){return new Uint8Array(this.buffer)}).bind(I):I instanceof Function||i("config.heap must be WebAssembly.Memory instance or","a function which returns one."),n.heap=I}["alloc","dealloc"].forEach(function(I){n[I]instanceof Function||i("Config option '"+I+"' must be a function.")});const r=s,c=n.heap,F=n.alloc,T=n.dealloc;n.realloc;const K=n.log||console.debug.bind(console),C=n.memberPrefix||"",$=n.memberSuffix||"",p=globalThis.BigInt,z=globalThis.BigInt64Array,N=n.bigIntEnabled??!!z;let te;const y=n.pointerSize||n.ptrSize||(typeof(te=F(1))=="bigint"?8:4),b=n.pointerIR||n.ptrIR||(y===4?"i32":"i64");te&&(T(te),te=void 0),y!==4&&y!==8&&i("Invalid pointer size:",y),b!=="i32"&&b!=="i64"&&i("Invalid pointer representation:",b);const D=N&&p?I=>p(I||0):I=>i("BigInt support is disabled in this build."),Q=b=="i32"?Number:D,E=Q(0),O=function(...I){let G=E;for(let X=0;X<I.length;++X)G+=Q(I[X]);return G},f=function(...I){return O(this.pointer,...I)};r.debugFlags||(r.__makeDebugFlags=function(I=null){I&&I.__flags&&(I=I.__flags);const G=function X(ie){return arguments.length===0?X.__flags:(ie<0?(delete X.__flags.getter,delete X.__flags.setter,delete X.__flags.alloc,delete X.__flags.dealloc):(X.__flags.getter=(1&ie)!==0,X.__flags.setter=(2&ie)!==0,X.__flags.alloc=(4&ie)!==0,X.__flags.dealloc=(8&ie)!==0),X._flags)};return Object.defineProperty(G,"__flags",{iterable:!1,writable:!1,value:Object.create(I)}),I||G(0),G},r.debugFlags=r.__makeDebugFlags());const m=!0,q=I=>I[1]==="(",j=I=>I==="p"||I==="P"||I==="s",Y=I=>I==="P",oe=I=>I?q(I)?"p":I[0]:void 0,ge=function(I){switch(oe(I)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return b;case"j":return"i64";case"f":return"float";case"d":return"double"}i("Unhandled signature IR:",I)},ye=function(I){switch(oe(I)){case"c":case"C":return 1;case"i":return 4;case"p":case"P":case"s":return y;case"j":return 8;case"f":return 4;case"d":return 8}i("Unhandled signature sizeof:",I)},fe=z?()=>!0:()=>i("BigInt64Array is not available."),H=function(I){switch(oe(I)){case"p":case"P":case"s":switch(y){case 4:return"getInt32";case 8:return fe()&&"getBigInt64"}break;case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return fe()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}i("Unhandled DataView getter for signature:",I)},A=function(I){switch(oe(I)){case"p":case"P":case"s":switch(y){case 4:return"setInt32";case 8:return fe()&&"setBigInt64"}break;case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return fe()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}i("Unhandled DataView setter for signature:",I)},l=function(I){switch(oe(I)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return D;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return D}break}i("Unhandled DataView set wrapper for signature:",I)},u=(I,G)=>I+"::"+G,d=function(I,G){return()=>i(u(I,G),"is read-only.")},w=function I(G,X=!0){let ie=I.map.get(G);return!ie&&X&&I.map.set(G,ie=I.create(G)),ie};w.map=new WeakMap,w.create=I=>Object.assign(Object.create(null),{o:I,p:void 0,ownsPointer:!1,zod:!1,xb:0});const U=I=>w.map.delete(I),J=I=>typeof I=="number"&&I===(I|0)&&I>=0,h=y===4?J:I=>typeof I=="bigint"&&I>=0||J(I),P=I=>h(I)&&I>0,W=function(I,G,X){const ie=w(G,!1);if(ie){if(U(G),!X&&!(X=ie.p)){console.warn("Cannot(?) happen: __freeStruct() found no instanceInfo");return}if(Array.isArray(G.ondispose)){let de;for(;de=G.ondispose.pop();)try{de instanceof Function?de.call(G):de instanceof Je?de.dispose():h(de)&&T(de)}catch(Te){console.warn("ondispose() for",I.structName,"@",X,"threw. NOT propagating it.",Te)}}else if(G.ondispose instanceof Function)try{G.ondispose()}catch(de){console.warn("ondispose() for",I.structName,"@",X,"threw. NOT propagating it.",de)}delete G.ondispose,I.debugFlags.__flags.dealloc&&K("debug.dealloc:",ie.ownsPointer?"":"EXTERNAL",I.structName,"instance:",I.structInfo.sizeof,"bytes @"+X),ie.ownsPointer&&((ie.zod||I.structInfo.zeroOnDispose)&&c().fill(0,Number(X),Number(X)+I.structInfo.sizeof+ie.xb),T(X))}},ne=()=>({configurable:!1,writable:!1,iterable:!1}),g=I=>({...ne(),value:I}),L=function(G,X,ie){let de;const Te=Ie=>{P(Ie)||i("Invalid pointer value",arguments[0],"for",G.structName,"constructor.")};arguments.length>=3?ie&&typeof ie=="object"?(de=ie,ie=de?.wrap):(Te(ie),de={wrap:ie}):de={};const Re=!ie;let Be=0,We=!1;if(ie)Te(ie),We=!!de?.takeOwnership;else{const Ie=de?.extraBytes??0;(Ie<0||Ie!==(Ie|0))&&i("Invalid extraBytes value:",de?.extraBytes),Be=G.structInfo.sizeof+Ie,ie=F(Be)||i("Allocation of",G.structName,"structure failed."),We=!0}try{de?.debugFlags&&X.debugFlags(de.debugFlags),G.debugFlags.__flags.alloc&&K("debug.alloc:",Re?"":"EXTERNAL",G.structName,"instance:",G.structInfo.sizeof,"bytes @"+ie),Re&&c().fill(0,Number(ie),Number(ie)+Be);const Ie=w(X);Ie.p=ie,Ie.ownsPointer=We,Ie.xb=Be?Be-G.structInfo.sizeof:0,Ie.zod=!!de?.zeroOnDispose,de?.ondispose&&de.ondispose!==ie&&X.addOnDispose(de.ondispose)}catch(Ie){throw W(G,X,ie),Ie}},V=function I(G){return I.rxSig1??=/^[ipPsjfdcC]$/,I.rxSig2??=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/,I.rxSig1.test(G)||I.rxSig2.test(G)},re=(function(I){let G=this.get(I);return G||(G=[Object.create(null),Object.create(null),Object.create(null)],this.set(I,G)),G}).bind(new WeakMap),Z=function(I,G,X,ie){const de=re(I)[G];return arguments.length===3?de[X]:ie?de[X]=ie:delete de[X]},ce=function(I,...G){return Z(this,0,I,...G)},qe=function(I,G){V(G)&&i(I,"(",G,") collides with a data type signature.")},ue=function(I,...G){return qe("Setter adaptor",I),Z(this,1,I,...G)},S=function(I,...G){return qe("Struct adaptor",I),Z(this,2,I,...G)},x=function(I,G){const X=typeof G=="string"?Z(I,2,G):G;return typeof X!="object"&&i("Invalid struct mapping object. Arg =",G,JSON.stringify(X)),X},B=g(I=>C+I+$),ee=function(I,G,X=!0){let ie=I.members[G];if(!ie&&(C||$)){for(const de of Object.values(I.members))if(de.key===G){ie=de;break}!ie&&X&&i(u(I.name||I.structName,G),"is not a mapped struct member.")}return ie},le=function I(G,X,ie=!1){I._||(I._=Te=>Te.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const de=ee(G.structInfo,X,!0);return ie?I._(de.signature):de.signature},_e=g(function(){const I=[];for(const G of Object.keys(this.structInfo.members))I.push(this.memberKey(G));return I}),ae=new TextDecoder("utf-8"),he=new TextEncoder,Ae=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,xe=function(I,G,X){return y===8&&(G=Number(G),X=Number(X)),ae.decode(I.buffer instanceof Ae?I.slice(G,X):I.subarray(G,X))},ve=function(I,G,X=!1){const ie=ee(I.structInfo,G,X);return ie&&ie.signature.length===1&&ie.signature[0]==="s"?ie:!1},Me=function(I){I.signature!=="s"&&i("Invalid member type signature for C-string value:",JSON.stringify(I))},Xe=function(G,X){const ie=ee(G.structInfo,X,!0);Me(ie);const de=G[ie.key];if(!de)return null;let Te=de;const Re=c();for(;Re[Te]!==0;++Te);return de===Te?"":xe(Re,de,Te)},at=function(I,...G){I.ondispose?Array.isArray(I.ondispose)||(I.ondispose=[I.ondispose]):I.ondispose=[],I.ondispose.push(...G)},Ge=function(I){const G=he.encode(I),X=F(G.length+1);X||i("Allocation error while duplicating string:",I);const ie=c();return ie.set(G,Number(X)),ie[O(X,G.length)]=0,X},bt=function(I,G,X){const ie=ee(I.structInfo,G,!0);Me(ie);const de=Ge(X);return I[ie.key]=de,at(I,de),I},Je=function(G,X){arguments[2]!==g&&i("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:g(G),structInfo:g(X)})};Je.prototype=Object.create(null,{dispose:g(function(){W(this.constructor,this)}),lookupMember:g(function(I,G=!0){return ee(this.structInfo,I,G)}),memberToJsString:g(function(I){return Xe(this,I)}),memberIsString:g(function(I,G=!0){return ve(this,I,G)}),memberKey:B,memberKeys:_e,memberSignature:g(function(I,G=!1){return le(this,I,G)}),memoryDump:g(function(){const I=this.pointer;return I?new Uint8Array(c().slice(Number(I),Number(I)+this.structInfo.sizeof)):null}),extraBytes:{configurable:!1,enumerable:!1,get:function(){return w(this,!1)?.xb??0}},zeroOnDispose:{configurable:!1,enumerable:!1,get:function(){return w(this,!1)?.zod??!!this.structInfo.zeroOnDispose}},pointer:{configurable:!1,enumerable:!1,get:function(){return w(this,!1)?.p},set:()=>i("Cannot assign the 'pointer' property of a struct.")},setMemberCString:g(function(I,G){return bt(this,I,G)})}),Object.assign(Je.prototype,{addOnDispose:function(...I){return at(this,...I),this}}),Object.defineProperties(Je,{allocCString:g(Ge),isA:g(I=>I instanceof Je),hasExternalPointer:g(I=>{const G=w(I,!1);return!!(G?.p&&!G?.ownsPointer)}),memberKey:B});const tt=function(I){return I.get||(I.adaptGet?Ve.adaptGet(I.adaptGet):void 0)},St=function(I){return I.set||(I.adaptSet?Ve.adaptSet(I.adaptSet):void 0)},mr=function I(G,X,ie){const de=I.innerStructs??=new Map,Te=G.memberKey(X);ie.signature!==void 0&&i("'signature' cannot be used on an embedded struct (",G.structName,".",Te,")."),St(ie)&&i("'set' and 'adaptSet' are not permitted for nested struct members."),ie.structName??=G.structName+"::"+X,ie.key=Te,ie.name=X,ie.constructor=this.call(this,ie.structName,ie);const Re=tt(ie),Be=Object.assign(Object.create(null),{configurable:!1,enumerable:!1,set:d(G.structName,Te),get:function(){const We=this.debugFlags.__flags,Ie=this.pointer,je=Ie+"."+Te;let pe=de.get(je);return We.getter&&K("debug.getter: k =",je),pe||(pe=new ie.constructor(O(Ie,ie.offset)),de.set(je,pe),this.addOnDispose(()=>pe.dispose()),pe.addOnDispose(()=>de.delete(je))),Re&&(pe=Re.apply(this,[pe,Te])),We.getter&&K("debug.getter: result =",pe),pe}});Object.defineProperty(G.prototype,Te,Be)},gr=function I(G,X,ie){if(ie=x(this,ie),ie.members)return mr.call(this,G,X,ie);if(!I.cache){I.cache={getters:{},setters:{},sw:{}};const je=["i","c","C","p","P","s","f","d","v()"];N&&je.push("j"),je.forEach(function(pe){I.cache.getters[pe]=H(pe),I.cache.setters[pe]=A(pe),I.cache.sw[pe]=l(pe)}),I.sigCheck=function(pe,Ne,Et,Zt){Object.prototype.hasOwnProperty.call(pe,Et)&&i(pe.structName,"already has a property named",Et+"."),V(Zt)||i("Malformed signature for",u(pe.structName,Ne)+":",Zt)}}const de=G.memberKey(X);I.sigCheck(G.prototype,X,de,ie.signature),ie.key=de,ie.name=X;const Te=oe(ie.signature),Re=u(G.structName,de),Be=G.debugFlags.__flags,We=tt(ie),Ie=Object.create(null);if(Ie.configurable=!1,Ie.enumerable=!1,Ie.get=function(){Be.getter&&K("debug.getter:",I.cache.getters[Te],"for",ge(Te),Re,"@",this.pointer,"+",ie.offset,"sz",ie.sizeof);let je=new DataView(c().buffer,Number(this.pointer)+ie.offset,ie.sizeof)[I.cache.getters[Te]](0,m);return We&&(je=We.apply(this,[de,je])),Be.getter&&K("debug.getter:",Re,"result =",je),je},ie.readOnly)Ie.set=d(G.prototype.structName,de);else{const je=St(ie);Ie.set=function(pe){Be.setter&&K("debug.setter:",I.cache.setters[Te],"for",ge(Te),Re,"@",this.pointer,"+",ie.offset,"sz",ie.sizeof,pe),this.pointer||i("Cannot set native property on a disposed",this.structName,"instance."),je&&(pe=je.apply(this,[de,pe])),pe==null?pe=E:j(ie.signature)&&!h(pe)&&(Y(ie.signature)&&pe instanceof Je?(pe=pe.pointer||E,Be.setter&&K("debug.setter:",Re,"resolved to",pe)):i("Invalid value for pointer-type",Re+".")),new DataView(c().buffer,Number(this.pointer)+ie.offset,ie.sizeof)[I.cache.setters[Te]](0,I.cache.sw[Te](pe),m)}}Object.defineProperty(G.prototype,de,Ie)},Yt=function I(G,X,ie=Object.create(null)){const de=function pe(Ne){this instanceof pe||i("The",G,"constructor may only be called via 'new'."),L(pe,this,...arguments)},Te=this,Re=pe=>typeof pe=="string"&&V(pe)?{signature:pe}:x(Te,pe);arguments.length===1?(X=Re(G),G=X.structName||X.name):arguments.length===2?(X=Re(X),X.name??=G):X=Re(X),G??=X.structName,G??=ie.structName,G||i("One of 'name' or 'structName' are required."),X.adapt&&(Object.keys(X.adapt.struct||{}).forEach(pe=>{S.call(I,pe,X.adapt.struct[pe])}),Object.keys(X.adapt.set||{}).forEach(pe=>{ue.call(I,pe,X.adapt.set[pe])}),Object.keys(X.adapt.get||{}).forEach(pe=>{ce.call(I,pe,X.adapt.get[pe])})),!X.members&&!X.sizeof&&(X.sizeof=ye(X.signature));const Be=g(r.__makeDebugFlags(Ve.debugFlags));Object.defineProperties(de,{debugFlags:Be,isA:g(pe=>pe instanceof de),memberKey:B,memberKeys:_e,structInfo:g(X),structName:g(G),ptrAdd:g(O)}),de.prototype=new Je(G,X,g),Object.defineProperties(de.prototype,{debugFlags:Be,constructor:g(de),ptrAdd:g(f)});let We=!1,Ie=0;const je=!!X.autoCalcSizeOffset;return je||X.sizeof||i(G,"description is missing its sizeof property."),X.offset??=0,Object.keys(X.members||{}).forEach(pe=>{let Ne=Re(X.members[pe]);!Ne.members&&!Ne.sizeof&&(Ne.sizeof=ye(Ne.signature),Ne.sizeof||i(u(G,pe),"is missing a sizeof property.",Ne)),Ne.offset===void 0&&(je?Ne.offset=Ie:i(u(G,pe),"is missing its offset.",JSON.stringify(Ne))),X.members[pe]=Ne,(!We||We.offset<Ne.offset)&&(We=Ne);const Et=!!Ne.autoCalc;je&&(Ne.autoCalcSizeOffset=!0),gr.call(Te,de,pe,Ne),Et?Ne.autoCalcSizeOffset=!0:delete Ne.autoCalcSizeOffset,Ie+=Ne.sizeof}),We||i("No member property descriptions found."),X.sizeof||(X.sizeof=Ie),X.sizeof===1?X.signature==="c"||X.signature==="C"||i("Unexpected sizeof==1 member",u(G,k),"with signature",X.signature):(X.sizeof%4!==0&&(console.warn("Invalid struct member description",X),i(G,"sizeof is not aligned. sizeof="+X.sizeof)),X.offset%4!==0&&(console.warn("Invalid struct member description",X),i(G,"offset is not aligned. offset="+X.offset))),X.sizeof<Ie&&(console.warn("Suspect struct description:",X,"offset =",Ie),i("Mismatch in the calculated vs. the provided sizeof/offset info.","Expected sizeof",Ie,"but got",X.sizeof,"for",X)),delete X.autoCalcSizeOffset,de},Ve=function I(G,X){return arguments.length==1?Yt.call(I,G):Yt.call(I,G,X)};return Ve.StructType=Je,Ve.config=n,Ve.allocCString=Ge,Ve.adaptGet=ce,Ve.adaptSet=ue,Ve.adaptStruct=S,Ve.ptrAdd=O,Ve.debugFlags||(Ve.debugFlags=r.__makeDebugFlags(r.debugFlags)),Ve},globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...y)=>{throw new Error(y.join(" "))},i=s.capi,r=s.wasm,c=s.util;globalThis.WhWasmUtilInstaller(r),delete globalThis.WhWasmUtilInstaller;const F={core:[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new r.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:y=>{let b;return(D,Q,E,O)=>{try{const f=r.cArgvToJs(Q,E);return b||(b=r.cArgvToJs(Q,O)),y(f,b)|0}catch(f){return f.resultCode||i.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_next_stmt","sqlite3_stmt*",["sqlite3*","sqlite3_stmt*"]],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:y=>y[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_set_errmsg","int","sqlite3*","int","string"],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(y,b)=>y[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],int64:[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_db_status64","int","sqlite3*","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook::callback",signature:"v(pippj)",contextKey:y=>y[0],callProxy:y=>(b,D,Q,E,O)=>{y(b,D,r.cstrToJs(Q),r.cstrToJs(E),O)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],wasmInternal:[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]]};if(r.exports.sqlite3_progress_handler&&F.core.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new r.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(y,b)=>y[0]}),"*"]]),r.exports.sqlite3_stmt_explain&&F.core.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),r.exports.sqlite3_set_authorizer&&F.core.push(["sqlite3_set_authorizer","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(y,b)=>y[0],callProxy:y=>(b,D,Q,E,O,f)=>{try{return Q=Q&&r.cstrToJs(Q),E=E&&r.cstrToJs(E),O=O&&r.cstrToJs(O),f=f&&r.cstrToJs(f),y(b,D,Q,E,O,f)|0}catch(m){return m.resultCode||i.SQLITE_ERROR}}}),"*"]]),r.exports.sqlite3_column_origin_name&&F.core.push(["sqlite3_column_database_name","string","sqlite3_stmt*","int"],["sqlite3_column_origin_name","string","sqlite3_stmt*","int"],["sqlite3_column_table_name","string","sqlite3_stmt*","int"]),r.bigIntEnabled&&r.exports.sqlite3_declare_vtab&&F.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),r.bigIntEnabled&&r.exports.sqlite3_preupdate_hook&&F.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:y=>y[0],callProxy:y=>(b,D,Q,E,O,f,m)=>{y(b,D,Q,r.cstrToJs(E),r.cstrToJs(O),f,m)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),r.bigIntEnabled&&r.exports.sqlite3changegroup_add&&r.exports.sqlite3session_create&&r.exports.sqlite3_preupdate_hook){const y={signature:"i(ps)",callProxy:b=>(D,Q)=>{try{return b(D,r.cstrToJs(Q))|0}catch(E){return E.resultCode||i.SQLITE_ERROR}}};F.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...y}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3","int",["sqlite3*","int","void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v3_strm","int",["sqlite3*",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xFilter",signature:"i(pp)",bindScope:"transient"}),new r.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new r.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new r.xWrap.FuncPtrAdapter({name:"xFilter",...y,contextKey:(b,D)=>b[0]}),"*"]])}s.StructBinder=globalThis.Jaccwabyt({heap:r.heap8u,alloc:r.alloc,dealloc:r.dealloc,bigIntEnabled:r.bigIntEnabled,pointerIR:r.ptr.ir,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const y=r.xWrap.argAdapter("string");r.xWrap.argAdapter("string:flexible",E=>y(c.flexibleString(E))),r.xWrap.argAdapter("string:static",(function(E){return r.isPtr(E)?E:(E=""+E,this[E]||(this[E]=r.allocCString(E)))}).bind(Object.create(null)));const b=r.xWrap.argAdapter("*"),D=function(){};r.xWrap.argAdapter("sqlite3_filename",b)("sqlite3_context*",b)("sqlite3_value*",b)("void*",b)("sqlite3_changegroup*",b)("sqlite3_changeset_iter*",b)("sqlite3_session*",b)("sqlite3_stmt*",E=>b(E instanceof(s?.oo1?.Stmt||D)?E.pointer:E))("sqlite3*",E=>b(E instanceof(s?.oo1?.DB||D)?E.pointer:E))("sqlite3_vfs*",E=>typeof E=="string"?i.sqlite3_vfs_find(E)||s.SQLite3Error.toss(i.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",E):b(E instanceof(i.sqlite3_vfs||D)?E.pointer:E)),r.exports.sqlite3_declare_vtab&&r.xWrap.argAdapter("sqlite3_index_info*",E=>b(E instanceof(i.sqlite3_index_info||D)?E.pointer:E))("sqlite3_module*",E=>b(E instanceof(i.sqlite3_module||D)?E.pointer:E));const Q=r.xWrap.resultAdapter("*");r.xWrap.resultAdapter("sqlite3*",Q)("sqlite3_context*",Q)("sqlite3_stmt*",Q)("sqlite3_value*",Q)("sqlite3_vfs*",Q)("void*",Q);for(const E of F.core)i[E[0]]=r.xWrap.apply(null,E);for(const E of F.wasmInternal)c[E[0]]=r.xWrap.apply(null,E);for(const E of F.int64)i[E[0]]=r.bigIntEnabled?r.xWrap.apply(null,E):()=>n(E[0]+"() is unavailable due to lack","of BigInt support in this build.");delete F.core,delete F.int64,delete F.wasmInternal,c.sqlite3__wasm_db_error=function(E,O,f){return E?(O instanceof s.WasmAllocError?(O=i.SQLITE_NOMEM,f=0):O instanceof Error&&(f=f||""+O,O=O.resultCode||i.SQLITE_ERROR),i.sqlite3_set_errmsg(E,O,f)||O):i.SQLITE_MISUSE}}{const y=r.xCall("sqlite3__wasm_enum_json");y||n("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),r.ctype=JSON.parse(r.cstrToJs(y));const b=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];r.bigIntEnabled&&b.push("serialize","session","vtab");for(const E of b)for(const O of Object.entries(r.ctype[E]))i[O[0]]=O[1];r.functionEntry(i.SQLITE_WASM_DEALLOC)||n("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+i.SQLITE_WASM_DEALLOC+").");const D=Object.create(null);for(const E of Object.entries(r.ctype.resultCodes))D[E[1]]=E[0];i.sqlite3_js_rc_str=E=>D[E];const Q=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_index_info:!r.bigIntEnabled,sqlite3_index_constraint:!r.bigIntEnabled,sqlite3_index_orderby:!r.bigIntEnabled,sqlite3_index_constraint_usage:!r.bigIntEnabled});for(const E of r.ctype.structs)Q[E.name]||(i[E.name]=s.StructBinder(E));if(i.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])i.sqlite3_index_info[E]=i[E],delete i[E];i.sqlite3_vtab_config=r.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const T=(y,b,D)=>c.sqlite3__wasm_db_error(y,i.SQLITE_MISUSE,b+"() requires "+D+" argument"+(D===1?"":"s")+"."),K=y=>c.sqlite3__wasm_db_error(y,i.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),C=y=>r.xWrap.argAdapter("sqlite3*")(y),$=y=>r.isPtr(y)?r.cstrToJs(y):y,p=(function(y,b){y=C(y);let D=this.dbMap.get(y);if(b)!D&&b>0&&this.dbMap.set(y,D=Object.create(null));else return this.dbMap.delete(y),D;return D}).bind(Object.assign(Object.create(null),{dbMap:new Map}));p.addCollation=function(y,b){const D=p(y,1);D.collation||(D.collation=new Set),D.collation.add($(b).toLowerCase())},p._addUDF=function(y,b,D,Q){b=$(b).toLowerCase();let E=Q.get(b);E||Q.set(b,E=new Set),E.add(D<0?-1:D)},p.addFunction=function(y,b,D){const Q=p(y,1);Q.udf||(Q.udf=new Map),this._addUDF(y,b,D,Q.udf)},r.exports.sqlite3_create_window_function&&(p.addWindowFunc=function(y,b,D){const Q=p(y,1);Q.wudf||(Q.wudf=new Map),this._addUDF(y,b,D,Q.wudf)}),p.cleanup=function(y){y=C(y);for(const Q of[["sqlite3_busy_handler",3],["sqlite3_commit_hook",3],["sqlite3_preupdate_hook",3],["sqlite3_progress_handler",4],["sqlite3_rollback_hook",3],["sqlite3_set_authorizer",3],["sqlite3_trace_v2",4],["sqlite3_update_hook",3]]){const[E,O]=Q;if(!r.exports[E])continue;const f=[y];f.length=O;try{i[E](...f)}catch(m){s.config.warn("close-time call of",E+"(",f,") threw:",m)}}const b=p(y,0);if(!b)return;if(b.collation){for(const Q of b.collation)try{i.sqlite3_create_collation_v2(y,Q,i.SQLITE_UTF8,0,0,0)}catch{}delete b.collation}let D;for(D=0;D<2;++D){const Q=D?b.wudf:b.udf;if(!Q)continue;const E=D?i.sqlite3_create_window_function:i.sqlite3_create_function_v2;for(const O of Q){const f=O[0],m=O[1],q=[y,f,0,i.SQLITE_UTF8,0,0,0,0,0];D&&q.push(0);for(const j of m)try{q[2]=j,E.apply(null,q)}catch{}m.clear()}Q.clear()}delete b.udf,delete b.wudf};{const y=r.xWrap("sqlite3_close_v2","int","sqlite3*");i.sqlite3_close_v2=function(b){if(arguments.length!==1)return T(b,"sqlite3_close_v2",1);if(b)try{p.cleanup(b)}catch{}return y(b)}}if(i.sqlite3session_create){const y=r.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);i.sqlite3session_delete=function(b){if(arguments.length!==1)return T(pDb,"sqlite3session_delete",1);b&&i.sqlite3session_table_filter(b,0,0),y(b)}}{const y=(D,Q)=>"argv["+Q+"]:"+D[0]+":"+r.cstrToJs(D[1]).toLowerCase(),b=r.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new r.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:y}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:y})]);i.sqlite3_create_collation_v2=function(D,Q,E,O,f,m){if(arguments.length!==6)return T(D,"sqlite3_create_collation_v2",6);if((E&15)===0)E|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(E&15))return K(D);try{const q=b(D,Q,E,O,f,m);return q===0&&f instanceof Function&&p.addCollation(D,Q),q}catch(q){return c.sqlite3__wasm_db_error(D,q)}},i.sqlite3_create_collation=(D,Q,E,O,f)=>arguments.length===5?i.sqlite3_create_collation_v2(D,Q,E,O,f,0):T(D,"sqlite3_create_collation",5)}{const y=function(E,O){return E[0]+":"+(E[2]<0?-1:E[2])+":"+O+":"+r.cstrToJs(E[1]).toLowerCase()},b=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:y,callProxy:E=>(O,f,m)=>{try{E(O,...i.sqlite3_values_to_js(f,m))}catch(q){i.sqlite3_result_error_js(O,q)}}},xFinalAndValue:{signature:"v(p)",contextKey:y,callProxy:E=>O=>{try{i.sqlite3_result_js(O,E(O))}catch(f){i.sqlite3_result_error_js(O,f)}}},xFunc:{signature:"v(pip)",contextKey:y,callProxy:E=>(O,f,m)=>{try{i.sqlite3_result_js(O,E(O,...i.sqlite3_values_to_js(f,m)))}catch(q){i.sqlite3_result_error_js(O,q)}}},xDestroy:{signature:"v(p)",contextKey:y,callProxy:E=>O=>{try{E(O)}catch(f){console.error("UDF xDestroy method threw:",f)}}}}),D=r.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xFunc",...b.xFunc}),new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]),Q=r.exports.sqlite3_create_window_function?r.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new r.xWrap.FuncPtrAdapter({name:"xStep",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xFinal",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xValue",...b.xFinalAndValue}),new r.xWrap.FuncPtrAdapter({name:"xInverse",...b.xInverseAndStep}),new r.xWrap.FuncPtrAdapter({name:"xDestroy",...b.xDestroy})]):void 0;i.sqlite3_create_function_v2=function E(O,f,m,q,j,Y,oe,ge,ye){if(E.length!==arguments.length)return T(O,"sqlite3_create_function_v2",E.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return K(O);try{const fe=D(O,f,m,q,j,Y,oe,ge,ye);return fe===0&&(Y instanceof Function||oe instanceof Function||ge instanceof Function||ye instanceof Function)&&p.addFunction(O,f,m),fe}catch(fe){return console.error("sqlite3_create_function_v2() setup threw:",fe),c.sqlite3__wasm_db_error(O,fe,"Creation of UDF threw: "+fe)}},i.sqlite3_create_function=function E(O,f,m,q,j,Y,oe,ge){return E.length===arguments.length?i.sqlite3_create_function_v2(O,f,m,q,j,Y,oe,ge,0):T(O,"sqlite3_create_function",E.length)},Q?i.sqlite3_create_window_function=function E(O,f,m,q,j,Y,oe,ge,ye,fe){if(E.length!==arguments.length)return T(O,"sqlite3_create_window_function",E.length);if((q&15)===0)q|=i.SQLITE_UTF8;else if(i.SQLITE_UTF8!==(q&15))return K(O);try{const H=Q(O,f,m,q,j,Y,oe,ge,ye,fe);return H===0&&(Y instanceof Function||oe instanceof Function||ge instanceof Function||ye instanceof Function||fe instanceof Function)&&p.addWindowFunc(O,f,m),H}catch(H){return console.error("sqlite3_create_window_function() setup threw:",H),c.sqlite3__wasm_db_error(O,H,"Creation of UDF threw: "+H)}}:delete i.sqlite3_create_window_function,i.sqlite3_create_function_v2.udfSetResult=i.sqlite3_create_function.udfSetResult=i.sqlite3_result_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetResult=i.sqlite3_result_js),i.sqlite3_create_function_v2.udfConvertArgs=i.sqlite3_create_function.udfConvertArgs=i.sqlite3_values_to_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfConvertArgs=i.sqlite3_values_to_js),i.sqlite3_create_function_v2.udfSetError=i.sqlite3_create_function.udfSetError=i.sqlite3_result_error_js,i.sqlite3_create_window_function&&(i.sqlite3_create_window_function.udfSetError=i.sqlite3_result_error_js)}{const y=(D,Q)=>(typeof D=="string"?Q=-1:c.isSQLableTypedArray(D)?(Q=D.byteLength,D=r.typedArrayToString(D instanceof ArrayBuffer?new Uint8Array(D):D)):Array.isArray(D)&&(D=D.join(""),Q=-1),[D,Q]),b={basic:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:r.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};i.sqlite3_prepare_v3=function D(Q,E,O,f,m,q){if(D.length!==arguments.length)return T(Q,"sqlite3_prepare_v3",D.length);const[j,Y]=y(E,Number(O));switch(typeof j){case"string":return b.basic(Q,j,Y,f,m,null);case typeof r.ptr.null:return b.full(Q,r.ptr.coerce(j),Y,f,m,q);default:return c.sqlite3__wasm_db_error(Q,i.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3(). typeof="+typeof j)}},i.sqlite3_prepare_v2=function D(Q,E,O,f,m){return D.length===arguments.length?i.sqlite3_prepare_v3(Q,E,O,0,f,m):T(Q,"sqlite3_prepare_v2",D.length)}}{const y=r.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),b=r.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);i.sqlite3_bind_text=function D(Q,E,O,f,m){if(D.length!==arguments.length)return T(i.sqlite3_db_handle(Q),"sqlite3_bind_text",D.length);if(r.isPtr(O)||O===null)return y(Q,E,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(pMem)&&(O=pMem.join(""));let q,j;try{if(c.isSQLableTypedArray(O))q=r.allocFromTypedArray(O),j=O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return y(Q,E,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),Y)}},i.sqlite3_bind_blob=function D(Q,E,O,f,m){if(D.length!==arguments.length)return T(i.sqlite3_db_handle(Q),"sqlite3_bind_blob",D.length);if(r.isPtr(O)||O===null)return b(Q,E,O,f,m);O instanceof ArrayBuffer?O=new Uint8Array(O):Array.isArray(O)&&(O=O.join(""));let q,j;try{if(c.isBindableTypedArray(O))q=r.allocFromTypedArray(O),j=f>=0?f:O.byteLength;else if(typeof O=="string")[q,j]=r.allocCString(O);else return c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),i.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return b(Q,E,q,j,i.SQLITE_WASM_DEALLOC)}catch(Y){return r.dealloc(q),c.sqlite3__wasm_db_error(i.sqlite3_db_handle(Q),Y)}}}if(!i.sqlite3_column_text){const y=r.xWrap.argAdapter("sqlite3_stmt*"),b=r.xWrap.argAdapter("int"),D=r.xWrap.argAdapter("sqlite3_value*"),Q=(E,O)=>r.typedArrayToString(r.heap8u(),Number(E),Number(E)+O);i.sqlite3_column_text=function(E,O){const f=y(E),m=b(O),q=r.exports.sqlite3_column_text(f,m);return q?Q(q,r.exports.sqlite3_column_bytes(f,m)):null},i.sqlite3_value_text=function(E){const O=D(E),f=r.exports.sqlite3_value_text(O);return f?Q(f,r.exports.sqlite3_value_bytes(O)):null}}i.sqlite3_config=function(y,...b){if(arguments.length<2)return i.SQLITE_MISUSE;switch(y){case i.SQLITE_CONFIG_COVERING_INDEX_SCAN:case i.SQLITE_CONFIG_MEMSTATUS:case i.SQLITE_CONFIG_SMALL_MALLOC:case i.SQLITE_CONFIG_SORTERREF_SIZE:case i.SQLITE_CONFIG_STMTJRNL_SPILL:case i.SQLITE_CONFIG_URI:return r.exports.sqlite3__wasm_config_i(y,b[0]);case i.SQLITE_CONFIG_LOOKASIDE:return r.exports.sqlite3__wasm_config_ii(y,b[0],b[1]);case i.SQLITE_CONFIG_MEMDB_MAXSIZE:return r.exports.sqlite3__wasm_config_j(y,b[0]);case i.SQLITE_CONFIG_GETMALLOC:case i.SQLITE_CONFIG_GETMUTEX:case i.SQLITE_CONFIG_GETPCACHE2:case i.SQLITE_CONFIG_GETPCACHE:case i.SQLITE_CONFIG_HEAP:case i.SQLITE_CONFIG_LOG:case i.SQLITE_CONFIG_MALLOC:case i.SQLITE_CONFIG_MMAP_SIZE:case i.SQLITE_CONFIG_MULTITHREAD:case i.SQLITE_CONFIG_MUTEX:case i.SQLITE_CONFIG_PAGECACHE:case i.SQLITE_CONFIG_PCACHE2:case i.SQLITE_CONFIG_PCACHE:case i.SQLITE_CONFIG_PCACHE_HDRSZ:case i.SQLITE_CONFIG_PMASZ:case i.SQLITE_CONFIG_SERIALIZED:case i.SQLITE_CONFIG_SINGLETHREAD:case i.SQLITE_CONFIG_SQLLOG:case i.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return i.SQLITE_NOTFOUND}};{const y=new Set;i.sqlite3_auto_extension=function(b){if(b instanceof Function)b=r.installFunction("i(ppp)",b);else if(arguments.length!==1||!r.isPtr(b))return i.SQLITE_MISUSE;const D=r.exports.sqlite3_auto_extension(b);return b!==arguments[0]&&(D===0?y.add(b):r.uninstallFunction(b)),D},i.sqlite3_cancel_auto_extension=function(b){return!b||arguments.length!==1||!r.isPtr(b)?0:r.exports.sqlite3_cancel_auto_extension(b)},i.sqlite3_reset_auto_extension=function(){r.exports.sqlite3_reset_auto_extension();for(const b of y)r.uninstallFunction(b);y.clear()}}r.xWrap.FuncPtrAdapter.warnOnUse=!0;const z=s.StructBinder,N=function y(b,D,Q,E=y.installMethodArgcCheck){if(b instanceof z.StructType?!(Q instanceof Function)&&!r.isPtr(Q)&&n("Usage error: expecting a Function or WASM pointer to one."):n("Usage error: target object is-not-a StructType."),arguments.length===1)return(q,j)=>y(b,q,j,E);y.argcProxy||(y.argcProxy=function(q,j,Y,oe){return function(...ge){return Y.length!==arguments.length&&n("Argument mismatch for",q.structInfo.name+"::"+j+": Native signature is:",oe),Y.apply(this,ge)}},y.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((q,j)=>{if(r.isPtr(q))try{r.uninstallFunction(q)}catch{}}),delete this.ondispose.__removeFuncList)});const O=b.memberSignature(D);O.length<2&&n("Member",D,"does not have a function pointer signature:",O);const f=b.memberKey(D),m=E&&!r.isPtr(Q)?y.argcProxy(b,f,Q,O):Q;if(r.isPtr(m))m&&!r.functionEntry(m)&&n("Pointer",m,"is not a WASM function table entry."),b[f]=m;else{const q=r.installFunction(m,O);b[f]=q,(!b.ondispose||!b.ondispose.__removeFuncList)&&(b.addOnDispose("ondispose.__removeFuncList handler",y.removeFuncList),b.ondispose.__removeFuncList=[]),b.ondispose.__removeFuncList.push(f,q)}return(q,j)=>y(b,q,j,E)};N.installMethodArgcCheck=!1;const te=function(y,b,D=N.installMethodArgcCheck){const Q=new Map;for(const E of Object.keys(b)){const O=b[E],f=Q.get(O);if(f){const m=y.memberKey(E);y[m]=y[y.memberKey(f)]}else N(y,E,O,D),Q.set(O,E)}return y};z.StructType.prototype.installMethod=function(b,D,Q=N.installMethodArgcCheck){return arguments.length<3&&b&&typeof b=="object"?te(this,...arguments):N(this,...arguments)},z.StructType.prototype.installMethods=function(y,b=N.installMethodArgcCheck){return te(this,y,b)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=(...A)=>{throw new s.SQLite3Error(...A)},i=s.capi,r=s.wasm,c=s.util,F=function(A){return(...l)=>A("sqlite3.oo1:",...l)};s.__isUnderTest?F(console.debug.bind(console)):F(s.config.debug),s.__isUnderTest?F(console.warn.bind(console)):F(s.config.warn),s.__isUnderTest?F(console.error.bind(console)):F(s.config.error);const T=new WeakMap,K=new Set,C=new WeakMap,$=(A,l,u)=>{const d=Object.getOwnPropertyDescriptor(A,l);return d?d.value:u},p=function(A,l){return l&&(A instanceof y&&(A=A.pointer),n(l,"sqlite3 result code",l+":",A?i.sqlite3_errmsg(A):i.sqlite3_errstr(l))),arguments[0]},z=r.installFunction("i(ippp)",(function(A,l,u,d){i.SQLITE_TRACE_STMT===A&&console.log("SQL TRACE #"+ ++this.counter,"via sqlite3@"+l+"["+i.sqlite3_db_filename(l,null)+"]",r.cstrToJs(d))}).bind({counter:0})),N=Object.create(null),te=function A(...l){const u=A.normalizeArgs(...l);let d;if(d=u["sqlite3*"])u["sqlite3*:takeOwnership"]||K.add(this),this.filename=i.sqlite3_db_filename(d,"main");else{let w=u.filename,U=u.vfs,J=u.flags;(typeof w!="string"&&!r.isPtr(w)||typeof J!="string"||U&&typeof U!="string"&&!r.isPtr(U))&&(s.config.error("Invalid DB ctor args",u,arguments),n("Invalid arguments for DB constructor:",arguments,"opts:",u));let R=0;J.indexOf("c")>=0&&(R|=i.SQLITE_OPEN_CREATE|i.SQLITE_OPEN_READWRITE),J.indexOf("w")>=0&&(R|=i.SQLITE_OPEN_READWRITE),R===0&&(R|=i.SQLITE_OPEN_READONLY),R|=i.SQLITE_OPEN_EXRESCODE;const h=r.pstack.pointer;try{const P=r.pstack.allocPtr();let W=i.sqlite3_open_v2(w,P,R,U||r.ptr.null);d=r.peekPtr(P),p(d,W),i.sqlite3_extended_result_codes(d,1),J.indexOf("t")>=0&&i.sqlite3_trace_v2(d,i.SQLITE_TRACE_STMT,z,d)}catch(P){throw d&&i.sqlite3_close_v2(d),P}finally{r.pstack.restore(h)}this.filename=r.isPtr(w)?r.cstrToJs(w):w}if(T.set(this,d),C.set(this,Object.create(null)),!u["sqlite3*"])try{const w=N[i.sqlite3_js_db_vfs(d)||n("Internal error: cannot get VFS for new db handle.")];w&&(w instanceof Function?w(this,s):p(d,i.sqlite3_exec(d,w,0,0,0)))}catch(w){throw this.close(),w}};te.setVfsPostOpenCallback=function(A,l){l instanceof Function||n("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),N[A]=l},te.normalizeArgs=function(A=":memory:",l="c",u=null){const d={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(d,arguments[0]),d.flags===void 0&&(d.flags="c"),d.vfs===void 0&&(d.vfs=null),d.filename===void 0&&(d.filename=":memory:")):(d.filename=A,d.flags=l,d.vfs=u),d};const y=function(...A){te.apply(this,A)};y.dbCtorHelper=te;const b={null:1,number:2,string:3,boolean:4,blob:5};r.bigIntEnabled&&(b.bigint=b.number);const D=function(){b!==arguments[2]&&n(i.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],T.set(this,arguments[1]),arguments.length>3&&!arguments[3]&&K.add(this)},Q=function(A){return A.pointer||n("DB has been closed."),A},E=function(A,l){return(l!==(l|0)||l<0||l>=A.columnCount)&&n("Column index",l,"is out of range."),A},O=function(A,l){const u=Object.create(null);switch(u.opt=Object.create(null),l.length){case 1:typeof l[0]=="string"||c.isSQLableTypedArray(l[0])||Array.isArray(l[0])?u.sql=l[0]:l[0]&&typeof l[0]=="object"&&(u.opt=l[0],u.sql=u.opt.sql);break;case 2:u.sql=l[0],u.opt=l[1];break;default:n("Invalid argument count for exec().")}u.sql=c.flexibleString(u.sql),typeof u.sql!="string"&&n("Missing SQL argument or unsupported SQL value type.");const d=u.opt;switch(d.returnValue){case"resultRows":d.resultRows||(d.resultRows=[]),u.returnVal=()=>d.resultRows;break;case"saveSql":d.saveSql||(d.saveSql=[]),u.returnVal=()=>d.saveSql;break;case void 0:case"this":u.returnVal=()=>A;break;default:n("Invalid returnValue value:",d.returnValue)}if(!d.callback&&!d.returnValue&&d.rowMode!==void 0&&(d.resultRows||(d.resultRows=[]),u.returnVal=()=>d.resultRows),d.callback||d.resultRows)switch(d.rowMode===void 0?"array":d.rowMode){case"object":u.cbArg=(w,U)=>{U.columnNames||(U.columnNames=w.getColumnNames([]));const J=w.get([]),R=Object.create(null);for(const h in U.columnNames)R[U.columnNames[h]]=J[h];return R};break;case"array":u.cbArg=w=>w.get([]);break;case"stmt":Array.isArray(d.resultRows)&&n("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),u.cbArg=w=>w;break;default:if(c.isInt32(d.rowMode)){u.cbArg=w=>w.get(d.rowMode);break}else if(typeof d.rowMode=="string"&&d.rowMode.length>1&&d.rowMode[0]==="$"){const w=d.rowMode.substr(1);u.cbArg=U=>{const J=U.get(Object.create(null))[w];return J===void 0?n(i.SQLITE_NOTFOUND,"exec(): unknown result column:",w):J};break}n("Invalid rowMode:",d.rowMode)}return u},f=(A,l,u,...d)=>{const w=A.prepare(l);try{const U=w.bind(u).step()?w.get(...d):void 0;return w.reset(),U}finally{w.finalize()}},m=(A,l,u,d)=>A.exec({sql:l,bind:u,rowMode:d,returnValue:"resultRows"});y.checkRc=(A,l)=>p(A,l),y.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return Q(this)},close:function(){const A=this.pointer;if(A){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}if(Object.keys(C.get(this)).forEach((l,u)=>{if(u&&u.pointer)try{u.finalize()}catch{}}),T.delete(this),C.delete(this),K.delete(this)||i.sqlite3_close_v2(A),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(A=!1,l=!1){const u=Q(this).pointer;return A?l?i.sqlite3_total_changes64(u):i.sqlite3_total_changes(u):l?i.sqlite3_changes64(u):i.sqlite3_changes(u)},dbFilename:function(A="main"){return i.sqlite3_db_filename(Q(this).pointer,A)},dbName:function(A=0){return i.sqlite3_db_name(Q(this).pointer,A)},dbVfsName:function(A=0){let l;const u=i.sqlite3_js_db_vfs(Q(this).pointer,A);if(u){const d=new i.sqlite3_vfs(u);try{l=r.cstrToJs(d.$zName)}finally{d.dispose()}}return l},prepare:function(A){Q(this);const l=r.pstack.pointer;let u,d;try{u=r.pstack.alloc(8),y.checkRc(this,i.sqlite3_prepare_v2(this.pointer,A,-1,u,null)),d=r.peekPtr(u)}finally{r.pstack.restore(l)}d||n("Cannot prepare empty SQL.");const w=new D(this,d,b);return C.get(this)[d]=w,w},exec:function(){Q(this);const A=O(this,arguments);if(!A.sql)return n("exec() requires an SQL string.");const l=A.opt,u=l.callback,d=Array.isArray(l.resultRows)?l.resultRows:void 0;let w,U=l.bind,J=!!(A.cbArg||l.columnNames||d);const R=r.scopedAllocPush(),h=Array.isArray(l.saveSql)?l.saveSql:void 0;try{const P=c.isSQLableTypedArray(A.sql);let W=P?A.sql.byteLength:r.jstrlen(A.sql);const ne=r.scopedAlloc(2*r.ptr.size+(W+1)),g=r.ptr.add(ne,r.ptr.size);let L=r.ptr.add(g,r.ptr.size);const V=r.ptr.add(L,W);for(P?r.heap8().set(A.sql,L):r.jstrcpy(A.sql,r.heap8(),L,W,!1),r.poke8(r.ptr.add(L,W),0);L&&r.peek8(L);){r.pokePtr([ne,g],0),y.checkRc(this,i.sqlite3_prepare_v3(this.pointer,L,W,0,ne,g));const re=r.peekPtr(ne);if(L=r.peekPtr(g),W=Number(r.ptr.add(V,-L)),!!re){if(h&&h.push(i.sqlite3_sql(re).trim()),w=new D(this,re,b),U&&w.parameterCount&&(w.bind(U),U=null),J&&w.columnCount){let Z=Array.isArray(l.columnNames)?0:1;if(J=!1,A.cbArg||d){const ce=Object.create(null);for(;w.step();ge.delete(w)){Z++===0&&w.getColumnNames(ce.columnNames=l.columnNames||[]),ge.add(w);const qe=A.cbArg(w,ce);if(d&&d.push(qe),u&&u.call(l,qe,w)===!1)break}ge.delete(w)}Z===0&&w.getColumnNames(l.columnNames)}else w.step();w.reset().finalize(),w=null}}}finally{w&&(ge.delete(w),w.finalize()),r.scopedAllocPop(R)}return A.returnVal()},createFunction:function(l,u,d){const w=ce=>ce instanceof Function;switch(arguments.length){case 1:d=l,l=d.name,u=d.xFunc||0;break;case 2:w(u)||(d=u,u=d.xFunc||0);break}d||(d={}),typeof l!="string"&&n("Invalid arguments: missing function name.");let U=d.xStep||0,J=d.xFinal||0;const R=d.xValue||0,h=d.xInverse||0;let P;w(u)?(P=!1,(w(U)||w(J))&&n("Ambiguous arguments: scalar or aggregate?"),U=J=null):w(U)?(w(J)||n("Missing xFinal() callback for aggregate or window UDF."),u=null):w(J)?n("Missing xStep() callback for aggregate or window UDF."):n("Missing function-type properties."),P===!1?(w(R)||w(h))&&n("xValue and xInverse are not permitted for non-window UDFs."):w(R)?(w(h)||n("xInverse must be provided if xValue is."),P=!0):w(h)&&n("xValue must be provided if xInverse is.");const W=d.pApp;W!=null&&!r.isPtr(W)&&n("Invalid value for pApp property. Must be a legal WASM pointer value.");const ne=d.xDestroy||0;ne&&!w(ne)&&n("xDestroy property must be a function.");let g=0;$(d,"deterministic")&&(g|=i.SQLITE_DETERMINISTIC),$(d,"directOnly")&&(g|=i.SQLITE_DIRECTONLY),$(d,"innocuous")&&(g|=i.SQLITE_INNOCUOUS),l=l.toLowerCase();const L=u||U,V=$(d,"arity"),re=typeof V=="number"?V:L.length?L.length-1:0;let Z;return P?Z=i.sqlite3_create_window_function(this.pointer,l,re,i.SQLITE_UTF8|g,W||0,U,J,R,h,ne):Z=i.sqlite3_create_function_v2(this.pointer,l,re,i.SQLITE_UTF8|g,W||0,u,U,J,ne),y.checkRc(this,Z),this},selectValue:function(A,l,u){return f(this,A,l,0,u)},selectValues:function(A,l,u){const d=this.prepare(A),w=[];try{for(d.bind(l);d.step();)w.push(d.get(0,u));d.reset()}finally{d.finalize()}return w},selectArray:function(A,l){return f(this,A,l,[])},selectObject:function(A,l){return f(this,A,l,{})},selectArrays:function(A,l){return m(this,A,l,"array")},selectObjects:function(A,l){return m(this,A,l,"object")},openStatementCount:function(){return this.pointer?Object.keys(C.get(this)).length:0},transaction:function(A){let l="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&n(i.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),l+=" "+arguments[0],A=arguments[1]),Q(this).exec(l);try{const u=A(this);return this.exec("COMMIT"),u}catch(u){throw this.exec("ROLLBACK"),u}},savepoint:function(A){Q(this).exec("SAVEPOINT oo1");try{const l=A(this);return this.exec("RELEASE oo1"),l}catch(l){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),l}},checkRc:function(A){return p(this,A)}},y.wrapHandle=function(A,l=!1){if(!A||!r.isPtr(A))throw new s.SQLite3Error(i.SQLITE_MISUSE,"Argument must be a WASM sqlite3 pointer");return new y({"sqlite3*":A,"sqlite3*:takeOwnership":!!l})};const q=function(A){return A.pointer||n("Stmt has been closed."),A},j=function(A){let l=b[A==null?"null":typeof A];switch(l){case b.boolean:case b.null:case b.number:case b.string:return l;case b.bigint:return r.bigIntEnabled?l:void 0;default:return c.isBindableTypedArray(A)?b.blob:void 0}},Y=function(A){return j(A)||n("Unsupported bind() argument type:",typeof A)},oe=function(A,l){const u=typeof l=="number"?l:i.sqlite3_bind_parameter_index(A.pointer,l);return u===0||!c.isInt32(u)?n("Invalid bind() parameter name: "+l):(u<1||u>A.parameterCount)&&n("Bind index",l,"is out of range."),u},ge=new Set,ye=new Set,fe=function(A,l){return ge.has(A)&&n("Operation is illegal when statement is locked:",l),A},H=function A(l,u,d,w){fe(q(l),"bind()"),A._||(A._tooBigInt=J=>n("BigInt value is too big to store without precision loss:",J),A._={string:function(J,R,h,P){const[W,ne]=r.allocCString(h,!0);return(P?i.sqlite3_bind_blob:i.sqlite3_bind_text)(J.pointer,R,W,ne,i.SQLITE_WASM_DEALLOC)}}),Y(w),u=oe(l,u);let U=0;switch(w==null?b.null:d){case b.null:U=i.sqlite3_bind_null(l.pointer,u);break;case b.string:U=A._.string(l,u,w,!1);break;case b.number:{let J;c.isInt32(w)?J=i.sqlite3_bind_int:typeof w=="bigint"?c.bigIntFits64(w)?r.bigIntEnabled?J=i.sqlite3_bind_int64:c.bigIntFitsDouble(w)?(w=Number(w),J=i.sqlite3_bind_double):A._tooBigInt(w):A._tooBigInt(w):(w=Number(w),r.bigIntEnabled&&Number.isInteger(w)?J=i.sqlite3_bind_int64:J=i.sqlite3_bind_double),U=J(l.pointer,u,w);break}case b.boolean:U=i.sqlite3_bind_int(l.pointer,u,w?1:0);break;case b.blob:{if(typeof w=="string"){U=A._.string(l,u,w,!0);break}else w instanceof ArrayBuffer?w=new Uint8Array(w):c.isBindableTypedArray(w)||n("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const J=r.alloc(w.byteLength||1);r.heap8().set(w.byteLength?w:[0],Number(J)),U=i.sqlite3_bind_blob(l.pointer,u,J,w.byteLength,i.SQLITE_WASM_DEALLOC);break}default:s.config.warn("Unsupported bind() argument type:",w),n("Unsupported bind() argument type: "+typeof w)}return U&&y.checkRc(l.db.pointer,U),l};D.prototype={finalize:function(){const A=this.pointer;if(A){fe(this,"finalize()");const l=K.delete(this)?0:i.sqlite3_finalize(A);return delete C.get(this.db)[A],T.delete(this),ge.delete(this),ye.delete(this),delete this.parameterCount,delete this.db,l}},clearBindings:function(){return fe(q(this),"clearBindings()"),i.sqlite3_clear_bindings(this.pointer),ye.delete(this),this},reset:function(A){fe(this,"reset()"),A&&this.clearBindings();const l=i.sqlite3_reset(q(this).pointer);return ye.delete(this),p(this.db,l),this},bind:function(){q(this);let A,l;switch(arguments.length){case 1:A=1,l=arguments[0];break;case 2:A=arguments[0],l=arguments[1];break;default:n("Invalid bind() arguments.")}return l===void 0?this:(this.parameterCount||n("This statement has no bindable parameters."),ye.delete(this),l===null?H(this,A,b.null,l):Array.isArray(l)?(arguments.length!==1&&n("When binding an array, an index argument is not permitted."),l.forEach((u,d)=>H(this,d+1,Y(u),u)),this):(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),typeof l=="object"&&!c.isBindableTypedArray(l)?(arguments.length!==1&&n("When binding an object, an index argument is not permitted."),Object.keys(l).forEach(u=>H(this,u,Y(l[u]),l[u])),this):H(this,A,Y(l),l)))},bindAsBlob:function(A,l){q(this),arguments.length===1&&(l=A,A=1);const u=Y(l);return b.string!==u&&b.blob!==u&&b.null!==u&&n("Invalid value type for bindAsBlob()"),H(this,A,b.blob,l)},step:function(){fe(this,"step()");const A=i.sqlite3_step(q(this).pointer);switch(A){case i.SQLITE_DONE:return ye.delete(this),!1;case i.SQLITE_ROW:return ye.add(this),!0;default:ye.delete(this),s.config.warn("sqlite3_step() rc=",A,i.sqlite3_js_rc_str(A),"SQL =",i.sqlite3_sql(this.pointer)),y.checkRc(this.db.pointer,A)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const A=this.step();return this.reset(),A}finally{try{this.finalize()}catch{}}},get:function(A,l){if(ye.has(q(this))||n("Stmt.step() has not (recently) returned true."),Array.isArray(A)){let u=0;const d=this.columnCount;for(;u<d;)A[u]=this.get(u++);return A}else if(A&&typeof A=="object"){let u=0;const d=this.columnCount;for(;u<d;)A[i.sqlite3_column_name(this.pointer,u)]=this.get(u++);return A}switch(E(this,A),l===void 0?i.sqlite3_column_type(this.pointer,A):l){case i.SQLITE_NULL:return null;case i.SQLITE_INTEGER:if(r.bigIntEnabled){const u=i.sqlite3_column_int64(this.pointer,A);return u>=Number.MIN_SAFE_INTEGER&&u<=Number.MAX_SAFE_INTEGER?Number(u).valueOf():u}else{const u=i.sqlite3_column_double(this.pointer,A);return(u>Number.MAX_SAFE_INTEGER||u<Number.MIN_SAFE_INTEGER)&&n("Integer is out of range for JS integer range: "+u),c.isInt32(u)?u|0:u}case i.SQLITE_FLOAT:return i.sqlite3_column_double(this.pointer,A);case i.SQLITE_TEXT:return i.sqlite3_column_text(this.pointer,A);case i.SQLITE_BLOB:{const u=i.sqlite3_column_bytes(this.pointer,A),d=i.sqlite3_column_blob(this.pointer,A),w=new Uint8Array(u);return u&&(w.set(r.heap8u().slice(Number(d),Number(d)+u),0),this.db._blobXfer instanceof Array&&this.db._blobXfer.push(w.buffer)),w}default:n("Don't know how to translate","type of result column #"+A+".")}n("Not reached.")},getInt:function(A){return this.get(A,i.SQLITE_INTEGER)},getFloat:function(A){return this.get(A,i.SQLITE_FLOAT)},getString:function(A){return this.get(A,i.SQLITE_TEXT)},getBlob:function(A){return this.get(A,i.SQLITE_BLOB)},getJSON:function(A){const l=this.get(A,i.SQLITE_STRING);return l===null?l:JSON.parse(l)},getColumnName:function(A){return i.sqlite3_column_name(E(q(this),A).pointer,A)},getColumnNames:function(A=[]){E(q(this),0);const l=this.columnCount;for(let u=0;u<l;++u)A.push(i.sqlite3_column_name(this.pointer,u));return A},getParamIndex:function(A){return q(this).parameterCount?i.sqlite3_bind_parameter_index(this.pointer,A):void 0},getParamName:function(A){return q(this).parameterCount?i.sqlite3_bind_parameter_name(this.pointer,A):void 0},isBusy:function(){return i.sqlite3_stmt_busy(q(this))!==0},isReadOnly:function(){return i.sqlite3_stmt_readonly(q(this))!==0}};{const A={enumerable:!0,get:function(){return T.get(this)},set:()=>n("The pointer property is read-only.")};Object.defineProperty(D.prototype,"pointer",A),Object.defineProperty(y.prototype,"pointer",A)}Object.defineProperty(D.prototype,"columnCount",{enumerable:!1,get:function(){return i.sqlite3_column_count(this.pointer)},set:()=>n("The columnCount property is read-only.")}),Object.defineProperty(D.prototype,"parameterCount",{enumerable:!1,get:function(){return i.sqlite3_bind_parameter_count(this.pointer)},set:()=>n("The parameterCount property is read-only.")}),D.wrapHandle=function(A,l,u=!1){if(!(A instanceof y)||!A.pointer)throw new s.SQLite3Error(s.SQLITE_MISUSE,"First argument must be an opened sqlite3.oo1.DB instance");if(!l||!r.isPtr(l))throw new s.SQLite3Error(s.SQLITE_MISUSE,"Second argument must be a WASM sqlite3_stmt pointer");return new D(A,l,b,!!u)},s.oo1={DB:y,Stmt:D}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util;s.initWorker1API=(function(){const i=(...z)=>{throw new Error(z.join(" "))};globalThis.WorkerGlobalScope instanceof Function||i("initWorker1API() must be run from a Worker thread.");const r=this.sqlite3||i("Missing this.sqlite3 object."),c=r.oo1.DB,F=function(z){let N=T.idMap.get(z);return N||(N="db#"+ ++T.idSeq+":"+Math.floor(Math.random()*1e8)+":"+Math.floor(Math.random()*1e8),T.idMap.set(z,N),N)},T={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(z){const N=new c(z);return this.dbs[F(N)]=N,this.dbList.indexOf(N)<0&&this.dbList.push(N),N},close:function(z,N){if(z){delete this.dbs[F(z)];const te=z.filename,y=n.sqlite3__wasm_db_vfs(z.pointer,0);z.close();const b=this.dbList.indexOf(z);b>=0&&this.dbList.splice(b,1),N&&te&&y&&n.sqlite3__wasm_vfs_unlink(y,te)}},post:function(z,N){N&&N.length?(globalThis.postMessage(z,Array.from(N)),N.length=0):globalThis.postMessage(z)},dbs:Object.create(null),getDb:function(z,N=!0){return this.dbs[z]||(N?i("Unknown (or closed) DB ID:",z):void 0)}},K=function(z=T.dbList[0]){return z&&z.pointer?z:i("DB is not opened.")},C=function(z,N=!0){const te=T.getDb(z.dbId,!1)||T.dbList[0];return N?K(te):te},$=function(){return T.dbList[0]&&F(T.dbList[0])},p={open:function(z){const N=Object.create(null),te=z.args||Object.create(null);te.simulateError&&i("Throwing because of simulateError flag.");const y=Object.create(null);N.vfs=te.vfs,N.filename=te.filename||"";const b=T.open(N);return y.filename=b.filename,y.persistent=!!r.capi.sqlite3_js_db_uses_vfs(b.pointer,"opfs"),y.dbId=F(b),y.vfs=b.dbVfsName(),y},close:function(z){const N=C(z,!1),te={filename:N&&N.filename};if(N){const y=z.args&&typeof z.args=="object"?!!z.args.unlink:!1;T.close(N,y)}return te},exec:function(z){const N=typeof z.args=="string"?{sql:z.args}:z.args||Object.create(null);N.rowMode==="stmt"?i("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):N.sql||i("'exec' requires input SQL.");const te=C(z);(N.callback||Array.isArray(N.resultRows))&&(te._blobXfer=T.xfer);const y=N.callback;let b=0;const D=!!N.columnNames;typeof y=="string"&&(D||(N.columnNames=[]),N.callback=function(Q,E){T.post({type:y,columnNames:N.columnNames,rowNumber:++b,row:Q},T.xfer)});try{const Q=N.countChanges?te.changes(!0,N.countChanges===64):void 0;te.exec(N),Q!==void 0&&(N.changeCount=te.changes(!0,N.countChanges===64)-Q);const E=N.lastInsertRowId?r.capi.sqlite3_last_insert_rowid(te):void 0;E!==void 0&&(N.lastInsertRowId=E),N.callback instanceof Function&&(N.callback=y,T.post({type:y,columnNames:N.columnNames,rowNumber:null,row:void 0}))}finally{delete te._blobXfer,N.callback&&(N.callback=y)}return N},"config-get":function(){const z=Object.create(null),N=r.config;return["bigIntEnabled"].forEach(function(te){Object.getOwnPropertyDescriptor(N,te)&&(z[te]=N[te])}),z.version=r.version,z.vfsList=r.capi.sqlite3_js_vfs_list(),z},export:function(z){const N=C(z),te={byteArray:r.capi.sqlite3_js_db_export(N.pointer),filename:N.filename,mimetype:"application/x-sqlite3"};return T.xfer.push(te.byteArray.buffer),te},toss:function(z){i("Testing worker exception")}};globalThis.onmessage=async function(z){z=z.data;let N,te=z.dbId,y=z.type;const b=performance.now();try{p.hasOwnProperty(y)&&p[y]instanceof Function?N=await p[y](z):i("Unknown db worker message type:",z.type)}catch(D){y="error",N={operation:z.type,message:D.message,errorClass:D.name,input:z},D.stack&&(N.stack=typeof D.stack=="string"?D.stack.split(/\n\s*/):D.stack)}te||(te=N.dbId||$()),T.post({type:y,dbId:te,messageId:z.messageId,workerReceivedTime:b,workerRespondTime:performance.now(),departureTime:z.departureTime,result:N},T.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:s})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.wasm,i=s.capi,r=s.util.toss3,c=Object.create(null);s.vfs=c,i.sqlite3_vfs.prototype.registerVfs=function(F=!1){this instanceof s.capi.sqlite3_vfs||r("Expecting a sqlite3_vfs-type argument.");const T=i.sqlite3_vfs_register(this,F?1:0);return T&&r("sqlite3_vfs_register(",this,") failed with rc",T),this.pointer!==i.sqlite3_vfs_find(this.$zName)&&r("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},c.installVfs=function(F){let T=0;const K=["io","vfs"];for(const C of K){const $=F[C];$&&(++T,$.struct.installMethods($.methods,!!$.applyArgcCheck),C==="vfs"&&(!$.struct.$zName&&typeof $.name=="string"&&$.struct.addOnDispose($.struct.$zName=n.allocCString($.name)),$.struct.registerVfs(!!$.asDefault)))}return T||r("Misuse: installVfs() options object requires at least","one of:",K),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){if(!s.wasm.exports.sqlite3_declare_vtab)return;const n=s.wasm,i=s.capi,r=s.util.toss3,c=Object.create(null);s.vtab=c;const F=i.sqlite3_index_info;F.prototype.nthConstraint=function(C,$=!1){if(C<0||C>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraint,F.sqlite3_index_constraint.structInfo.sizeof*C);return $?p:new F.sqlite3_index_constraint(p)},F.prototype.nthConstraintUsage=function(C,$=!1){if(C<0||C>=this.$nConstraint)return!1;const p=n.ptr.add(this.$aConstraintUsage,F.sqlite3_index_constraint_usage.structInfo.sizeof*C);return $?p:new F.sqlite3_index_constraint_usage(p)},F.prototype.nthOrderBy=function(C,$=!1){if(C<0||C>=this.$nOrderBy)return!1;const p=n.ptr.add(this.$aOrderBy,F.sqlite3_index_orderby.structInfo.sizeof*C);return $?p:new F.sqlite3_index_orderby(p)};const T=function(C,$){return(function(p,z=!1){if(arguments.length===0&&(p=new $),p instanceof $)return this.set(p.pointer,p),p;n.isPtr(p)||s.SQLite3Error.toss("Invalid argument to",C+"()");let N=this.get(p);return z&&this.delete(p),N}).bind(new Map)},K=function(C,$){const p=T(C,$);return Object.assign(Object.create(null),{StructType:$,create:z=>{const N=p();return n.pokePtr(z,N.pointer),N},get:z=>p(z),unget:z=>p(z,!0),dispose:z=>p(z,!0)?.dispose?.()})};c.xVtab=K("xVtab",i.sqlite3_vtab),c.xCursor=K("xCursor",i.sqlite3_vtab_cursor),c.xIndexInfo=C=>new i.sqlite3_index_info(C),c.xError=function C($,p,z){if(C.errorReporter instanceof Function)try{C.errorReporter("sqlite3_module::"+$+"(): "+p.message)}catch{}let N;return p instanceof s.WasmAllocError?N=i.SQLITE_NOMEM:arguments.length>2?N=z:p instanceof s.SQLite3Error&&(N=p.resultCode),N||i.SQLITE_ERROR},c.xError.errorReporter=s.config.error.bind(s.config),c.xRowid=(C,$)=>n.poke(C,$,"i64"),c.setupModule=function(C){let $=!1;const p=this instanceof i.sqlite3_module?this:C.struct||($=new i.sqlite3_module);try{const z=C.methods||r("Missing 'methods' object.");for(const N of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const te=N[0],y=N[1];z[te]===!0?z[te]=z[y]:z[y]===!0&&(z[y]=z[te])}if(C.catchExceptions){const N=function(b,D){return["xConnect","xCreate"].indexOf(b)>=0?function(Q,E,O,f,m,q){try{return D(...arguments)||0}catch(j){return j instanceof s.WasmAllocError||(n.dealloc(n.peekPtr(q)),n.pokePtr(q,n.allocCString(j.message))),c.xError(b,j)}}:function(...Q){try{return D(...Q)||0}catch(E){return c.xError(b,E)}}},te=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],y=Object.create(null);for(const b of te){const D=z[b];if(D instanceof Function)b==="xConnect"&&z.xCreate===D?y[b]=z.xCreate:b==="xCreate"&&z.xConnect===D?y[b]=z.xConnect:y[b]=N(b,D);else continue}p.installMethods(y,!1)}else p.installMethods(z,!!C.applyArgcCheck);if(p.$iVersion===0){let N;typeof C.iVersion=="number"?N=C.iVersion:p.$xIntegrity?N=4:p.$xShadowName?N=3:p.$xSavePoint||p.$xRelease||p.$xRollbackTo?N=2:N=1,p.$iVersion=N}}catch(z){throw $&&$.dispose(),z}return p},i.sqlite3_module.prototype.setupModule=function(C){return c.setupModule.call(this,C)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.capi,i=n.sqlite3_kvvfs_methods,r=n.KVVfsFile,c=s.capi.sqlite3_vfs_find("kvvfs");if(delete n.sqlite3_kvvfs_methods,delete n.KVVfsFile,!c)return;const F=s.util,T=s.wasm,K=F.toss3,C=(S,x)=>Object.prototype.hasOwnProperty.call(S,x),$=new i(T.exports.sqlite3__wasm_kvvfs_methods());F.assert(32<=$.$nKeySize,"unexpected kvvfsMethods.$nKeySize: "+$.$nKeySize);const p=Object.assign(Object.create(null),{rxJournalSuffix:/-journal$/,zKeyJrnl:T.allocCString("jrnl"),zKeySz:T.allocCString("sz"),keySize:$.$nKeySize,buffer:Object.assign(Object.create(null),{n:$.$nBufferSize,pool:Object.create(null)})});p.memBuffer=(S=0)=>p.buffer.pool[S]??=T.alloc(p.buffer.n),p.memBufferFree=S=>{const x=p.buffer.pool[S];x&&(T.dealloc(x),delete p.buffer.pool[S])};const z=()=>{},N=s.__isUnderTest?(...S)=>s.config.debug("kvvfs:",...S):z,te=(...S)=>s.config.warn("kvvfs:",...S),y=(...S)=>s.config.error("kvvfs:",...S);class b{#e;#r;#l(){return this.#r??=Object.keys(this.#e)}constructor(){this.clear()}key(x){const M=this.#l();return x<M.length?M[x]:null}getItem(x){return this.#e[x]??null}setItem(x,M){C(this.#e,x)||(this.#r=null),this.#e[x]=""+M}removeItem(x){delete this.#e[x]&&(this.#r=null)}clear(){this.#e=Object.create(null),this.#r=null}get length(){return this.#l().length}}const D=S=>S==="local"||S==="session",Q=S=>D(S)?"kvvfs-"+S+"-":"",E=function(S,x=!1){if(D(S))return;const M=new Blob([S]).size;M||K(n.SQLITE_MISUSE,"Empty name is not permitted.");let B=p.keySize-1;p.rxJournalSuffix.test(S)?x||K(n.SQLITE_MISUSE,"Storage names may not have a '-journal' suffix."):["-wal","-shm"].filter(le=>S.endsWith(le)).length?K(n.SQLITE_MISUSE,"Storage names may not have a -wal or -shm suffix."):B-=8,M>B&&K(n.SQLITE_RANGE,"Storage name is too long. Limit =",B);let ee;for(ee=0;ee<M;++ee){const le=S.codePointAt(ee);le<32&&K(n.SQLITE_RANGE,"Illegal character ("+le+"d) in storage name:",S)}},O=(S,x=void 0)=>Object.assign(Object.create(null),{jzClass:S,refc:1,deleteAtRefc0:!1,storage:x||new b,keyPrefix:Q(S),files:[],listeners:void 0}),f=s.kvvfs=Object.create(null);s.__isUnderTest&&(f.log=Object.assign(Object.create(null),{xOpen:!1,xClose:!1,xWrite:!1,xRead:!1,xSync:!1,xAccess:!1,xFileControl:!1,xRcrdRead:!1,xRcrdWrite:!1,xRcrdDelete:!1}));const m=function(S){const x=p.rxJournalSuffix.test(S.jzClass)?S.jzClass.replace(p.rxJournalSuffix,""):S.jzClass+"-journal";f?.log?.xClose&&N("cleaning up storage handles [",S.jzClass,x,"]",S),delete p.storagePool[S.jzClass],delete p.storagePool[x],s.__isUnderTest||(delete S.storage,delete S.refc)},q=S=>p.storagePool[S.jzClass]=p.storagePool[S.jzClass+"-journal"]=S,j=".";p.storagePool=Object.assign(Object.create(null),{[j]:O(j)}),globalThis.Storage&&(globalThis.localStorage instanceof globalThis.Storage&&(p.storagePool.local=O("local",globalThis.localStorage)),globalThis.sessionStorage instanceof globalThis.Storage&&(p.storagePool.session=O("session",globalThis.sessionStorage))),p.builtinStorageNames=Object.keys(p.storagePool);const Y=S=>p.builtinStorageNames.indexOf(S)>-1;for(const S of Object.keys(p.storagePool)){const x=p.storagePool[S];p.storagePool[S+"-journal"]=x}p.setError=(S=void 0,x=n.SQLITE_ERROR)=>S?(p.lastError=S,S.resultCode|0||x):(delete p.lastError,0),p.popError=()=>{const S=p.lastError;return delete p.lastError,S};const oe=S=>{te("kvvfs.listener handler threw:",S)},ge=T.exports.sqlite3__wasm_kvvfs_decode,ye=T.exports.sqlite3__wasm_kvvfs_encode,fe=async function(S,x,...M){try{x.keyPrefix&&M[0]&&(M[0]=M[0].replace(x.keyPrefix,""));let B,ee,le,_e;for(const ae of x.listeners){const he=Object.create(null);he.storageName=x.jzClass,he.type=S,ae.decodePages;const Ae=ae.events[S];if(Ae){if(!ae.includeJournal&&M[0]==="jrnl")continue;if(S==="write"&&ae.decodePages&&+M[0]>0){if(he.data=[M[0]],_e?.[M[0]]){he.data[1]=_e[M[0]];continue}B??=new TextEncoder("utf-8"),ee??=p.memBuffer(10),le??=p.memBuffer(11);const xe=B.encode(M[1]),ve=T.heap8u();ve.set(xe,Number(ee)),ve[T.ptr.addn(ee,xe.length)]=0;const Me=ge(ee,le,p.buffer.n);if(Me>0)_e??=Object.create(null),_e[M[0]]=he.data[1]=ve.slice(Number(le),T.ptr.addn(le,Me));else continue}else he.data=M.length?M.length===1?M[0]:M:void 0;try{Ae(he)?.catch?.(oe)}catch(xe){te("notifyListeners [",x.jzClass,"]",S,xe)}}}}catch(B){oe(B)}},H=S=>typeof S=="string"?p.storagePool[S]:p.storagePool[T.cstrToJs(S)],A=T.exports.sqlite3__wasm_kvvfsMakeKey,l=(S,x,M)=>x&&S.keyPrefix?A(x,M):M,u=(S,x,M)=>T.cstrToJs(l(S,x,M)),d=S=>+S.storage.getItem(S.keyPrefix+"sz"),w=new Map,U={vfs:Object.create(null),ioDb:Object.create(null),ioJrnl:Object.create(null)},J=new n.sqlite3_vfs($.$pVfs),R=new n.sqlite3_io_methods($.$pIoDb),h=new n.sqlite3_io_methods($.$pIoJrnl),P=Object.create(null),W=Object.assign(Object.create(null),{pFileHandles:w,cache:p,storageForZClass:H,KVVfsStorage:b,disablePageSizeChange:!0});f.log&&(f.internal=W);const ne={recordHandler:{xRcrdRead:(S,x,M,B)=>{try{const ee=T.cstrToJs(S),le=H(ee);if(!le)return-1;const _e=u(le,S,x);f?.log?.xRcrdRead&&te("xRcrdRead",ee,_e,B,le);const ae=le.storage.getItem(_e);if(ae===null)return-1;const he=ae.length;if(B<=0)return he;if(B===1)return T.poke(M,0),he;B+1<he&&K(n.SQLITE_RANGE,"xRcrdRead()",ee,_e,"input buffer is too small: need",he,"but have",B);const Ae=p.memBuffer(0),xe=T.heap8();let ve;for(ve=0;ve<he;++ve)xe[T.ptr.add(Ae,ve)]=ae.codePointAt(ve)&255;return xe.copyWithin(Number(M),Number(Ae),T.ptr.addn(Ae,ve)),xe[T.ptr.add(M,he)]=0,B}catch(ee){return y("kvrecordRead()",ee),p.setError(ee),-2}},xRcrdWrite:(S,x,M)=>{try{const B=H(S),ee=u(B,S,x),le=T.cstrToJs(M);return f?.log?.xRcrdWrite&&te("xRcrdWrite",ee,B),B.storage.setItem(ee,le),B.listeners&&fe("write",B,ee,le),0}catch(B){return y("kvrecordWrite()",B),p.setError(B,n.SQLITE_IOERR)}},xRcrdDelete:(S,x)=>{try{const M=H(S),B=u(M,S,x);return f?.log?.xRcrdDelete&&te("xRcrdDelete",B,M),M.storage.removeItem(B),M.listeners&&fe("delete",M,B),0}catch(M){return y("kvrecordDelete()",M),p.setError(M,n.SQLITE_IOERR)}}},vfs:{xOpen:function(S,x,M,B,ee){p.popError();let le;try{x||(le=T.allocCString(""+M+"."+(Math.random()*1e5|0)),x=le);const _e=T.cstrToJs(x);f?.log?.xOpen&&N("xOpen",_e,"flags =",B),E(_e,!0),B&(n.SQLITE_OPEN_MAIN_DB|n.SQLITE_OPEN_TEMP_DB|n.SQLITE_OPEN_TRANSIENT_DB)&&p.rxJournalSuffix.test(_e)&&K(n.SQLITE_ERROR,"DB files may not have a '-journal' suffix.");let ae=H(_e);!ae&&!(B&n.SQLITE_OPEN_CREATE)&&K(n.SQLITE_ERROR,"Storage not found:",_e);const he=U.vfs.xOpen(S,x,M,B,ee);if(he)return he;let Ae=!!(n.SQLITE_OPEN_DELETEONCLOSE&B);T.isPtr(arguments[1])&&n.sqlite3_uri_boolean(x,"delete-on-close",0)&&(Ae=!0);const xe=new r(M);if(F.assert(xe.$zClass,"Missing f.$zClass"),xe.addOnDispose(le),le=void 0,ae)++ae.refc,ae.files.push(xe),T.poke32(ee,B);else{T.poke32(ee,B|n.SQLITE_OPEN_CREATE),F.assert(!xe.$isJournal,"Opening a journal before its db? "+_e);const ve=_e.replace(p.rxJournalSuffix,"");ae=O(ve),q(ae),ae.files.push(xe),ae.deleteAtRefc0=Ae,f?.log?.xOpen&&N("xOpen installed storage handle [",ve,ve+"-journal","]",ae)}return w.set(M,{store:ae,file:xe,jzClass:_e}),ae.listeners&&fe("open",ae,ae.files.length),0}catch(_e){return te("xOpen:",_e),p.setError(_e)}finally{le&&T.dealloc(le)}},xDelete:function(S,x,M){p.popError();try{const B=T.cstrToJs(x);return p.rxJournalSuffix.test(B)&&P.xRcrdDelete(x,p.zKeyJrnl),0}catch(B){return te("xDelete",B),p.setError(B)}},xAccess:function(S,x,M,B){p.popError();try{const ee=H(x),le=ee?.jzClass||T.cstrToJs(x);if(f?.log?.xAccess&&N("xAccess",le,"flags =",M,"*pResOut =",T.peek32(B),"store =",ee),!ee)try{E(le)}catch{return T.poke32(B,0),0}if(ee){const _e=ee.keyPrefix+(p.rxJournalSuffix.test(le)?"jrnl":"1"),ae=ee.storage.getItem(_e)?0:1;T.poke32(B,ae)}else T.poke32(B,0);return 0}catch(ee){return y("xAccess",ee),p.setError(ee)}},xRandomness:function(S,x,M){const B=T.heap8u();let ee=0;const le=Number(M);for(;ee<x;++ee)B[le+ee]=Math.random()*255e3&255;return x},xGetLastError:function(S,x,M){const B=p.popError();if(N("xGetLastError",B),B){const ee=T.scopedAllocPush();try{const[le,_e]=T.scopedAllocCString(B.message,!0);return T.cstrncpy(M,le,x),_e>x&&T.poke8(T.ptr.add(M,x,-1),0),N("set xGetLastError",B.message),B.resultCode|0||n.SQLITE_IOERR}catch{return n.SQLITE_NOMEM}finally{T.scopedAllocPop(ee)}}return 0}},ioDb:{xClose:function(S){p.popError();try{const x=w.get(S);if(f?.log?.xClose&&N("xClose",S,x),x){w.delete(S);const M=x.store;M.files=M.files.filter(B=>B!==x.file),--M.refc<=0&&M.deleteAtRefc0&&m(M),U.ioDb.xClose(S),x.file.dispose(),M.listeners&&fe("close",M,M.files.length)}return 0}catch(x){return y("xClose",x),p.setError(x)}},xFileControl:function(S,x,M){p.popError();try{const B=w.get(S);if(F.assert(B,"Missing KVVfsFile handle"),f?.log?.xFileControl&&N("xFileControl",B,"op =",x),x===n.SQLITE_FCNTL_PRAGMA&&W.disablePageSizeChange){const le=T.peekPtr(T.ptr.add(M,T.ptr.size));if(T.cstrToJs(le)==="page_size"){f?.log?.xFileControl&&N("xFileControl pragma",T.cstrToJs(le));const _e=T.peekPtr(T.ptr.add(M,2*T.ptr.size));if(_e)return f?.log?.xFileControl&&te("xFileControl pragma",B,"NOT setting page size to",T.cstrToJs(_e)),B.file.$szPage=-1,0;if(B.file.$szPage>0)return f?.log?.xFileControl&&te("xFileControl",B,"getting page size",B.file.$szPage),T.pokePtr(M,T.allocCString(""+B.file.$szPage)),0}}const ee=U.ioDb.xFileControl(S,x,M);return ee==0&&n.SQLITE_FCNTL_SYNC===x&&B.store.listeners&&fe("sync",B.store,!1),ee}catch(B){return y("xFileControl",B),p.setError(B)}},xSync:function(S,x){p.popError();try{const M=w.get(S);f?.log?.xSync&&N("xSync",M),F.assert(M,"Missing KVVfsFile handle");const B=U.ioDb.xSync(S,x);return B==0&&M.store.listeners&&fe("sync",M.store,!0),B}catch(M){return y("xSync",M),p.setError(M)}},xRead:function(S,x,M,B){p.popError();try{if(f?.log?.xRead){const ee=w.get(S);F.assert(ee,"Missing KVVfsFile handle"),N("xRead",M,B,ee)}return U.ioDb.xRead(S,x,M,B)}catch(ee){return y("xRead",ee),p.setError(ee)}},xWrite:function(S,x,M,B){p.popError();try{if(f?.log?.xWrite){const ee=w.get(S);F.assert(ee,"Missing KVVfsFile handle"),N("xWrite",M,B,ee)}return U.ioDb.xWrite(S,x,M,B)}catch(ee){return y("xWrite",ee),p.setError(ee)}}},ioJrnl:{xClose:!0}};N("pVfs and friends",J,R,h,$,n.sqlite3_file.structInfo,r.structInfo);try{F.assert(p.buffer.n>1024*129,"Heap buffer is not large enough");for(const S of Object.entries(ne.recordHandler)){const x=S[0],M=S[1];P[x]=M,$[$.memberKey(x)]=T.installFunction($.memberSignature(x),M)}for(const S of Object.entries(ne.vfs)){const x=S[0],M=S[1],B=J.memberKey(x),ee=J.structInfo.members[x]||F.toss("Missing pVfs.structInfo[",x,"]");U.vfs[x]=T.functionEntry(J[B]),J[B]=T.installFunction(ee.signature,M)}for(const S of Object.entries(ne.ioDb)){const x=S[0],M=S[1],B=R.memberKey(x);U.ioDb[x]=T.functionEntry(R[B])||F.toss("Missing native pIoDb[",B,"]"),R[B]=T.installFunction(R.memberSignature(x),M)}for(const S of Object.entries(ne.ioJrnl)){const x=S[0],M=S[1],B=h.memberKey(x);U.ioJrnl[x]=T.functionEntry(h[B])||F.toss("Missing native pIoJrnl[",B,"]"),M===!0?h[B]=R[B]||F.toss("Missing copied pIoDb[",B,"]"):h[B]=T.installFunction(h.memberSignature(x),M)}}finally{$.dispose(),J.dispose(),R.dispose(),h.dispose()}const g=function S(x){if(x==="")return S("local")+S("session");const M=H(x);if(!M)return 0;M.files.length&&(globalThis.localStorage===M.storage||globalThis.sessionStorage===M.storage||K(n.SQLITE_ACCESS,"Cannot clear in-use database storage."));const B=M.storage,ee=[];let le,_e=B.length;for(le=0;le<_e;++le){const ae=B.key(le);(!M.keyPrefix||ae.startsWith(M.keyPrefix))&&ee.push(ae)}return ee.forEach(ae=>B.removeItem(ae)),ee.length},L=function S(x){if(x==="")return S("local")+S("session");const M=H(x);if(!M)return 0;const B=M.storage;let ee,le=0;for(ee=0;ee<B.length;++ee){const _e=B.key(ee);(!M.keyPrefix||_e.startsWith(M.keyPrefix))&&(le+=_e.length,le+=B.getItem(_e).length)}return le*2},V=function(...x){let M;x.length===1&&typeof x[0]=="object"?M=x[0]:x.length&&(M=Object.assign(Object.create(null),{name:x[0]}));const B=M?H(M.name):null;B||K(n.SQLITE_NOTFOUND,"There is no kvvfs storage named",M?.name);const ee=B.storage,le=Object.assign(Object.create(null),{name:B.jzClass,timestamp:Date.now(),pages:[]}),_e=Object.create(null),ae=B.keyPrefix,he=ae?/^kvvfs-[^-]+-(\w+)/:void 0;let Ae=0,xe=ee.length;for(;Ae<xe;++Ae){const ve=ee.key(Ae);if(!ae||ve.startsWith(ae)){let Me=(ae?he.exec(ve):void 0)?.[1]??ve;switch(Me){case"jrnl":M.includeJournal&&(le.journal=ee.getItem(ve));break;case"sz":le.size=+ee.getItem(ve);break;default:if(Me=+Me,(!F.isInt32(Me)||Me<=0)&&K(n.SQLITE_RANGE,"Malformed kvvfs key: "+ve),M.decodePages){const Xe=ee.getItem(ve),at=Xe.length,Ge=p.memBuffer(0),bt=p.memBuffer(1),Je=T.heap8u();let tt=0;for(;tt<at;++tt)Je[T.ptr.add(Ge,tt)]=Xe.codePointAt(tt)&255;Je[T.ptr.add(Ge,tt)]=0;const St=ge(Ge,bt,p.buffer.n);_e[Me]=Je.slice(Number(bt),T.ptr.addn(bt,St))}else _e[Me]=ee.getItem(ve);break}}}return M.decodePages&&p.memBufferFree(1),Object.keys(_e).map(ve=>+ve).sort().forEach(ve=>le.pages.push(_e[ve])),le},re=function(S,x=!1){!S?.timestamp||!S.name||S.size===void 0||!Array.isArray(S.pages)?K(n.SQLITE_MISUSE,"Malformed export object."):(!S.size||S.size!==(S.size|0)||S.size>=2147483647)&&K(n.SQLITE_RANGE,"Invalid db size: "+S.size),E(S.name);let M=H(S.name);const B=!M;M?(x?!M.files||!M.jzClass?K(n.SQLITE_ERROR,"Internal storage object",S.name,"seems to be malformed."):M.files.length&&K(n.SQLITE_IOERR_ACCESS,"Cannot import db storage while it is in use."):K(n.SQLITE_ACCESS,"Storage '"+S.name+"' already exists and","overwrite was not specified."),g(S.name)):M=O(S.name);const ee=Q(S.name);let le;try{const _e=M.storage;_e.setItem(ee+"sz",S.size),S.journal&&_e.setItem(ee+"jrnl",S.journal),S.pages[0]instanceof Uint8Array?S.pages.forEach((ae,he)=>{const Ae=ae.length;le??=p.memBuffer(1);const xe=p.memBuffer(0),ve=T.heap8u();ve.set(ae,Number(xe)),ve[T.ptr.addn(xe,Ae)]=0;const Me=ye(xe,Ae,le);F.assert(Me<p.buffer.n,"Impossibly long output - possibly smashed the heap"),F.assert(T.peek8(T.ptr.add(le,Me))===0,"Expecting NUL-terminated encoded output");const Xe=T.cstrToJs(le);_e.setItem(ee+(he+1),Xe)}):S.pages[0]&&S.pages.forEach((ae,he)=>_e.setItem(ee+(he+1),ae)),B&&q(M)}catch{if(!B)try{g(S.name)}catch{}}finally{le&&p.memBufferFree(1)}return this},Z=function(S){let x=H(S);if(x){++x.refc;return}E(S),q(O(S))},ce=function(S){const x=H(S);return!x||D(x.jzClass)||Y(x.jzClass)||p.rxJournalSuffix.test(S)?!1:x.refc>x.files.length||x.files.length===0?(--x.refc<=0&&m(x),!0):!1},qe=function(S){(!S||typeof S!="object")&&K(n.SQLITE_MISUSE,"Expecting a listener object.");let x=H(S.storage);x||(S.storage&&S.reserve?(Z(S.storage),x=H(S.storage),F.assert(x,"Unexpectedly cannot fetch reserved storage "+S.storage)):K(n.SQLITE_NOTFOUND,"No such storage:",S.storage)),S.events&&(x.listeners??=[]).push(S)},ue=function(S){const x=H(S?.storage);if(x?.listeners&&S.events){const M=x.listeners.length;x.listeners=x.listeners.filter(ee=>ee!==S);const B=M>x.listeners.length;return x.listeners.length||(x.listeners=void 0),B}return!1};if(s.kvvfs.reserve=Z,s.kvvfs.import=re,s.kvvfs.export=V,s.kvvfs.unlink=ce,s.kvvfs.listen=qe,s.kvvfs.unlisten=ue,s.kvvfs.exists=S=>!!H(S),s.kvvfs.estimateSize=L,s.kvvfs.clear=g,globalThis.Storage&&(n.sqlite3_js_kvvfs_size=(S="")=>L(S),n.sqlite3_js_kvvfs_clear=(S="")=>g(S)),s.oo1?.DB){const S=s.oo1.DB;s.oo1.JsStorageDb=function(M=s.oo1.JsStorageDb.defaultStorageName){const B=S.dbCtorHelper.normalizeArgs(...arguments);switch(B.vfs="kvvfs",B.filename){case":sessionStorage:":B.filename="session";break;case":localStorage:":B.filename="local";break}const ee=/(file:(\/\/)?)([^?]+)/.exec(B.filename);E(ee?ee[3]:B.filename),S.dbCtorHelper.call(this,B)},s.oo1.JsStorageDb.defaultStorageName=p.storagePool.session?"session":j;const x=s.oo1.JsStorageDb;x.prototype=Object.create(S.prototype),x.clearStorage=g,x.prototype.clearStorage=function(){return x.clearStorage(this.affirmOpen().dbFilename(),!0)},x.storageSize=L,x.prototype.storageSize=function(){return x.storageSize(this.affirmOpen().dbFilename(),!0)}}if(s.__isUnderTest&&s.vtab){const S=Object.assign(Object.create(null),{rowid:{type:"INTEGER"},name:{type:"TEXT"},nRef:{type:"INTEGER"},nOpen:{type:"INTEGER"},isTransient:{type:"INTEGER"},dbSize:{type:"INTEGER"}});Object.keys(S).forEach((_e,ae)=>S[_e].colId=ae);const x=s.vtab,M=Object.assign(Object.create(null),{row:function(){return p.storagePool[this.names[this.rowid]]}});Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(_e=>!p.rxJournalSuffix.test(_e))});const B=function(_e,ae){const he=_e instanceof n.sqlite3_vtab_cursor?_e:x.xCursor.get(_e);return(ae||!he.vTabState)&&(he.vTabState=Object.assign(Object.create(M),{rowid:0,names:Object.keys(p.storagePool).filter(Ae=>!p.rxJournalSuffix.test(Ae))})),he.vTabState},ee=()=>{},le=function _e(){return _e.mod??=new s.capi.sqlite3_module().setupModule({catchExceptions:!0,methods:{xConnect:function(ae,he,Ae,xe,ve,Me){try{const Xe=[];Object.keys(S).forEach(Ge=>{Xe.push(Ge+" "+S[Ge].type)});const at=n.sqlite3_declare_vtab(ae,"CREATE TABLE ignored("+Xe.join(",")+")");if(at===0){const Ge=x.xVtab.create(ve);F.assert(Ge===x.xVtab.get(T.peekPtr(ve)),"output pointer check failed")}return at}catch(Xe){return x.xErrror("xConnect",Xe,n.SQLITE_ERROR)}},xCreate:T.ptr.null,xDisconnect:function(ae){return x.xVtab.dispose(ae),0},xOpen:function(ae,he){return x.xCursor.create(he),0},xClose:function(ae){const he=x.xCursor.unget(ae);return delete he.vTabState,he.dispose(),0},xNext:function(ae){const he=x.xCursor.get(ae);return++B(he).rowid,0},xColumn:function(ae,he,Ae){const xe=B(ae),ve=xe.row();switch(F.assert(ve,"Unexpected xColumn call"),Ae){case S.rowid.colId:n.sqlite3_result_int(he,xe.rowid);break;case S.name.colId:n.sqlite3_result_text(he,ve.jzClass,-1,n.SQLITE_TRANSIENT);break;case S.nRef.colId:n.sqlite3_result_int(he,ve.refc);break;case S.nOpen.colId:n.sqlite3_result_int(he,ve.files.length);break;case S.isTransient.colId:n.sqlite3_result_int(he,!!ve.deleteAtRefc0);break;case S.dbSize.colId:n.sqlite3_result_int(he,d(ve));break;default:return n.sqlite3_result_error(he,"Invalid column id: "+Ae),n.SQLITE_RANGE}return 0},xRowid:function(ae,he){const Ae=B(ae);return x.xRowid(he,Ae.rowid),0},xEof:function(ae){const he=B(ae);return ee("xEof?="+!he.row(),...arguments),!he.row()},xFilter:function(ae,he,Ae,xe,ve){return B(ae,!0),0},xBestIndex:function(ae,he){const Ae=new n.sqlite3_index_info(he);return Ae.$estimatedRows=p.storagePool.size,Ae.$estimatedCost=1,Ae.dispose(),0}}})};s.kvvfs.create_module=function(_e,ae="sqlite_kvvfs"){return n.sqlite3_create_module(_e,ae,le(),T.ptr.null)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=function i(r){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory)return Promise.reject(new Error("Missing required OPFS APIs."));(!r||typeof r!="object")&&(r=Object.create(null));const c=new URL(globalThis.location.href).searchParams;return c.has("opfs-disable")?Promise.resolve(s):(r.verbose===void 0&&(r.verbose=c.has("opfs-verbose")?+c.get("opfs-verbose")||2:1),r.sanityChecks===void 0&&(r.sanityChecks=c.has("opfs-sanity-check")),r.proxyUri===void 0&&(r.proxyUri=i.defaultProxyUri),typeof r.proxyUri=="function"&&(r.proxyUri=r.proxyUri()),new Promise(function(F,T){const K=[s.config.error,s.config.warn,s.config.log],C=(g,...L)=>{r.verbose>g&&K[g]("OPFS syncer:",...L)},$=(...g)=>C(2,...g),p=(...g)=>C(1,...g),z=(...g)=>C(0,...g),N=s.util.toss,te=s.capi,y=s.util,b=s.wasm,D=te.sqlite3_vfs,Q=te.sqlite3_file,E=te.sqlite3_io_methods,O=Object.create(null),f=()=>globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory;O.metrics={dump:function(){let g,L=0,V=0,re=0;for(g in H.opIds){const Z=A[g];L+=Z.count,V+=Z.time,re+=Z.wait,Z.avgTime=Z.count&&Z.time?Z.time/Z.count:0,Z.avgWait=Z.count&&Z.wait?Z.wait/Z.count:0}s.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",A,`
Total of`,L,"op(s) for",V,"ms (incl. "+re+" ms of waiting on the async side)"),s.config.log("Serialization metrics:",A.s11n),ge.postMessage({type:"opfs-async-metrics"})},reset:function(){let g;const L=re=>re.count=re.time=re.wait=0;for(g in H.opIds)L(A[g]=Object.create(null));let V=A.s11n=Object.create(null);V=V.serialize=Object.create(null),V.count=V.time=0,V=A.s11n.deserialize=Object.create(null),V.count=V.time=0}};const m=new E,q=new D().addOnDispose(()=>m.dispose());let j;const Y=g=>(j=!0,q.dispose(),T(g)),oe=()=>(j=!1,F(s)),ge=new Worker(new URL("/assets/sqlite3-opfs-async-proxy--d6widYe.js",import.meta.url));setTimeout(()=>{j===void 0&&Y(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),ge._originalOnError=ge.onerror,ge.onerror=function(g){z("Error initializing OPFS asyncer:",g),Y(new Error("Loading OPFS async Worker failed for unknown reasons."))};const ye=te.sqlite3_vfs_find(null),fe=ye?new D(ye):null;m.$iVersion=1,q.$iVersion=2,q.$szOsFile=te.sqlite3_file.structInfo.sizeof,q.$mxPathname=1024,q.$zName=b.allocCString("opfs"),q.$xDlOpen=q.$xDlError=q.$xDlSym=q.$xDlClose=null,q.addOnDispose("$zName",q.$zName,"cleanup default VFS wrapper",()=>fe?fe.dispose():null);const H=Object.create(null);H.verbose=r.verbose,H.littleEndian=(()=>{const g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256})(),H.asyncIdleWaitTime=150,H.asyncS11nExceptions=1,H.fileBufferSize=65536,H.sabS11nOffset=H.fileBufferSize,H.sabS11nSize=q.$mxPathname*2,H.sabIO=new SharedArrayBuffer(H.fileBufferSize+H.sabS11nSize),H.opIds=Object.create(null);const A=Object.create(null);{let g=0;H.opIds.whichOp=g++,H.opIds.rc=g++,H.opIds.xAccess=g++,H.opIds.xClose=g++,H.opIds.xDelete=g++,H.opIds.xDeleteNoWait=g++,H.opIds.xFileSize=g++,H.opIds.xLock=g++,H.opIds.xOpen=g++,H.opIds.xRead=g++,H.opIds.xSleep=g++,H.opIds.xSync=g++,H.opIds.xTruncate=g++,H.opIds.xUnlock=g++,H.opIds.xWrite=g++,H.opIds.mkdir=g++,H.opIds["opfs-async-metrics"]=g++,H.opIds["opfs-async-shutdown"]=g++,H.opIds.retry=g++,H.sabOP=new SharedArrayBuffer(g*4),O.metrics.reset()}H.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(g=>{(H.sq3Codes[g]=te[g])===void 0&&N("Maintenance required: not found:",g)}),H.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const l=(g,...L)=>{const V=H.opIds[g]||N("Invalid op ID:",g);H.s11n.serialize(...L),Atomics.store(H.sabOPView,H.opIds.rc,-1),Atomics.store(H.sabOPView,H.opIds.whichOp,V),Atomics.notify(H.sabOPView,H.opIds.whichOp);const re=performance.now();for(;Atomics.wait(H.sabOPView,H.opIds.rc,-1)!=="not-equal";);const Z=Atomics.load(H.sabOPView,H.opIds.rc);if(A[g].wait+=performance.now()-re,Z&&H.asyncS11nExceptions){const ce=H.s11n.deserialize();ce&&z(g+"() async error:",...ce)}return Z};O.debug={asyncShutdown:()=>{p("Shutting down OPFS async listener. The OPFS VFS will no longer work."),l("opfs-async-shutdown")},asyncRestart:()=>{p("Attempting to restart OPFS VFS async listener. Might work, might not."),ge.postMessage({type:"opfs-async-restart"})}};const u=()=>{if(H.s11n)return H.s11n;const g=new TextDecoder,L=new TextEncoder("utf-8"),V=new Uint8Array(H.sabIO,H.sabS11nOffset,H.sabS11nSize),re=new DataView(H.sabIO,H.sabS11nOffset,H.sabS11nSize);H.s11n=Object.create(null);const Z=Object.create(null);Z.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},Z.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},Z.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},Z.string={id:4};const ce=ue=>Z[typeof ue]||N("Maintenance required: this value type cannot be serialized.",ue),qe=ue=>{switch(ue){case Z.number.id:return Z.number;case Z.bigint.id:return Z.bigint;case Z.boolean.id:return Z.boolean;case Z.string.id:return Z.string;default:N("Invalid type ID:",ue)}};return H.s11n.deserialize=function(ue=!1){++A.s11n.deserialize.count;const S=performance.now(),x=V[0],M=x?[]:null;if(x){const B=[];let ee=1,le,_e,ae;for(le=0;le<x;++le,++ee)B.push(qe(V[ee]));for(le=0;le<x;++le){const he=B[le];he.getter?(ae=re[he.getter](ee,H.littleEndian),ee+=he.size):(_e=re.getInt32(ee,H.littleEndian),ee+=4,ae=g.decode(V.slice(ee,ee+_e)),ee+=_e),M.push(ae)}}return ue&&(V[0]=0),A.s11n.deserialize.time+=performance.now()-S,M},H.s11n.serialize=function(...ue){const S=performance.now();if(++A.s11n.serialize.count,ue.length){const x=[];let M=0,B=1;for(V[0]=ue.length&255;M<ue.length;++M,++B)x.push(ce(ue[M])),V[B]=x[M].id;for(M=0;M<ue.length;++M){const ee=x[M];if(ee.setter)re[ee.setter](B,ue[M],H.littleEndian),B+=ee.size;else{const le=L.encode(ue[M]);re.setInt32(B,le.byteLength,H.littleEndian),B+=4,V.set(le,B),B+=le.byteLength}}}else V[0]=0;A.s11n.serialize.time+=performance.now()-S},H.s11n},d=function g(L=16){g._chars||(g._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",g._n=g._chars.length);const V=[];let re=0;for(;re<L;++re){const Z=Math.random()*(g._n*64)%g._n|0;V[re]=g._chars[Z]}return V.join("")},w=Object.create(null),U=Object.create(null);U.op=void 0,U.start=void 0;const J=g=>{U.start=performance.now(),U.op=g,++A[g].count},R=()=>A[U.op].time+=performance.now()-U.start,h={xCheckReservedLock:function(g,L){return b.poke(L,0,"i32"),0},xClose:function(g){J("xClose");let L=0;const V=w[g];return V&&(delete w[g],L=l("xClose",g),V.sq3File&&V.sq3File.dispose()),R(),L},xDeviceCharacteristics:function(g){return te.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(g,L,V){return te.SQLITE_NOTFOUND},xFileSize:function(g,L){J("xFileSize");let V=l("xFileSize",g);if(V==0)try{const re=H.s11n.deserialize()[0];b.poke(L,re,"i64")}catch(re){z("Unexpected error reading xFileSize() result:",re),V=H.sq3Codes.SQLITE_IOERR}return R(),V},xLock:function(g,L){J("xLock");const V=w[g];let re=0;return V.lockType?V.lockType=L:(re=l("xLock",g,L),re===0&&(V.lockType=L)),R(),re},xRead:function(g,L,V,re){J("xRead");const Z=w[g];let ce;try{ce=l("xRead",g,V,Number(re)),(ce===0||te.SQLITE_IOERR_SHORT_READ===ce)&&b.heap8u().set(Z.sabView.subarray(0,V),Number(L))}catch(qe){z("xRead(",arguments,") failed:",qe,Z),ce=te.SQLITE_IOERR_READ}return R(),ce},xSync:function(g,L){J("xSync"),++A.xSync.count;const V=l("xSync",g,L);return R(),V},xTruncate:function(g,L){J("xTruncate");const V=l("xTruncate",g,Number(L));return R(),V},xUnlock:function(g,L){J("xUnlock");const V=w[g];let re=0;return te.SQLITE_LOCK_NONE===L&&V.lockType&&(re=l("xUnlock",g,L)),re===0&&(V.lockType=L),R(),re},xWrite:function(g,L,V,re){J("xWrite");const Z=w[g];let ce;try{Z.sabView.set(b.heap8u().subarray(Number(L),Number(L)+V)),ce=l("xWrite",g,V,Number(re))}catch(qe){z("xWrite(",arguments,") failed:",qe,Z),ce=te.SQLITE_IOERR_WRITE}return R(),ce}},P={xAccess:function(g,L,V,re){J("xAccess");const Z=l("xAccess",b.cstrToJs(L));return b.poke(re,Z?0:1,"i32"),R(),0},xCurrentTime:function(g,L){return b.poke(L,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(g,L){return b.poke(L,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(g,L,V){J("xDelete");const re=l("xDelete",b.cstrToJs(L),V,!1);return R(),re},xFullPathname:function(g,L,V,re){return b.cstrncpy(re,L,V)<V?0:te.SQLITE_CANTOPEN},xGetLastError:function(g,L,V){return p("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(L,V,re,Z,ce){J("xOpen");let qe=0;V===0?V=d():b.isPtr(V)&&(te.sqlite3_uri_boolean(V,"opfs-unlock-asap",0)&&(qe|=H.opfsFlags.OPFS_UNLOCK_ASAP),te.sqlite3_uri_boolean(V,"delete-before-open",0)&&(qe|=H.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),V=b.cstrToJs(V));const ue=Object.create(null);ue.fid=re,ue.filename=V,ue.sab=new SharedArrayBuffer(H.fileBufferSize),ue.flags=Z,ue.readOnly=!(te.SQLITE_OPEN_CREATE&Z)&&!!(Z&te.SQLITE_OPEN_READONLY);const S=l("xOpen",re,V,Z,qe);return S||(ue.readOnly&&b.poke(ce,te.SQLITE_OPEN_READONLY,"i32"),w[re]=ue,ue.sabView=H.sabFileBufView,ue.sq3File=new Q(re),ue.sq3File.$pMethods=m.pointer,ue.lockType=te.SQLITE_LOCK_NONE),R(),S}};fe&&(q.$xRandomness=fe.$xRandomness,q.$xSleep=fe.$xSleep),q.$xRandomness||(P.xRandomness=function(g,L,V){const re=b.heap8u();let Z=0;const ce=Number(V);for(;Z<L;++Z)re[ce+Z]=Math.random()*255e3&255;return Z}),q.$xSleep||(P.xSleep=function(g,L){return Atomics.wait(H.sabOPView,H.opIds.xSleep,0,L),0}),O.getResolvedPath=function(g,L){const V=new URL(g,"file://irrelevant").pathname;return L?V.split("/").filter(re=>!!re):V},O.getDirForFilename=async function(L,V=!1){const re=O.getResolvedPath(L,!0),Z=re.pop();let ce=O.rootDirectory;for(const qe of re)qe&&(ce=await ce.getDirectoryHandle(qe,{create:!!V}));return[ce,Z]},O.mkdir=async function(g){try{return await O.getDirForFilename(g+"/filepart",!0),!0}catch{return!1}},O.entryExists=async function(g){try{const[L,V]=await O.getDirForFilename(g);return await L.getFileHandle(V),!0}catch{return!1}},O.randomFilename=d,O.treeList=async function(){const g=async function V(re,Z){Z.name=re.name,Z.dirs=[],Z.files=[];for await(const ce of re.values())if(ce.kind==="directory"){const qe=Object.create(null);Z.dirs.push(qe),await V(ce,qe)}else Z.files.push(ce.name)},L=Object.create(null);return await g(O.rootDirectory,L),L},O.rmfr=async function(){const g=O.rootDirectory,L={recurse:!0};for await(const V of g.values())g.removeEntry(V.name,L)},O.unlink=async function(g,L=!1,V=!1){try{const[re,Z]=await O.getDirForFilename(g,!1);return await re.removeEntry(Z,{recursive:L}),!0}catch(re){if(V)throw new Error("unlink(",arguments[0],") failed: "+re.message,{cause:re});return!1}},O.traverse=async function(g){const L={recursive:!0,directory:O.rootDirectory};typeof g=="function"&&(g={callback:g}),g=Object.assign(L,g||{}),(async function V(re,Z){for await(const ce of re.values()){if(g.callback(ce,re,Z)===!1)return!1;if(g.recursive&&ce.kind==="directory"&&await V(ce,Z+1)===!1)break}})(g.directory,0)};const W=async function(g,L){const[V,re]=await O.getDirForFilename(g,!0);let Z=await(await V.getFileHandle(re,{create:!0})).createSyncAccessHandle(),ce=0,qe,ue=!1;try{for(Z.truncate(0);(qe=await L())!==void 0;)qe instanceof ArrayBuffer&&(qe=new Uint8Array(qe)),!ue&&ce===0&&qe.byteLength>=15&&(y.affirmDbHeader(qe),ue=!0),Z.write(qe,{at:ce}),ce+=qe.byteLength;if((ce<512||ce%512!==0)&&N("Input size",ce,"is not correct for an SQLite database."),!ue){const S=new Uint8Array(20);Z.read(S,{at:0}),y.affirmDbHeader(S)}return Z.write(new Uint8Array([1,1]),{at:18}),ce}catch(S){throw await Z.close(),Z=void 0,await V.removeEntry(re).catch(()=>{}),S}finally{Z&&await Z.close()}};if(O.importDb=async function(g,L){if(L instanceof Function)return W(g,L);L instanceof ArrayBuffer&&(L=new Uint8Array(L)),y.affirmIsDb(L);const V=L.byteLength,[re,Z]=await O.getDirForFilename(g,!0);let ce,qe=0;try{return ce=await(await re.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),ce.truncate(0),qe=ce.write(L,{at:0}),qe!=V&&N("Expected to write "+V+" bytes but wrote "+qe+"."),ce.write(new Uint8Array([1,1]),{at:18}),qe}catch(ue){throw ce&&(await ce.close(),ce=void 0),await re.removeEntry(Z).catch(()=>{}),ue}finally{ce&&await ce.close()}},s.oo1){const g=function(...L){const V=s.oo1.DB.dbCtorHelper.normalizeArgs(...L);V.vfs=q.$zName,s.oo1.DB.dbCtorHelper.call(this,V)};g.prototype=Object.create(s.oo1.DB.prototype),s.oo1.OpfsDb=g,g.importDb=O.importDb,s.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(q.pointer,function(L,V){V.capi.sqlite3_busy_timeout(L,1e4)})}const ne=function(){const g=b.scopedAllocPush(),L=new Q;try{const V=L.pointer,re=te.SQLITE_OPEN_CREATE|te.SQLITE_OPEN_READWRITE|te.SQLITE_OPEN_MAIN_DB,Z=b.scopedAlloc(8),ce="/sanity/check/file"+d(8),qe=b.scopedAllocCString(ce);let ue;if(H.s11n.serialize("This is  string."),ue=H.s11n.deserialize(),$("deserialize() says:",ue),ue[0]!=="This is  string."&&N("String d13n error."),P.xAccess(q.pointer,qe,0,Z),ue=b.peek(Z,"i32"),$("xAccess(",ce,") exists ?=",ue),ue=P.xOpen(q.pointer,qe,V,re,Z),$("open rc =",ue,"state.sabOPView[xOpen] =",H.sabOPView[H.opIds.xOpen]),ue!==0){z("open failed with code",ue);return}P.xAccess(q.pointer,qe,0,Z),ue=b.peek(Z,"i32"),ue||N("xAccess() failed to detect file."),ue=h.xSync(L.pointer,0),ue&&N("sync failed w/ rc",ue),ue=h.xTruncate(L.pointer,1024),ue&&N("truncate failed w/ rc",ue),b.poke(Z,0,"i64"),ue=h.xFileSize(L.pointer,Z),ue&&N("xFileSize failed w/ rc",ue),$("xFileSize says:",b.peek(Z,"i64")),ue=h.xWrite(L.pointer,qe,10,1),ue&&N("xWrite() failed!");const S=b.scopedAlloc(16);ue=h.xRead(L.pointer,S,6,2),b.poke(S+6,0);let x=b.cstrToJs(S);$("xRead() got:",x),x!=="sanity"&&N("Unexpected xRead() value."),P.xSleep&&($("xSleep()ing before close()ing..."),P.xSleep(q.pointer,2e3),$("waking up from xSleep()")),ue=h.xClose(V),$("xClose rc =",ue,"sabOPView =",H.sabOPView),$("Deleting file:",ce),P.xDelete(q.pointer,qe,4660),P.xAccess(q.pointer,qe,0,Z),ue=b.peek(Z,"i32"),ue&&N("Expecting 0 from xAccess(",ce,") after xDelete()."),p("End of OPFS sanity checks.")}finally{L.dispose(),b.scopedAllocPop(g)}};ge.onmessage=function({data:g}){switch(g.type){case"opfs-unavailable":Y(new Error(g.payload.join(" ")));break;case"opfs-async-loaded":ge.postMessage({type:"opfs-async-init",args:H});break;case"opfs-async-inited":if(j===!0)break;try{s.vfs.installVfs({io:{struct:m,methods:h},vfs:{struct:q,methods:P}}),H.sabOPView=new Int32Array(H.sabOP),H.sabFileBufView=new Uint8Array(H.sabIO,0,H.fileBufferSize),H.sabS11nView=new Uint8Array(H.sabIO,H.sabS11nOffset,H.sabS11nSize),u(),r.sanityChecks&&(p("Running sanity checks because of opfs-sanity-check URL arg..."),ne()),f()?navigator.storage.getDirectory().then(L=>{ge.onerror=ge._originalOnError,delete ge._originalOnError,s.opfs=O,O.rootDirectory=L,$("End of OPFS sqlite3_vfs setup.",q),oe()}).catch(Y):oe()}catch(L){z(L),Y(L)}break;default:{const L="Unexpected message from the OPFS async worker: "+JSON.stringify(g);z(L),Y(new Error(L));break}}}}))};n.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async i=>{try{let r=n.defaultProxyUri;return i?.scriptInfo?.sqlite3Dir&&(n.defaultProxyUri=i.scriptInfo.sqlite3Dir+r),n().catch(c=>{i.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",c.message)})}catch(r){return i.config.error("installOpfsVfs() exception:",r),Promise.reject(r)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const n=s.util.toss,i=s.util.toss3,r=Object.create(null),c=s.capi,F=s.util,T=s.wasm,K=4096,C=512,$=4,p=8,z=C+$,N=C,te=z,y=K,b=c.SQLITE_OPEN_MAIN_DB|c.SQLITE_OPEN_MAIN_JOURNAL|c.SQLITE_OPEN_SUPER_JOURNAL|c.SQLITE_OPEN_WAL,D=c.SQLITE_OPEN_MEMORY,Q=".opaque",E=()=>Math.random().toString(36).slice(2),O=new TextDecoder,f=new TextEncoder,m=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),q=[s.config.error,s.config.warn,s.config.log];s.config.log;const j=s.config.warn;s.config.error;const Y=new Map,oe=R=>Y.get(R),ge=(R,h)=>{h?Y.set(R,h):Y.delete(R)},ye=new Map,fe=R=>ye.get(R),H=(R,h)=>{h?ye.set(R,h):ye.delete(R)},A={xCheckReservedLock:function(R,h){const P=fe(R);return P.log("xCheckReservedLock"),P.storeErr(),T.poke32(h,1),0},xClose:function(R){const h=fe(R);h.storeErr();const P=h.getOFileForS3File(R);if(P)try{h.log(`xClose ${P.path}`),h.mapS3FileToOFile(R,!1),P.sah.flush(),P.flags&c.SQLITE_OPEN_DELETEONCLOSE&&h.deletePath(P.path)}catch(W){return h.storeErr(W,c.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(R){return c.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(R,h,P){return c.SQLITE_NOTFOUND},xFileSize:function(R,h){const P=fe(R);P.log("xFileSize");const W=P.getOFileForS3File(R).sah.getSize()-y;return T.poke64(h,BigInt(W)),0},xLock:function(R,h){const P=fe(R);P.log(`xLock ${h}`),P.storeErr();const W=P.getOFileForS3File(R);return W.lockType=h,0},xRead:function(R,h,P,W){const ne=fe(R);ne.storeErr();const g=ne.getOFileForS3File(R);ne.log(`xRead ${g.path} ${P} @ ${W}`);try{const L=g.sah.read(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(W)});return L<P?(T.heap8u().fill(0,Number(h)+L,Number(h)+P),c.SQLITE_IOERR_SHORT_READ):0}catch(L){return ne.storeErr(L,c.SQLITE_IOERR)}},xSectorSize:function(R){return K},xSync:function(R,h){const P=fe(R);P.log(`xSync ${h}`),P.storeErr();const W=P.getOFileForS3File(R);try{return W.sah.flush(),0}catch(ne){return P.storeErr(ne,c.SQLITE_IOERR)}},xTruncate:function(R,h){const P=fe(R);P.log(`xTruncate ${h}`),P.storeErr();const W=P.getOFileForS3File(R);try{return W.sah.truncate(y+Number(h)),0}catch(ne){return P.storeErr(ne,c.SQLITE_IOERR)}},xUnlock:function(R,h){const P=fe(R);P.log("xUnlock");const W=P.getOFileForS3File(R);return W.lockType=h,0},xWrite:function(R,h,P,W){const ne=fe(R);ne.storeErr();const g=ne.getOFileForS3File(R);ne.log(`xWrite ${g.path} ${P} ${W}`);try{return P===g.sah.write(T.heap8u().subarray(Number(h),Number(h)+P),{at:y+Number(W)})?0:n("Unknown write() failure.")}catch(L){return ne.storeErr(L,c.SQLITE_IOERR)}}},l=new c.sqlite3_io_methods;l.$iVersion=1,s.vfs.installVfs({io:{struct:l,methods:A}});const u={xAccess:function(R,h,P,W){const ne=oe(R);ne.storeErr();try{const g=ne.getPath(h);T.poke32(W,ne.hasFilename(g)?1:0)}catch{T.poke32(W,0)}return 0},xCurrentTime:function(R,h){return T.poke(h,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(R,h){return T.poke(h,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(R,h,P){const W=oe(R);W.log(`xDelete ${T.cstrToJs(h)}`),W.storeErr();try{return W.deletePath(W.getPath(h)),0}catch(ne){return W.storeErr(ne),c.SQLITE_IOERR_DELETE}},xFullPathname:function(R,h,P,W){return T.cstrncpy(W,h,P)<P?0:c.SQLITE_CANTOPEN},xGetLastError:function(R,h,P){const W=oe(R),ne=W.popErr();if(W.log(`xGetLastError ${h} e =`,ne),ne){const g=T.scopedAllocPush();try{const[L,V]=T.scopedAllocCString(ne.message,!0);T.cstrncpy(P,L,h),V>h&&T.poke8(T.ptr.add(P,h,-1),0)}catch{return c.SQLITE_NOMEM}finally{T.scopedAllocPop(g)}}return ne?ne.sqlite3Rc||c.SQLITE_IOERR:0},xOpen:function(h,P,W,ne,g){const L=oe(h);try{ne&=~D,L.log(`xOpen ${T.cstrToJs(P)} ${ne}`);const V=P&&T.peek8(P)?L.getPath(P):E();let re=L.getSAHForPath(V);!re&&ne&c.SQLITE_OPEN_CREATE&&(L.getFileCount()<L.getCapacity()?(re=L.nextAvailableSAH(),L.setAssociatedPath(re,V,ne)):n("SAH pool is full. Cannot create file",V)),re||n("file not found:",V);const Z={path:V,flags:ne,sah:re};L.mapS3FileToOFile(W,Z),Z.lockType=c.SQLITE_LOCK_NONE;const ce=new c.sqlite3_file(W);return ce.$pMethods=l.pointer,ce.dispose(),T.poke32(g,ne),0}catch(V){return L.storeErr(V),c.SQLITE_CANTOPEN}}},d=function(R){s.capi.sqlite3_vfs_find(R)&&i("VFS name is already registered:",R);const h=new c.sqlite3_vfs,P=c.sqlite3_vfs_find(null),W=P?new c.sqlite3_vfs(P):null;return h.$iVersion=2,h.$szOsFile=c.sqlite3_file.structInfo.sizeof,h.$mxPathname=C,h.addOnDispose(h.$zName=T.allocCString(R),()=>ge(h.pointer,0)),W&&(h.$xRandomness=W.$xRandomness,h.$xSleep=W.$xSleep,W.dispose()),!h.$xRandomness&&!u.xRandomness&&(u.xRandomness=function(ne,g,L){const V=T.heap8u();let re=0;const Z=Number(L);for(;re<g;++re)V[Z+re]=Math.random()*255e3&255;return re}),!h.$xSleep&&!u.xSleep&&(u.xSleep=(ne,g)=>0),s.vfs.installVfs({vfs:{struct:h,methods:u}}),h};class w{vfsDir;#e;#r;#l;#i=new Map;#t=new Map;#s=new Set;#a=new Map;#n=new Uint8Array(z);#c;#o;#_;constructor(h=Object.create(null)){this.#_=h.verbosity??m.verbosity,this.vfsName=h.name||m.name,this.#o=d(this.vfsName),ge(this.#o.pointer,this),this.vfsDir=h.directory||"."+this.vfsName,this.#c=new DataView(this.#n.buffer,this.#n.byteOffset),this.isReady=this.reset(!!(h.clearOnInit??m.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(h.initialCapacity||m.initialCapacity)})}#u(h,...P){this.#_>h&&q[h](this.vfsName+":",...P)}log(...h){this.#u(2,...h)}warn(...h){this.#u(1,...h)}error(...h){this.#u(0,...h)}getVfs(){return this.#o}getCapacity(){return this.#i.size}getFileCount(){return this.#t.size}getFileNames(){const h=[];for(const P of this.#t.keys())h.push(P);return h}async addCapacity(h){for(let P=0;P<h;++P){const W=E(),ne=await(await this.#r.getFileHandle(W,{create:!0})).createSyncAccessHandle();this.#i.set(ne,W),this.setAssociatedPath(ne,"",0)}return this.getCapacity()}async reduceCapacity(h){let P=0;for(const W of Array.from(this.#s)){if(P===h||this.getFileCount()===this.getCapacity())break;const ne=this.#i.get(W);W.close(),await this.#r.removeEntry(ne),this.#i.delete(W),this.#s.delete(W),++P}return P}releaseAccessHandles(){for(const h of this.#i.keys())h.close();this.#i.clear(),this.#t.clear(),this.#s.clear()}async acquireAccessHandles(h=!1){const P=[];for await(const[W,ne]of this.#r)ne.kind==="file"&&P.push([W,ne]);return Promise.all(P.map(async([W,ne])=>{try{const g=await ne.createSyncAccessHandle();if(this.#i.set(g,W),h)g.truncate(y),this.setAssociatedPath(g,"",0);else{const L=this.getAssociatedPath(g);L?this.#t.set(L,g):this.#s.add(g)}}catch(g){throw this.storeErr(g),this.releaseAccessHandles(),g}}))}getAssociatedPath(h){h.read(this.#n,{at:0});const P=this.#c.getUint32(N);if(this.#n[0]&&(P&c.SQLITE_OPEN_DELETEONCLOSE||(P&b)===0))return j(`Removing file with unexpected flags ${P.toString(16)}`,this.#n),this.setAssociatedPath(h,"",0),"";const W=new Uint32Array(p/4);h.read(W,{at:te});const ne=this.computeDigest(this.#n,P);if(W.every((g,L)=>g===ne[L])){const g=this.#n.findIndex(L=>L===0);return g===0&&h.truncate(y),g?O.decode(this.#n.subarray(0,g)):""}else return j("Disassociating file with bad digest."),this.setAssociatedPath(h,"",0),""}setAssociatedPath(h,P,W){const ne=f.encodeInto(P,this.#n);C<=ne.written+1&&n("Path too long:",P),P&&W&&(W|=D),this.#n.fill(0,ne.written,C),this.#c.setUint32(N,W);const g=this.computeDigest(this.#n,W);h.write(this.#n,{at:0}),h.write(g,{at:te}),h.flush(),P?(this.#t.set(P,h),this.#s.delete(h)):(h.truncate(y),this.#s.add(h))}computeDigest(h,P){if(P&D){let W=3735928559,ne=1103547991;for(const g of h)W=Math.imul(W^g,2654435761),ne=Math.imul(ne^g,104729);return new Uint32Array([W>>>0,ne>>>0])}else return new Uint32Array([0,0])}async reset(h){await this.isReady;let P=await navigator.storage.getDirectory(),W;for(const ne of this.vfsDir.split("/"))ne&&(W=P,P=await P.getDirectoryHandle(ne,{create:!0}));return this.#e=P,this.#l=W,this.#r=await this.#e.getDirectoryHandle(Q,{create:!0}),this.releaseAccessHandles(),this.acquireAccessHandles(h)}getPath(h){return T.isPtr(h)&&(h=T.cstrToJs(h)),(h instanceof URL?h:new URL(h,"file://localhost/")).pathname}deletePath(h){const P=this.#t.get(h);return P&&(this.#t.delete(h),this.setAssociatedPath(P,"",0)),!!P}storeErr(h,P){return h&&(h.sqlite3Rc=P||c.SQLITE_IOERR,this.error(h)),this.$error=h,P}popErr(){const h=this.$error;return this.$error=void 0,h}nextAvailableSAH(){const[h]=this.#s.keys();return h}getOFileForS3File(h){return this.#a.get(h)}mapS3FileToOFile(h,P){P?(this.#a.set(h,P),H(h,this)):(this.#a.delete(h),H(h,!1))}hasFilename(h){return this.#t.has(h)}getSAHForPath(h){return this.#t.get(h)}async removeVfs(){if(!this.#o.pointer||!this.#r)return!1;c.sqlite3_vfs_unregister(this.#o.pointer),this.#o.dispose(),delete r[this.vfsName];try{this.releaseAccessHandles(),await this.#e.removeEntry(Q,{recursive:!0}),this.#r=void 0,await this.#l.removeEntry(this.#e.name,{recursive:!0}),this.#e=this.#l=void 0}catch(h){s.config.error(this.vfsName,"removeVfs() failed with no recovery strategy:",h)}return!0}pauseVfs(){return this.#a.size>0&&s.SQLite3Error.toss(c.SQLITE_MISUSE,"Cannot pause VFS",this.vfsName,"because it has opened files."),this.#i.size>0&&(c.sqlite3_vfs_unregister(this.vfsName),this.releaseAccessHandles()),this}isPaused(){return this.#i.size===0}async unpauseVfs(){return this.#i.size===0?this.acquireAccessHandles(!1).then(()=>c.sqlite3_vfs_register(this.#o,0),this):this}exportFile(h){const P=this.#t.get(h)||n("File not found:",h),W=P.getSize()-y,ne=new Uint8Array(W>0?W:0);if(W>0){const g=P.read(ne,{at:y});g!=W&&n("Expected to read "+W+" bytes but read "+g+".")}return ne}async importDbChunked(h,P){const W=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to.");W.truncate(0);let ne=0,g,L=!1;try{for(;(g=await P())!==void 0;)g instanceof ArrayBuffer&&(g=new Uint8Array(g)),!L&&ne===0&&g.byteLength>=15&&(F.affirmDbHeader(g),L=!0),W.write(g,{at:y+ne}),ne+=g.byteLength;if((ne<512||ne%512!==0)&&n("Input size",ne,"is not correct for an SQLite database."),!L){const V=new Uint8Array(20);W.read(V,{at:0}),F.affirmDbHeader(V)}W.write(new Uint8Array([1,1]),{at:y+18})}catch(V){throw this.setAssociatedPath(W,"",0),V}return this.setAssociatedPath(W,h,c.SQLITE_OPEN_MAIN_DB),ne}importDb(h,P){if(P instanceof ArrayBuffer)P=new Uint8Array(P);else if(P instanceof Function)return this.importDbChunked(h,P);const W=this.#t.get(h)||this.nextAvailableSAH()||n("No available handles to import to."),ne=P.byteLength;(ne<512||ne%512!=0)&&n("Byte array size is invalid for an SQLite db.");const g="SQLite format 3";for(let V=0;V<15;++V)g.charCodeAt(V)!==P[V]&&n("Input does not contain an SQLite database header.");const L=W.write(P,{at:y});return L!=ne?(this.setAssociatedPath(W,"",0),n("Expected to write "+ne+" bytes but wrote "+L+".")):(W.write(new Uint8Array([1,1]),{at:y+18}),this.setAssociatedPath(W,h,c.SQLITE_OPEN_MAIN_DB)),L}}class U{#e;constructor(h){this.#e=h,this.vfsName=h.vfsName}async addCapacity(h){return this.#e.addCapacity(h)}async reduceCapacity(h){return this.#e.reduceCapacity(h)}getCapacity(){return this.#e.getCapacity(this.#e)}getFileCount(){return this.#e.getFileCount()}getFileNames(){return this.#e.getFileNames()}async reserveMinimumCapacity(h){const P=this.#e.getCapacity();return P<h?this.#e.addCapacity(h-P):P}exportFile(h){return this.#e.exportFile(h)}importDb(h,P){return this.#e.importDb(h,P)}async wipeFiles(){return this.#e.reset(!0)}unlink(h){return this.#e.deletePath(h)}async removeVfs(){return this.#e.removeVfs()}pauseVfs(){return this.#e.pauseVfs(),this}async unpauseVfs(){return this.#e.unpauseVfs().then(()=>this)}isPaused(){return this.#e.isPaused()}}const J=async()=>{const R=await navigator.storage.getDirectory(),h=".opfs-sahpool-sync-check-"+E(),P=(await(await R.getFileHandle(h,{create:!0})).createSyncAccessHandle()).close();return await P,await R.removeEntry(h),P?.then&&n("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};s.installOpfsSAHPoolVfs=async function(R=Object.create(null)){R=Object.assign(Object.create(null),m,R||{});const h=R.name;if(R.$testThrowPhase1)throw R.$testThrowPhase1;if(r[h])try{return await r[h]}catch(P){if(R.forceReinitIfPreviouslyFailed)delete r[h];else throw P}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory?r[h]=Promise.reject(new Error("Missing required OPFS APIs.")):r[h]=J().then(async function(){if(R.$testThrowPhase2)throw R.$testThrowPhase2;const P=new w(R);return P.isReady.then(async()=>{const W=new U(P);if(s.oo1){const ne=s.oo1,g=P.getVfs(),L=function(...V){const re=ne.DB.dbCtorHelper.normalizeArgs(...V);re.vfs=g.$zName,ne.DB.dbCtorHelper.call(this,re)};L.prototype=Object.create(ne.DB.prototype),W.OpfsSAHPoolDb=L}return P.log("VFS initialized."),W}).catch(async W=>{throw await P.removeVfs().catch(()=>{}),W})}).catch(P=>r[h]=Promise.reject(P))}});try{const s=Object.assign(Object.create(null),{memory:typeof Ze<"u"?Ze:t.wasmMemory,exports:typeof ft<"u"?ft:Object.prototype.hasOwnProperty.call(t,"wasmExports")?t.wasmExports:t.asm},globalThis.sqlite3ApiBootstrap.defaultConfig,globalThis.sqlite3ApiConfig||{});e.debugModule("Bootstrapping lib config",s);const n=globalThis.sqlite3ApiBootstrap(s);return delete globalThis.sqlite3ApiBootstrap,n}catch(s){throw console.error("sqlite3ApiBootstrap() error:",s),s}},Lt?se=_:se=new Promise((e,t)=>{yt=e,qt=t}),se}Ft=(function(){const Se=Ft;if(!Se)throw new Error("Expecting sqlite3InitModule to be defined by the Emscripten build.");const se=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams,wasmFilename:"sqlite3.wasm"});if(se.debugModule=se.urlParams.has("sqlite3.debugModule")?(...Ee)=>console.warn("sqlite3.debugModule:",...Ee):()=>{},se.urlParams.has("sqlite3.dir"))se.sqlite3Dir=se.urlParams.get("sqlite3.dir")+"/";else if(se.moduleScript){const Ee=se.moduleScript.src.split("/");Ee.pop(),se.sqlite3Dir=Ee.join("/")+"/"}const _=globalThis.sqlite3InitModule=function Ee(...Ce){return se.emscriptenLocateFile=Ce[0]?.locateFile,se.emscriptenInstantiateWasm=Ce[0]?.instantiateWasm,Se(...Ce).then(ke=>{se.debugModule("sqlite3InitModule() sIMS =",se),se.debugModule("sqlite3InitModule() EmscriptenModule =",ke);const De=ke.runSQLite3PostLoadInit(se,ke,!!Ee.__isUnderTest);return se.debugModule("sqlite3InitModule() sqlite3 =",De),De}).catch(ke=>{throw console.error("Exception loading sqlite3 module:",ke),ke})};if(_.ready=Se.ready,se.moduleScript){let Ee=se.moduleScript.src.split("/");Ee.pop(),se.scriptDir=Ee.join("/")+"/"}return se.debugModule("extern-post-js.c-pp.js sqlite3InitModuleState =",se),_})();var br=Ft;globalThis.sqlite3Worker1Promiser=function Se(se=Se.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const me=se;se=Object.assign(Object.create(null),Se.defaultConfig),se.onready=me}else se=Object.assign(Object.create(null),Se.defaultConfig,se);const _=Object.create(null),Ee=function(){},Ce=se.onerror||Ee,ke=se.debug||Ee,De=se.generateMessageId?void 0:Object.create(null),Qe=se.generateMessageId||function(me){return me.type+"#"+(De[me.type]=(De[me.type]||0)+1)},nt=(...me)=>{throw new Error(me.join(" "))};se.worker||(se.worker=Se.defaultConfig.worker),typeof se.worker=="function"&&(se.worker=se.worker());let Ue,rt;return se.worker.onmessage=function(me){me=me.data,ke("worker1.onmessage",me);let Le=_[me.messageId];if(!Le){if(me&&me.type==="sqlite3-api"&&me.result==="worker1-ready"){se.onready&&se.onready(rt);return}if(Le=_[me.type],Le&&Le.onrow){Le.onrow(me);return}se.onunhandled?se.onunhandled(arguments[0]):Ce("sqlite3Worker1Promiser() unhandled worker message:",me);return}switch(delete _[me.messageId],me.type){case"error":Le.reject(me);return;case"open":Ue||(Ue=me.dbId);break;case"close":me.dbId===Ue&&(Ue=void 0);break}try{Le.resolve(me)}catch(He){Le.reject(He)}},rt=function(){let me;arguments.length===1?me=arguments[0]:arguments.length===2?(me=Object.create(null),me.type=arguments[0],me.args=arguments[1],me.dbId=me.args.dbId):nt("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!me.dbId&&me.type!=="open"&&(me.dbId=Ue),me.messageId=Qe(me),me.departureTime=performance.now();const Le=Object.create(null);Le.message=me;let He;me.type==="exec"&&me.args&&(typeof me.args.callback=="function"?(He=me.messageId+":row",Le.onrow=me.args.callback,me.args.callback=He,_[He]=Le):typeof me.args.callback=="string"&&nt("exec callback may not be a string when using the Promise interface."));let ct=new Promise(function(yt,qt){Le.resolve=yt,Le.reject=qt,_[me.messageId]=Le,ke("Posting",me.type,"message to Worker dbId="+(Ue||"default")+":",me),se.worker.postMessage(me)});return He&&(ct=ct.finally(()=>delete _[He])),ct}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/assets/sqlite3-worker1-DbS94oCk.js",import.meta.url),{type:"module"})},onerror:(...Se)=>console.error("sqlite3Worker1Promiser():",...Se)};globalThis.sqlite3Worker1Promiser.v2=(function Se(se=Se.defaultConfig){let _;typeof se=="function"?(_=se,se={}):typeof se?.onready=="function"&&(_=se.onready,delete se.onready);const Ee=Object.create(null);se=Object.assign(se||Object.create(null),{onready:async function(ke){try{_&&await _(ke),Ee.resolve(ke)}catch(De){Ee.reject(De)}}});const Ce=new Promise(function(ke,De){Ee.resolve=ke,Ee.reject=De});try{this.original(se)}catch(ke){Ee.reject(ke)}return Ce}).bind({original:sqlite3Worker1Promiser});globalThis.sqlite3Worker1Promiser.v2.defaultConfig=globalThis.sqlite3Worker1Promiser.defaultConfig;sqlite3Worker1Promiser.v2;delete globalThis.sqlite3Worker1Promiser;var yr=br;async function qr(Se){console.time(`initializeDb:${Se}`);const se=await fetch(Se);if(!se.ok)throw new Error(`Failed to fetch database: ${se.statusText}`);const _=await se.arrayBuffer(),Ee=new Uint8Array(_),Ce=await yr(),ke=Ce.wasm.allocFromTypedArray(Ee),De=new Ce.oo1.DB(void 0,"r");if(!De.pointer)throw new Error("Failed to create database pointer");const Qe=Ce.capi.sqlite3_deserialize(De.pointer,"main",ke,Ee.length,Ee.length,0);if(Qe!==Ce.capi.SQLITE_OK)throw new Error(`Failed to deserialize database: ${Qe}`);return console.timeEnd(`initializeDb:${Se}`),De}function vr(Se,se,_,Ee){const Ce="SELECT plainDateTime, year, month, day, hour FROM calendar",ke=se.size>0?`day IN (${Array.from(se).join(",")})`:"1=1",De=_.size>0?`hour IN (${Array.from(_).join(",")})`:"1=1",Qe=Ee?`plainDateTime >= '${Ee}'`:"1=1",nt=[],Ue=`${Ce} WHERE ${ke} AND ${De} AND ${Qe} ORDER BY plainDateTime asc`;return console.time(`fetchByDaysHours:${Ue}`),Se?.exec({sql:Ue,resultRows:nt}),console.timeEnd(`fetchByDaysHours:${Ue}`),nt}function wr(Se,se,_){const Ee="SELECT DISTINCT substr(plainDateTime, 0, 11) AS plainDate, year, month, day FROM calendar",Ce=se.size>0?`day IN (${Array.from(se).join(",")})`:"1=1",ke=_?`plainDateTime >= '${_}'`:"1=1",De=[],Qe=`${Ee} WHERE ${Ce} AND ${ke} ORDER BY plainDate asc`;return console.time(`fetchByDays:${Qe}`),Se?.exec({sql:Qe,resultRows:De}),console.timeEnd(`fetchByDays:${Qe}`),De}function Sr(Se,se){const _="SELECT plainDateTime, year, month, day, hour FROM calendar",Ee=`plainDateTime = '${se}'`,Ce=[],ke=`${_} WHERE ${Ee}`;return console.time(`fetchByPlainDateTime:${ke}`),Se?.exec({sql:ke,resultRows:Ce}),console.timeEnd(`fetchByPlainDateTime:${ke}`),Ce[0]}const Ke={initializeDb:"initializeDb",fetchByDays:"fetchByDays",fetchByDaysHours:"fetchByDaysHours",fetchByPlainDateTime:"fetchByPlainDateTime"};let xt=null;self.onmessage=async Se=>{const se=await xt;switch(Se.data.type){case Ke.initializeDb:{try{se?.close(),xt=qr(Se.data.payload.url),await xt,self.postMessage({type:Ke.initializeDb,result:!0})}catch(_){self.postMessage({type:Ke.initializeDb,error:_ instanceof Error?_.message:String(_)})}break}case Ke.fetchByDays:{if(!se){self.postMessage({type:Ke.fetchByDays,error:"Database not initialized"});return}const _=wr(se,Se.data.payload.days,Se.data.payload.since);self.postMessage({type:Ke.fetchByDays,result:_});break}case Ke.fetchByDaysHours:{if(!se){self.postMessage({type:Ke.fetchByDaysHours,error:"Database not initialized"});return}const _=vr(se,Se.data.payload.days,Se.data.payload.hours,Se.data.payload.since);self.postMessage({type:Ke.fetchByDaysHours,result:_});break}case Ke.fetchByPlainDateTime:{if(!se){self.postMessage({type:Ke.fetchByPlainDateTime,error:"Database not initialized"});return}const _=Sr(se,Se.data.payload.plainDateTime);self.postMessage({type:Ke.fetchByPlainDateTime,result:_});break}}};
